---
title: الدوائر والتبعيات
type: docs
weight: 230
url: /ar/python-net/precedents-and-dependents/
---

{{% alert color="primary" %}} 

ورق العمل المالي المعقد، خصوصًا تلك التي تم تطويرها بالتعاون، يمكن أن تخفي الأخطاء الأكثر إحراجًا. فحص الصيغ لضمان الدقة والعثور على مصدر الخطأ يمكن أن يكون صعبًا عندما تستخدم الصيغ خلايا سابقة وخلايا معولة.

{{% /alert %}} 
## **مقدمة**
- **الخلايا المسبقة** هي الخلايا التي يشير إليها صيغة في خلية أخرى. على سبيل المثال، إذا كانت الخلية D10 تحتوي على الصيغة =B5، فإن الخلية B5 هي مسبقة للخلية D10.
- ** الخلايا التابعة** تحتوي الخلايا على صيغ تشير إلى خلايا أخرى. على سبيل المثال ، إذا احتوت الخلية D10 على الصيغة = B5 ، فإن الخلية D10 هي تابعة للخلية B5.

لجعل ورق العمل سهل القراءة، قد ترغب في إظهار بشكل واضح الخلايا المستخدمة في صيغة. بالمثل، قد ترغب في استخراج الخلايا المعولة لخلايا أخرى.

يتيح Aspose.Cells لـ Python via .NET تتبع الخلايا ومعرفة تلك المرتبطة.
## **تتبع خلايا السابقة والتابعة: مايكروسوفت إكسل**
قد تتغير الصيغ استنادًا إلى التعديلات التي قام بها العميل. على سبيل المثال ، إذا كانت الخلية C1 معتمدة على C3 و C4 التي تحتوي على صيغة ، وتم تغيير C1 (بحيث يتم تجاوز الصيغة) ، فيجب تغيير C3 و C4 ، أو غيرها من الخلايا ، لتوازن الجدول الخماسي استنادًا إلى قواعد الأعمال.

بالمثل ، فلنفترض أن C1 تحتوي على الصيغة "=(B1*22)/(M2*N32)". أريد أن أجد الخلايا التي يعتمد C1 عليها ، أي الخلايا السابقة B1 و M2 و N32.

قد تحتاج إلى تتبع التبعية لخلية معينة إلى خلايا أخرى. إذا تم تضمين قواعد الأعمال في الصيغ ، نود معرفة التبعيات وتنفيذ بعض القواعد استنادًا إليها. بالمثل ، إذا تم تعديل قيمة خلية معينة ، فأي الخلايا في ورقة العمل يتأثر بتلك التغيير؟

تسمح مايكروسوفت إكسل للمستخدمين بتتبع الخلايا السابقة والتابعة.

1. في شريط الأدوات **View Toolbar** ، حدد **Formula Auditing**. سيتم عرض مربع حوار Formula Auditing.
1. تتبع السابقين:
   1. حدد الخلية التي تحتوي الصيغة التي تريد العثور على الخلايا السابقة لها.
   1. لعرض السهم التتبع إلى كل خلية توفر بيانات مباشرة للخلية النشطة، انقر على **تتبع السابقين** على شريط أدوات **تدقيق الصيغ**.
1. تتبع الصيغ التي تشير إلى خلية معينة (التوابع)
   1. حدد الخلية التي تريد تحديد الخلايا التابعة لها.
   1. لعرض السهم التتبع إلى كل خلية تعتمد على الخلية النشطة، انقر على تتبع التوابع على شريط أدوات تدقيق الصيغ.
## **تتبع الخلايا الأصلية والخلايا المعتمدة: Aspose.Cells لـ Python via .NET**
### **تتبع السابقين**
يجعل Aspose.Cells لـ Python via .NET من السهل استرداد الخلايا الأصلية. يمكنه ليس فقط استرجاع الخلايا التي توفر البيانات للمعادلات البسيطة ولكن أيضًا العثور على الخلايا التي تزود البيانات للمعادلات المعقدة باستخدام النطاقات المسماة.

في المثال أدناه، يتم استخدام ملف إكسل نموذجي، Book1.xls. يحتوي جدول البيانات على بيانات وصيغ على ورقة العمل الأولى.

يوفر Aspose.Cells لـ Python via .NET فئة [**Cell**](https://reference.aspose.com/cells/python-net/aspose.cells/cell)، وطريقة [**get_precedents**](https://reference.aspose.com/cells/python-net/aspose.cells/cell/get_precedents/#) المستخدمة لتعقب خلايا المعادلات الأصلية. تُرجع [**ReferredAreaCollection**](https://reference.aspose.com/cells/python-net/aspose.cells/referredareacollection). كما موضح أعلاه، تحتوي خلية B7 في Book1.xls على معادلة "=SUM(A1:A3)"، لذا الخلايا A1:A3 هي الخلايا الأصلية للخلية B7. يوضح المثال التالي وظيفة تتبع الأصل باستخدام ملف القالب Book1.xls.



{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Formulas-TracingPrecedents-1.py" >}}
### **تتبع المعتمدين**
يتيح لك Aspose.Cells for Python via .NET الحصول على خلايا الاعتمادية في جداول البيانات. لا يستطيع Aspose.Cells for Python via .NET فقط استرداد الخلايا التي تقدم بيانات بشأن صيغة بسيطة ولكنه أيضًا يجد خلايا تعتمد على صيغ معقدة مع نطاقات مسماة.

يوفر Aspose.Cells for Python via .NET فئة [**Cell**](https://reference.aspose.com/cells/python-net/aspose.cells/cell) وطرقها [**get_dependents**](https://reference.aspose.com/cells/python-net/aspose.cells/cell/get_dependents/#bool) والتي تُستخدم لتتبع التابعين لخلية. على سبيل المثال، في Book1.xlsx هناك صيغ: "=A1+20" و"=A1+30" في الخليتين B2 وC2 على التوالي. يوضح المثال التالي كيفية تتبع التوابع للخلية A1 باستخدام ملف النموذج Book1.xlsx.



{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Formulas-TracingDependents-1.py" >}}

### **تتبع الخلايا المسبقة والمعتمدة وفقًا لسلسلة الحساب**
تشير واجهات برمجة التطبيقات أعلاه لتتبع السابقين والتابعين إلى تعبير الصيغة نفسه. فهي توفر ببساطة وسيلة مريحة للمستخدم لتتبع التداخل بين بعض الصيغ. إذا كانت هناك كمية كبيرة من الصيغ في ملف العمل وكان المستخدم بحاجة لتتبع السابقين والتابعين لكل خلية، فستكون الأداء ضعيفًا. في مثل هذه الحالة، ينبغي للمستخدم التفكير في استخدام طرق [**get_precedents_in_calculation**](https://reference.aspose.com/cells/python-net/aspose.cells/cell/get_precedents_in_calculation/#) و[**get_dependents_in_calculation**](https://reference.aspose.com/cells/python-net/aspose.cells/cell/get_dependents_in_calculation/#bool). تتبع هاتان الطريقتان الاعتمادات وفقًا لسلسلة الحساب. لذلك، لاستخدامهما، يجب عليك أولًا تفعيل سلسلة الحساب بواسطة [**Workbook.settings.formula_settings.enable_calculation_chain**](https://reference.aspose.com/cells/python-net/aspose.cells/formulasettings/enable_calculation_chain/). ثم يجب أن تجري حسابًا كاملاً لملف العمل بواسطة [**Workbook.calculate_formula()**](https://reference.aspose.com/cells/python-net/aspose.cells/workbook/calculate_formula/#). بعد ذلك، يمكنك تتبع السابقين أو التابعين لجميع تلك الخلايا التي تحتاجها.

بالنسبة لبعض الصيغ، قد تكون المسبقات الناتجة مختلفة بالنسبة لـ GetPrecedents و GetPrecedentsInCalculation، وقد تكون المعتمدون الناتجة مختلفة بالنسبة لـ GetDependents و GetDependentsInCalculation. على سبيل المثال، إذا كانت صيغة الخلية A1 هي "=IF(TRUE,B2,C3)"، فستوفر GetPrecedents B2 و C3 كمسبقات لـ A1. وفي هذا السياق، يحمل كل من B2 و C3 المعتمد A1 عند التحقق بواسطة GetDependents. ومع ذلك، بالنسبة لحساب هذه الصيغة، من الواضح أنه يمكن لـ B2 فقط التأثير على النتيجة المحسوبة. لذا فإن GetPrecedentsInCalculation لن تقدم C3 لـ A1، ولن تقدم GetDependentsInCalculation A1 لـ C3. في بعض الأحيان قد يكون لدى المستخدم مجرد متطلبات تتبع تلك الترابطات التي تؤثر فعليًا على النتيجة المحسوبة لصيغ استنادًا إلى البيانات الحالية لورقة العمل، فيجب عليهم أيضًا استخدام GetDependentsInCalculation/GetPrecedentsInCalculation بدلاً من GetDependents/GetPrecedents.

يوضح المثال التالي كيفية تتبع المسبقات والمعتمدين وفقًا لسلسلة الحساب للخلايا:


{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Formulas-TracingDependenciesInCalculation.py" >}}

