---
title: ضبط رؤوس وأسافل
type: docs
weight: 30
url: /ar/python-net/setting-headers-and-footers/
description: توضح هذه المقالة كيفية إدراج صورة برمجياً في رأس وتذييل أوراق عمل Excel عن طريق تعيين الرأس والتذييل باستخدام أوامر سكريبت باستخدام API Aspose.Cells for Python via .NET.
keywords: مكتبة Excel للبايثون، إدراج صورة في رأس أو تذييل Excel باستخدام بايثون، ضبط أوامر السكريبت للرأس والتذييل في Excel باستخدام بايثون.
---

{{% alert color="primary" %}}

رؤوس وأسافل هي سطور النص المعروضة أسفل هامش الأعلى أو أعلى الهامش على التوالي. يمكن إضافة رؤوس وأسافل إلى الأوراق العمل أيضًا. يمكن استخدام رؤوس وأسافل لعرض معلومات مفيدة مثل رقم الصفحة أو اسم المؤلف أو اسم الموضوع أو التاريخ والوقت. يتم إدارة الرؤوس والأسافل باستخدام إعدادات تخطيط الصفحة.

{{% /alert %}}

## **ضبط رؤساء الصفحات وتذايلها**

يسمح Aspose.Cells for Python via .NET بإضافة رؤوس وتذييلات إلى أوراق العمل في وقت التشغيل، لكن يُنصح بضبط الرؤوس والتذييلات يدوياً في ملف مصمم مسبقاً للطباعة. يمكنك استخدام Microsoft Excel كأداة واجهة مستخدم لضبط الرؤوس والتذييلات لتوفير الجهد ووقت التطوير. يمكن لـ Aspose.Cells for Python via .NET استيراد الملف وحفظ الإعدادات.

لإضافة رؤوس وتذييلات في وقت التشغيل، توفر Aspose.Cells for Python via .NET استدعاءات API خاصة وأوامر سكريبت لتنسيق الرؤوس والتذييلات.

### **أوامر السكريبت**

أوامر السكريبت هي أوامر خاصة تسمح لك بتعيين تنسيقات الرأس والتذييل.

| **أوامر السكريبت** | **الوصف** |
| :- | :- |
|&P| - رقم الصفحة الحالية
|&G| - صورة
|&N| - مجموع عدد الصفحات
|&D| - التاريخ الحالي
|&T| - الوقت الحالي
|&A| - اسم ورقة العمل
|&F| - اسم الملف بدون مساره
|&"\<FontName>"| - يمثل اسم الخط. على سبيل المثال: &"Arial"
|&"\<FontName>, \<FontStyle>"| - يمثل اسم الخط بالنمط. مثال: &"Arial,Bold"
|&\<FontSize>| - يمثل حجم الخط. على سبيل المثال: “&14abc”. ولكن، إذا تبعت هذه الأمر برقم عادي يتم طباعته في الرأس، يجب أن يتم فصله بحرف مسافة عن حجم الخط. على سبيل المثال: “&14 123”.

### **كيفية تعيين الرؤوس والتذييلات**

يوفر [**PageSetup**](https://reference.aspose.com/cells/python-net/aspose.cells/pagesetup) فئتين، [**set_header**](https://reference.aspose.com/cells/python-net/aspose.cells/pagesetup/set_header/#int-str) و [**set_footer**](https://reference.aspose.com/cells/python-net/aspose.cells/pagesetup/set_footer/#int-str)، تُستخدم لإضافة رأس وتذيل لورقة عمل. هذه الفئات تأخذ فقط معلمتين:

- **القسم** – القسم الذي يجب وضع الرأس أو التذيل فيه. هناك ثلاثة أقسام: اليسار، الوسط، واليمين، يُمثلون بالترتيب 0، 1، و2.
- **السكريبت** – السكريبت الذي يجب استخدامه للرأس أو التذيل. يتضمن هذا السكريبت أوامر سكريبت لتنسيق الرؤوس أو التذيلات.

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Worksheets-PageSetupFeatures-SetHeadersAndFooters-1.py" >}}

### **كيفية إدراج صورة في رأس أو تذييل**

يوجد في الفئة [**PageSetup**](https://reference.aspose.com/cells/python-net/aspose.cells/pagesetup) طريقتان إضافيتان، [**set_header_picture**](https://reference.aspose.com/cells/python-net/aspose.cells/pagesetup/set_header_picture/#int-bytes) و [**set_footer_picture**](https://reference.aspose.com/cells/python-net/aspose.cells/pagesetup/set_footer_picture/#int-bytes)، تُستخدم لإضافة الصور إلى الرأس والتذييل. تأخذ هذه الطرق المعاملات التالية:

- **القسم** – القسم الخطوط العليا أو السفلية حيث سيتم وضع الصورة. هناك ثلاثة أقسام، اليمين، الوسط واليسار، يُمثلها القيم 0، 1 و 2 على التوالي.
- **مصفوفة بايت** – البيانات الرسومية (يجب كتابة البيانات الثنائية في مخزن مصفوفة بايت).

بعد تنفيذ الكود أدناه وفتح الملف، تحقق من رأس الصفحة في ورقة العمل عن طريق:

1. في قائمة **ملف**, حدد **إعداد الصفحة**. سيتم عرض مربع حواري.
1. حدد علامة التبويب **رأس / تذييل**.

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Worksheets-PageSetupFeatures-InsertImageInHeaderFooter-1.py" >}}
