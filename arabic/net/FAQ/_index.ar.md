---
title: الأسئلة الشائعة (FAQ)
type: docs
weight: 100
url: /ar/net/faq/
---

## **كيفية إصلاح استثناء System.StackOverFlowException على Workbook.CalculateFormula؟**
في بعض الأحيان، يواجه المستخدمون استثناء System.StackOverFlowException على طريقة Workbook.CalculateFormula. عادة ما يحدث هذا الاستثناء لأن حجم الكومة الافتراضي لـ IIS صغير جدًا (265 كيلو فقط). يمكنك إصلاح هذا الخطأ من خلال إنشاء خيط آخر بحجم كومة مكبر ثم نقل كودك المتعلق بـ Workbook.CalculateFormula داخله.



{{< gist "aspose-cells-gists" "7c644a93d33d24299a618c1dda1a2385" "Examples.GridWeb-CSharp-Controllers-GridWebFAQController-FixStackOverflowException.cs" >}}
## **مشكلة سمك الخطوط أثناء تحويل Excel إلى PDF**
في بعض الأحيان، عند تحويل ملف Excel إلى PDF، يكون سمك الخطوط مختلفًا في PDF الناتج. لا تسبب هذه المشكلة أسبوز.كيلز. إنها ناتجة عن Adobe Reader عندما يتم التحقق من إعداداته "تحسين صور الخطوط" و "تعزيز الخطوط الرفيعة". إلغاء تحديد هذه الخيارات سيعرض PDF بشكل جيد.

إذا تحقق من "تحسين صور الخطوط" و "تعزيز الخطوط الرفيعة"، سيكون سمك الخطوط مختلفًا. انظر الخطوات التالية عن كيفية القيام بذلك:

- انتقل إلى تحرير
- حدد التفضيلات
- في فئة عرض الصفحة، تأكد من "تحسين صور الخطوط" و "تعزيز الخطوط الرفيعة"

إذا ألغيت تحقق من "تحسين صور الخطوط" و "تعزيز الخطوط الرفيعة"، سيكون سمك الخطوط متماثلًا. لتحقيق ذلك، اتبع الخطوات التالية:

- انتقل إلى تحرير
- حدد التفضيلات
- في فئة عرض الصفحة، ألغ تحقق من "تحسين صور الخطوط" و "تعزيز الخطوط الرفيعة"
## **كيفية إصلاح استثناء System.OutOfMemoryException أثناء تحميل جداول بيانات كبيرة؟**
هناك فرص عادلة لأن ترميز المصنف يمكن أن يلقي استثناء System.OutOfMemoryException أثناء تحميل جداول بيانات كبيرة. يشير هذا الاستثناء إلى أن الذاكرة المتاحة غير كافية لتحميل الجداول بشكل كامل في الذاكرة، لذا يجب أن يتم تحميل الجدول بتمكين [تفضيلات الذاكرة](/cells/ar/net/optimizing-memory-usage-while-working-with-big-files-having-large-datasets/).

تقدم واجهات برمجة التطبيقات لـ Aspose.Cells تفضيلات الذاكرة لتحسين استهلاك الذاكرة أثناء تحميل ومعالجة الجداول. هذه الخيارات أيضًا مفيدة في تحميل الجداول الكبيرة التي تحتوي على مجموعات بيانات ضخمة بشكل كفء في كائن Workbook كما هو موضح أدناه.



{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-KnowledgeBase-FAQs-FixOutOfMemoryException-1.cs" >}}

## **تحديد الحجم الذي يلزم لكومة معينة**
على الرغم من أننا قمنا بتحسين محرك حساب الصيغ Aspose.Cells وفي معظم الحالات، يجب أن تكون قادرًا على حساب جميع الصيغ بنجاح لملف القالب المعطى دون تحديد حجم كومة أصغر. ومع ذلك، في بعض الأحيان، قد لا يمكن تجنب استثناء System.StackOverFlowException على طريقة Workbook.CalculateFormula. نحن نوفر واجهات برمجة جديدة للمستخدمين لتتبع حسابات الصيغ. لقد أضفنا فئة تحمل اسم "AbstractCalculationMonitor" وقدمنا خاصية، أي، *CalculationOptions.CalculationMonitor* للتعامل مع/تتبع المشكلة.

يمكن للمستخدمين تتبع حجم الكومة بأنفسهم باستخدام واجهات برمجة التطبيقات. يرجى ملاحظة أن التحقق من الكومة لكل خلية سيؤدي بالتأكيد إلى تدهور الأداء إلى حد كبير. انظر إلى القسم مثال الكود للرجوع إليها.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "CalculationMonitor-CustomStackTrace.cs" >}}

{{% alert color="primary" %}} 

لا يوجد طريقة أفضل للحصول على حجم الكومة المستخدمة في وقت التشغيل. الكود أعلاه الذي قدمناه مجرد مثال. سيؤدي الأداء بالتأكيد إلى التدهور بشكل كبير حتمًا. لذا، نظن أن يمكن تحسين الكود من قبل المستخدمين (الذين يرغبون حقًا في استخدامه) وفقًا لسيناريوهاتهم ومتطلباتهم المختلفة، مثل التحقق من الكومة عندما يصل عدد الخلايا العادية إلى عدد معين، وجمع معدل الزيادة المتوسطة للكومة لخلية واحدة عادية وتحديد التكرار للتحقق من الكومة، وما إلى ذلك.

{{% /alert %}}

