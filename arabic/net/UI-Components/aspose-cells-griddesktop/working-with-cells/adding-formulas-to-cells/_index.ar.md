---
title: إضافة صيغة إلى الخلية
type: docs
weight: 30
url: /ar/net/aspose-cells-griddesktop/adding-formula-to-cell/
keywords: الجريد الأدنى، صيغة
description: يقدم هذا المقال كيفية الحصول على أو تعيين الصيغة في الخلية في ورقة العمل في GridDesktop.
---

{{% alert color="primary" %}} 

يمكن أن تحتوي الخلية ليس فقط على قيمة بسيطة مثل رقم أو نص ما، وإنما أيضًا على صيغة كقيمتها. تُستخدم الصيغة في الخلية عندما يحتاج قيمة الخلية إلى أن تُحدد بعد بعض العمليات الحسابية. في هذا الموضوع، سنناقش كيفية الوصول إلى الصيغة وتعديلها المطبقة على الخلية.

{{% /alert %}} 
## **إضافة الصيغة إلى الخلية**
إضافة الصيغة إلى الخلية تشبه تعيين قيمة الخلية كما ناقشنا في موضوعنا السابق: [الوصول وتعديل قيمة الخلية](/cells/ar/net/accessing-and-modifying-the-value-of-a-cell/) إلا أننا في هذه الحالة قمنا فقط بإضافة القيم البسيطة إلى الخلايا. الآن، سنقوم بإضافة صيغ. يمكن للمطورين استخدام خاصية القيمة للخلية للوصول إلى الصيغة وتعديلها، أو يمكن أيضًا استخدام طريقة **SetCellValue** للخلية لإضافة أو تعديل الصيغة في الخلية.

**مهم:** الفرق الأساسي بين استخدام خاصية القيمة أو طريقة **SetCellValue** للخلية هو أن خاصية القيمة تقوم بنداء طريقة **RunAllFormulas** تلقائيًا من Grid لإعادة حساب قيم جميع الصيغ، في حين بحالة طريقة **SetCellValue** يحتاج المطورون إلى استدعاء طريقة **RunAllFormulas** بشكل صريح بعد إضافة الصيغ إلى الخلايا. في الواقع، عندما نستخدم طريقة **SetCellValue** للخلية، فإن هذه الطريقة تقوم بتعيين قيمة الخلية إلى **نوع الصيغة** فقط ولا تقوم بحساب الصيغة. علاوة على ذلك، ليس من الضروري استدعاء طريقة **RunAllFormulas** في كل مرة. إذا كنت ترغب في إضافة العديد من الصيغ إلى خلايا ورقة العمل، يمكنك استدعاء طريقة **RunAllFormulas** مرة واحدة فقط في النهاية.

تضاف الصيغة إلى الخلية كقيمة نصية. علاوة على ذلك، يجب أن تكون هيكلة الصيغة متوافقة مع هيكلة الصيغة في MS Excel. يجب أن تبدأ جميع الصيغ بعلامة **مساواة (=)**.

في المثال المعطى أدناه، قُمنا بإضافة صيغة لضرب قيمتي خليتين في ورقة العمل وتخزين النتيجة في خلية أخرى. تم أيضًا استدعاء طريقة **RunAllFormulas** في النهاية.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithCells-AddingCellFormulas-1.cs" >}}



الآن قم بتشغيل التطبيق. إذا قمت بالنقر المزدوج على الخلية التي تمت إضافة الصيغة إليها، ستلاحظ أن القيمة ستُستبدل بالصيغة التي تُحسب القيمة في الخلفية.

{{% alert color="primary" %}} 

يدعم Aspose.Cells.GridDesktop معظم الوظائف المستخدمة بشكل شائع في MS Excel. لمزيد من التفاصيل حول قائمة الوظائف المدعومة، يرجى [النقر هنا.](/cells/ar/net/list-of-supported-functions/)

{{% /alert %}}
