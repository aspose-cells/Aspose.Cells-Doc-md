---
title: ضبط رؤوس وأسافل
type: docs
weight: 30
url: /ar/net/setting-headers-and-footers/
description: يشرح هذا المقال كيفية إدراج صورة برمجيًا في رأس وتسفل ورقات العمل في Excel عن طريق ضبط الرأس والتسفل بأوامر النص البرمجية باستخدام واجهة برمجة التطبيقات C# أو مكتبة .NET.
keywords: إدراج صورة في رأس وتسفل إكسل c#، ضبط رأس وتسفل إكسل بأوامر نصية c#
---

{{% alert color="primary" %}}

رؤوس وأسافل هي سطور النص المعروضة أسفل هامش الأعلى أو أعلى الهامش على التوالي. يمكن إضافة رؤوس وأسافل إلى الأوراق العمل أيضًا. يمكن استخدام رؤوس وأسافل لعرض معلومات مفيدة مثل رقم الصفحة أو اسم المؤلف أو اسم الموضوع أو التاريخ والوقت. يتم إدارة الرؤوس والأسافل باستخدام إعدادات تخطيط الصفحة.

{{% /alert %}}

## **ضبط رؤساء الصفحات وتذايلها**

يتيح Aspose.Cells لك إضافة رؤوس وتذييلات للصفحات بناءً على النموذج أو الإعداد الذي تم تصميمه مسبقًا للطباعة، ولكنها موصى بها يدوياً. يمكنك استخدام Microsoft Excel كأداة لواجهة رسومية (GUI) لتعيين رؤوس وتذييلات لتوفير الجهد والوقت في التطوير. يمكن ل Aspose.Cells استيراد الملف وحفظ الإعدادات.

لإضافة رؤوس وتذييلات بناءً على النموذج، يوفر Aspose.Cells استدعاءات API خاصة وأوامر سكريبت لتنسيق الرؤوس والتذييلات.

### **أوامر السكريبت**

أوامر السكريبت هي أوامر خاصة تسمح لك بتعيين تنسيقات الرأس والتذييل.

| **أوامر السكريبت** | **الوصف** |
| :- | :- |
|&P| - رقم الصفحة الحالية
|&G| - صورة
|&N| - مجموع عدد الصفحات
|&D| - التاريخ الحالي
|&T| - الوقت الحالي
|&A| - اسم ورقة العمل
|&F| - اسم الملف بدون مساره
|&&Text|يعرض &Text. على سبيل المثال: &&WO سيتم عرضه كـ &WO|
|&"\<FontName>"| - يمثل اسم الخط. على سبيل المثال: &"Arial"
|&"\<FontName>, \<FontStyle>"| - يمثل اسم الخط بالنمط. مثال: &"Arial,Bold"
|&\<FontSize>| - يمثل حجم الخط. على سبيل المثال: “&14abc”. ولكن، إذا تبعت هذه الأمر برقم عادي يتم طباعته في الرأس، يجب أن يتم فصله بحرف مسافة عن حجم الخط. على سبيل المثال: “&14 123”.

### **تعيين رؤوس وتذييلات**

يوفر [**PageSetup**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup) فئتين، [**SetHeader**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setheader) و [**SetFooter**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setfooter)، تُستخدم لإضافة رأس وتذيل لورقة عمل. هذه الفئات تأخذ فقط معلمتين:

- **القسم** – القسم الذي يجب وضع الرأس أو التذيل فيه. هناك ثلاثة أقسام: اليسار، الوسط، واليمين، يُمثلون بالترتيب 0، 1، و2.
- **السكريبت** – السكريبت الذي يجب استخدامه للرأس أو التذيل. يتضمن هذا السكريبت أوامر سكريبت لتنسيق الرؤوس أو التذيلات.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-PageSetupFeatures-SetHeadersAndFooters-1.cs" >}}

### **إدراج صورة في رأس أو تذيل**

يوجد في الفئة [**PageSetup**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup) طريقتان إضافيتان، [**SetHeaderPicture**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setheaderpicture) و [**SetFooterPicture**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setfooterpicture)، تُستخدم لإضافة الصور إلى الرأس والتذييل. تأخذ هذه الطرق المعاملات التالية:

- **القسم** – القسم الخطوط العليا أو السفلية حيث سيتم وضع الصورة. هناك ثلاثة أقسام، اليمين، الوسط واليسار، يُمثلها القيم 0، 1 و 2 على التوالي.
- **مصفوفة بايت** – البيانات الرسومية (يجب كتابة البيانات الثنائية في مخزن مصفوفة بايت).

بعد تنفيذ الكود أدناه وفتح الملف، تحقق من رأس الصفحة في ورقة العمل عن طريق:

1. في قائمة **ملف**, حدد **إعداد الصفحة**. سيتم عرض مربع حواري.
1. حدد علامة التبويب **رأس / تذييل**.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-PageSetupFeatures-InsertImageInHeaderFooter-1.cs" >}}
{{< app/cells/assistant language="csharp" >}}
