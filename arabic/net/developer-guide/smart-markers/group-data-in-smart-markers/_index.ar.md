---
title: كيفية تجميع البيانات في Smart Markers
type: docs
weight: 30
url: /ar/net/how-to-group-data-in-smart-markers/
---

## **سيناريوهات الاستخدام المحتملة**
في بعض تقارير Excel قد تحتاج إلى تقسيم البيانات إلى مجموعات لجعلها أسهل قراءة وتحليل. أحد الأغراض الرئيسية لتقسيم البيانات إلى مجموعات هو تشغيل الحسابات (أداء عمليات ملخصية) على كل مجموعة من السجلات.

تسمح علامات الذكاء في Aspose.Cells لك بتجميع البيانات حسب الحقول ووضع صفوف ملخصية بين مجموعات البيانات أو المجموعات البيانية. على سبيل المثال، إذا تم تجميع البيانات حسب Customers.CustomerID، يمكنك إضافة سجل ملخص في كل مرة يتغير فيها المجموعة.

## **معلمات تجميع البيانات في Smart Markers**
فيما يلي بعض معلمات العلامات الذكية المستخدمة لتجميع البيانات.
### **group:normal/merge/repeat**
نحن ندعم ثلاثة أنواع من التجميع يمكنك الاختيار بينها.

- **عادي** - قيمة الحقل (أو الحقول) المجمعة لن تُكرر للسجلات المقابلة في العمود؛ بدلاً من ذلك، يتم طباعتها مرة واحدة لكل مجموعة من البيانات.
- **دمج** - نفس السلوك كما في المعلمة العادية، باستثناء أنها تدمج الخلايا في الحقل (أو الحقول) المجمعة لكل مجموعة محددة.
- **تكرار** - تُكرر قيمة الحقل (أو الحقول) المجمعة للسجلات المقابلة.

على سبيل المثال: &=Customers.CustomerID(group:merge)
### **skip**
تخطي عدد محدد من الصفوف بعد كل مجموعة.

على سبيل المثال, &=Employees.EmployeeID(group:normal,skip:1)
### **subtotalN**
يؤدي عملية ملخصية لبيانات حقل محددة متعلقة بحقل مجمعة. N يمثل الأرقام بين 1 و 11 التي تحدد الوظيفة المستخدمة عند حساب المجاميع الفرعية داخل قائمة البيانات. (1=متوسط، 2=عدد، 3=COUNTA، 4=MAX، 5=MIN، ... 9=SUM إلخ.) راجع المرجع Subtotal في مساعدة Microsoft Excel لمزيد من التفاصيل.

التنسيق ينص بالفعل على:
subTotalN:Ref حيث يشير Ref إلى العمود الذي يتم التجميع حسبه.

على سبيل المثال،

- &=Products.Units(subtotal9:Products.ProductID) يُحدد وظيفة الملخص عن حقل **Units** بالنسبة لحقل **ProductID** في جدول **Products**.
- &=Tabx.Col3(subtotal9:Tabx.Col1) يُحدد وظيفة الملخص عن حقل **Col3** حسب **Col1** في الجدول **Tabx**.
- &=Table1.ColumnD(subtotal9:Table1.ColumnA&Table1.ColumnB) يحدد وظيفة التلخيص على الحقل **ColumnD** وفقًا ل**ColumnA** و **ColumnB** في الجدول **Table1**.

## **كيفية تجميع البيانات في Smart Markers**

يظهر هذا المثال بعض معلمات التجميع في العمل. يستخدم قاعدة بيانات Microsoft Access بمسمى Northwind.mdb ويستخرج البيانات من الجدول الذي يحمل اسم "تفاصيل الطلب". ننشئ ملف مصمم يسمى SmartMarker_Designer.xls في Microsoft Excel ونضع علامات ذكية في الخلايا المختلفة في ورقات العمل. يتم معالجة العلامات لملء ورقات العمل. يتم وضع البيانات وتنظيمها حسب حقل تجميع.

يحتوي الملف المصمم على ورقتي عمل. في الأولى نضع علامات ذكية مع معلمات التجميع كما هو مبين في اللقطة أدناه. يتم وضع ثلاث علامات ذكية (بمعلمات تجميع) كما يلي:
&=[Order Details].OrderID(group:merge,skip:1),
&=[Order Details].Quantity(subtotal9:Order Details.OrderID), و
&=[Order Details].UnitPrice(subtotal9:Order Details.OrderID) تذهب إلى A5, B5 و C5 على التوالي.

|**الورقة العمل الأولى في ملف SmartMarker_Designer.xls، مكتملة بعلامات ذكية**|
| :- |
|![todo:image_alt_text](using-smart-markers_5.png)|
في الورقة العمل الثانية من ملف المصمم، نضع بعض العلامات الذكية كما هو موضح في الشكل أدناه. نضع العلامات الذكية التالية:
&=[Order Details].OrderID(group:normal),
&=[Order Details].Quantity,
&=[Order Details].UnitPrice,
&=&=B(r)*C(r) و
&=subtotal9:Order Details.OrderID إلى A5، B5، C5، D5 و C6 على التوالي.

|**الصفحة العملية الثانية لملف SmartMarker_Designer.xls، تظهر علامات ذكية مختلطة.**|
| :- |
|![todo:image_alt_text](using-smart-markers_6.png)|
هنا هو الشيفرة المصدر المستخدمة في المثال.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-SmartMarkers-GroupingData-1.cs" >}}

{{% alert color="primary" %}} 

إذا كنت بحاجة إلى إضافة علامات مخصصة الخاصة بك إلى الصفوف القصيرة أو تريد دمج اسم الحقل مع علامة، مثلا"إجمالي طلبات"، Aspose.Cells توفر لك سمة Label وLabelPosition، حتى تتمكن من وضع علاماتك المخصصة في علامات Smart Markers أثناء الدمج مع صفوف الإجمالي في بيانات التجميع. انظر الوثيقة حول كيفية إضافة علامات مخصصة للدمج مع صفوف الإجمالي في علامات ذكية لمرجعك.

{{% /alert %}} 
