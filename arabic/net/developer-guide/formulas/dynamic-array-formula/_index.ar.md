---
title: إعداد صيغ الصفيف الديناميكية
description: كيفية استخدام مكتبة Aspose.Cells لحساب صيغ المصفوفة الديناميكية في Microsoft Excel. عن طريق تحميل ملف Excel موجود أو إنشاء ملف Excel جديد، يمكننا استخدام الطريقة التي يوفرها Aspose.Cells لحساب صيغة المصفوفة الديناميكية والحصول على النتيجة. وأخيرًا، نقوم بحفظ ملف Excel المعدل على القرص.
keywords: Dynamic Array Formulas, Dynamic Array Formulas in Excel, Set dynamic array formulas, Calculation of dynamic array formulas, operate dynamic array formulas of Excel.
type: docs
weight: 70
url: /ar/net/calculation-of-dynamic-array-formulas/
---
##  **ما هي صيغة صفيف Excel**
في Excel، صيغة الصفيف هي نوع خاص من الصيغة يسمح لك بإجراء العمليات الحسابية على صفائف البيانات بدلاً من الخلايا الفردية. يمكن استخدام صيغ الصفائف لإجراء عمليات حسابية معقدة ومعالجة البيانات وحل مشكلات معينة بكفاءة. يتم إدخالها بشكل مختلف عن الصيغ العادية وغالبًا ما تتطلب استخدام Ctrl + Shift + Enter.

فيما يلي بعض النقاط الأساسية حول صيغ الصفيف في Excel:
1. بناء الجملة:
<br>
تتم كتابة صيغ الصفيف مثل الصيغ العادية ولكنها تتضمن عمليات على صفائف من القيم. وهي محاطة بأقواس متعرجة { } للإشارة إلى أنها صيغ مصفوفة. ومع ذلك، لا يمكنك كتابة هذه الأقواس المتعرجة بنفسك؛ يقوم Excel بإضافتها تلقائيًا عند إدخال الصيغة بشكل صحيح.
1. إدخال صيغ المصفوفة:
<br>
لإدخال صيغة صفيف، اكتب الصيغة في شريط الصيغة. وبدلاً من الضغط على Enter للإنهاء، اضغط على Ctrl + Shift + Enter. هذا يخبر Excel بأنها صيغة صفيف. عند إدخالها بشكل صحيح، يعرض Excel الصيغة داخل أقواس متعرجة في شريط الصيغة للإشارة إلى أنها صيغة صفيف.
1. استخدم حالات:
<br>
تعتبر صيغ الصفيف مفيدة لإجراء العمليات الحسابية عبر خلايا أو نطاقات متعددة في وقت واحد. يمكن استخدامها للحسابات الرياضية المتقدمة والعمليات الشرطية وتصفية البيانات والمزيد.
1. فوائد:
<br>
تسمح لك صيغ الصفيف بإجراء عمليات حسابية معقدة في صيغة واحدة، مما يؤدي إلى تحسين الكفاءة وتبسيط أوراق العمل الخاصة بك. يمكنهم التعامل مع مجموعات البيانات الكبيرة وإجراء العمليات الحسابية التي قد تتطلب خطوات وسيطة متعددة.
1. محددات:
<br>
قد تكون صيغ الصفيف أكثر صعوبة في الفهم واستكشاف الأخطاء وإصلاحها من الصيغ العادية. يمكنها إبطاء أداء ورقة العمل، خاصة إذا تم استخدامها على نطاق واسع أو مع مجموعات بيانات كبيرة.
1. أمثلة:
<br>
 جمع القيم في نطاق:**{=SUM(A1:A5*B1:B5)}**
<br>
 العثور على القيمة القصوى في نطاق:**{=الحد الأقصى(A1:A5+B1:B5)}**
<br>
<image src="1.png" width="70%" />
<br>

تذكر أنه يجب استخدام صيغ الصفيف بحكمة، ومن المهم فهم كيفية عملها قبل تنفيذها في أوراق العمل الخاصة بك. يمكن أن تكون أدوات قوية لتحليل البيانات ومعالجتها في Excel.

##  **ما هي صيغة صفيف Excel الديناميكي**
تعد صيغ الصفيف الديناميكي ميزة جديدة تم تقديمها في Excel 365 وExcel 2021. فهي تتيح لك العمل مع صفائف البيانات بشكل أكثر سلاسة وكفاءة مقارنة بصيغ الصفيف التقليدية. تقوم صيغ المصفوفة الديناميكية بنقل النتائج تلقائيًا إلى الخلايا المجاورة، مما يلغي الحاجة إلى Ctrl + Shift + Enter ويسمح بمعالجة البيانات بشكل أسهل.

النقاط الأساسية حول صيغ الصفيف الديناميكي في Excel:
1. الانسكاب التلقائي:
<br>
تقوم صيغ الصفيف الديناميكي تلقائيًا بنقل النتائج إلى الخلايا المجاورة بناءً على حجم بيانات الإخراج. هذا يعني أنك لست بحاجة إلى تحديد نطاق من الخلايا قبل إدخال الصيغة أو استخدام Ctrl + Shift + Enter لتأكيد الصيغة.
1. فردي-Cell الدخول:
<br>
يتم إدخال صيغ المصفوفة الديناميكية في خلية واحدة، ويقوم برنامج Excel تلقائيًا بملء الخلايا المجاورة بالنتائج. وهذا يجعل من السهل إدارة الصيغ وفهمها، حيث أنك تحتاج إلى إدخال الصيغة مرة واحدة فقط.
1. وظائف جديدة:
<br>
تقدم صيغ الصفائف الديناميكية وظائف جديدة يمكنها التعامل مع الصفائف محليًا، مثل *FILTER**، *SORT**، *UNIQUE**، *SEQUENCE**، *SORTBY**، و *RANDARRAY**. يمكن لهذه الوظائف إرجاع قيم متعددة أو معالجة المصفوفات مباشرة، مما يؤدي إلى تبسيط العمليات الحسابية المعقدة.
1. التعامل مع النطاق المرن:
<br>
تقوم صيغ الصفيف الديناميكي بضبط حجم النطاق الممتد ديناميكيًا استنادًا إلى حجم بيانات الإدخال أو العملية الحسابية التي يتم إجراؤها. تتيح هذه المرونة استخدامًا أكثر كفاءة لمساحة ورقة العمل وتبسط عملية إنشاء الصيغة.
1. تحسين الأداء:
<br>
يمكن لصيغ الصفيف الديناميكية تحسين الأداء مقارنة بصيغ الصفيف التقليدية، خاصة عند العمل مع مجموعات بيانات كبيرة أو حسابات معقدة.
1. التوافق:
<br>
تتوفر صيغ الصفيف الديناميكي في Excel 365 وExcel 2021. وقد لا تكون مدعومة في الإصدارات الأقدم من Excel.
1. أمثلة على صيغ الصفيف الديناميكي:
<br>
*FILTER**: إرجاع مصفوفة من القيم التي تستوفي المعايير المحددة.
<br>
*SORT**: فرز القيم في نطاق أو صفيف.
<br>
*UNIQUE**: إرجاع قيم فريدة من قائمة أو نطاق.
<br>
*SEQUENCE**: إنشاء تسلسل من الأرقام أو التواريخ.
<br>
*RANDARRAY**: إنشاء مجموعة من الأرقام العشوائية.
<br>
<image src="2.png" width="70%" />
<br>

توفر صيغ الصفيف الديناميكي إمكانات قوية لمعالجة البيانات وتحليلها في Excel، مما يسهل العمل مع صفائف البيانات وإجراء العمليات الحسابية المعقدة بكفاءة.

##  **ما هو الفرق بين صيغ المصفوفة وصيغ المصفوفة الديناميكية في Excel**
في Excel، يتم استخدام كل من صيغ الصفيف وصيغ الصفيف الديناميكية لإجراء عمليات حسابية على قيم متعددة في وقت واحد، ولكن لديهم بعض الاختلافات من حيث الوظيفة وكيفية تنفيذها.

###  **ميزات صيغ المصفوفة**
1. صيغ الصفيف هي صيغ تقليدية في Excel يمكنها إجراء عمليات حسابية على صفائف البيانات.
1. يتم إدخالها عن طريق الضغط على Ctrl + Shift + Enter بعد كتابة الصيغة، والتي تخبر Excel بأنها صيغة مصفوفة.
1. تحتوي صيغ الصفيف على قيود فيما يتعلق بقدرتها على توزيع النتائج إلى الخلايا المجاورة. عادةً ما تُرجع نتيجة واحدة 1، على الرغم من أن هذه النتيجة قد تكون عبارة عن مصفوفة خلايا.
1. لقد كانت موجودة منذ فترة طويلة وهي مدعومة في كافة إصدارات Excel.

###  **ميزات صيغ الصفيف الديناميكية**
1. تعد صيغ الصفيف الديناميكي ميزة جديدة تم تقديمها في Excel 365 (اشتراك Office 365) وExcel 2021.
1. يقومون تلقائيًا بنقل النتائج إلى الخلايا المجاورة بناءً على حجم البيانات المدخلة أو حساب الصيغة.
1. لا تتطلب صيغ المصفوفة الديناميكية الضغط على Ctrl + Shift + Enter؛ ما عليك سوى كتابة الصيغة في خلية واحدة، ويقوم برنامج Excel تلقائيًا بملء الخلايا المجاورة بالنتائج.
1. تتمتع هذه الصيغ بالقدرة على إرجاع نتائج متعددة (نطاق من الخلايا) مباشرة دون الحاجة إلى صيغة صفيف أو Ctrl + Shift + Enter.
1. لديهم وظائف جديدة مثل *FILTER**، *SORT**، *UNIQUE**، وما إلى ذلك، والتي يمكنها التعامل مع المصفوفات محليًا وإرجاع النتائج بتنسيق صفيف ديناميكي.
باختصار، تعد صيغ المصفوفات الديناميكية طريقة أكثر حداثة وملاءمة للعمل مع المصفوفات في Excel، مما يوفر تدفقًا تلقائيًا للنتائج وتبسيط عملية العمل مع المصفوفات مقارنة بصيغ المصفوفات التقليدية. ومع ذلك، فهي متوفرة فقط في الإصدارات الأحدث من Excel التي تدعم الصفائف الديناميكية.

##  **كيفية تعيين وحساب صيغ الصفيف الديناميكي في Excel**
 يتضمن إعداد صيغ الصفيف الديناميكي في Excel استخدام وظائف محددة مصممة للعمل مع صفائف البيانات والسماح للنتائج بالانتشار تلقائيًا إلى الخلايا المجاورة.

فيما يلي دليل خطوة بخطوة لإعداد صيغ الصفيف الديناميكي:
1. اختر Cell:
<br>
اختر الخلية التي تريد أن تظهر فيها نتائج صيغة الصفيف الديناميكي. تقوم صيغ الصفيف الديناميكي بتوزيع النتائج على الخلايا المجاورة، لذا تأكد من وجود مساحة كافية للمخرجات المنسكبة.
1. أدخل الصيغة:
<br>
 اكتب صيغة الصفيف الديناميكي في شريط الصيغة للخلية المحددة. استخدم إحدى وظائف المصفوفة الديناميكية المتوفرة في Excel 365 وExcel 2021، مثل *FILTER** أو *SORT** أو *UNIQUE** أو *SEQUENCE** أو *SORTBY** أو *RANDARRAY**.
<br>
على سبيل المثال، يمكنك استخدام الدالة FILTER لتصفية قائمة البيانات بناءً على معايير محددة: *=FILTER(A2:C15,(A2:A15=F4)*(C2:C15=G4),"")**.
<br>
<image src="3.png" width="70%" />
<br>
1. اضغط دخول:
<br>
بعد كتابة الصيغة، ما عليك سوى الضغط على Enter بلوحة المفاتيح. على عكس صيغ المصفوفات التقليدية، لا تحتاج إلى الضغط على Ctrl + Shift + Enter.
1. مراقبة النطاق المسكوب:
<br>
يقوم Excel تلقائيًا بنقل نتائج الصيغة إلى الخلايا المجاورة. يتم ضبط النطاق الممتد ديناميكيًا استنادًا إلى حجم بيانات الإخراج أو الحساب الذي تجريه الصيغة. يقوم Excel بتمييز النطاق الممتد بحدود ورمز سهم قطري للإشارة إلى أنه يحتوي على بيانات منسكبة.
1. التفاعل مع النطاق المسكوب:
<br>
يمكنك التفاعل مع النطاق الممتد تمامًا مثل أي نطاق آخر من الخلايا في Excel. استخدم النطاق الممتد في صيغ أخرى، أو قم بإجراء العمليات الحسابية عليه، أو قم بتنسيقه، أو قم بالإشارة إليه في المخططات أو الجداول.
1. تحديث الصيغة:
<br>
إذا كنت بحاجة إلى تعديل صيغة الصفيف الديناميكي، فما عليك سوى تحرير الصيغة في الخلية الأصلية التي تم إدخالها فيها.
بعد التحرير، اضغط على Enter مرة أخرى لتأكيد التغييرات. سيقوم Excel تلقائيًا بتحديث النطاق الممتد إذا لزم الأمر.
1. مسح النطاق المسكوب:
<br>
إذا كنت تريد مسح البيانات المنسكبة، فيمكنك حذف الصيغة من الخلية الأصلية. سيقوم Excel بمسح النطاق المسكوب أيضًا. وبدلاً من ذلك، يمكنك حذف النطاق الممتد مباشرة عن طريق تحديده والضغط على مفتاح الحذف.
<br>

باتباع هذه الخطوات، يمكنك إعداد صيغ صفيف ديناميكية في Excel لتحليل صفائف البيانات ومعالجتها بكفاءة، مما يسمح بمهام تحليل البيانات وإعداد التقارير بشكل أسهل.

##  **كيفية تعيين وتحديث صيغ الصفيف الديناميكي باستخدام Aspose.Cells**
 الرجاء مراجعة نموذج التعليمات البرمجية التالي الذي يقوم بتحميل ملف[عينة من ملف إكسل](dynamicArrayFormula.xlsx) الذي يحتوي على بعض البيانات الوهمية. بعد تحميل الملف اتصل على[Cell.SetDynamicArrayFormula](https://reference.aspose.com/cells/net/aspose.cells/cell/setdynamicarrayformula/#setdynamicarrayformula) وظيفة لتعيين صيغة الصفيف الديناميكي و[Workbook.RefreshDynamicArrayFormulas](https://reference.aspose.com/cells/net/aspose.cells/workbook/refreshdynamicarrayformulas/#refreshdynamicarrayformulas) وظيفة لتحديث صيغ الصفيف الديناميكي قبل استدعاء حساب الصيغة، وأخيرًا حفظ المصنف باسم[إخراج ملف إكسل](out.xlsx). 

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Formulas-dynamic-array-formulas.cs" >}}

لقطة الإخراج:
<br>
<image src="4.png" width="70%" />