---
title: ضبط صيغ الصفائف الديناميكية
description: كيفية استخدام مكتبة Aspose.Cells لحساب صيغ الصفائف الديناميكية في برنامج Microsoft Excel. من خلال تحميل ملف Excel موجود أو إنشاء ملف Excel جديد، يمكننا استخدام الطريقة المقدمة من Aspose.Cells لحساب الصيغة الديناميكية والحصول على النتيجة. في النهاية، نقوم بحفظ ملف Excel المعدل إلى القرص.
keywords: صياغة صيغ الصفائف الديناميكية، صيغ الصفائف الديناميكية في Excel، تعيين صيغ الصفائف الديناميكية، حساب صيغ الصفائف الديناميكية، تشغيل صيغ الصفائف الديناميكية في Excel.
type: docs
weight: 70
url: /ar/net/calculation-of-dynamic-array-formulas/
---
## **ما هي صيغة الصفائف في Excel**
في Excel، صيغة الصفائف هي نوع خاص من الصيغ التي تتيح لك إجراء حسابات على مجموعات من البيانات بدلا من الخلايا الفردية. يمكن استخدام صيغ الصفائف لإجراء حسابات معقدة، وتلاعب البيانات، وحل المشاكل المحددة بكفاءة. تُدخل بطريقة مختلفة عن الصيغ العادية وغالبا ما تتطلب استخدام Ctrl + Shift + Enter.

هنا بعض النقاط الرئيسية حول صيغ الصفائف في Excel:
1. القواعد اللغوية:
<br>
تكتب صيغ الصفائف مثل الصيغ العادية ولكن تشمل عمليات على مجموعات القيم. تتم وضعها بين قوسين مجزأين { } للإشارة أنها صيغ صفائف. ومع ذلك، لا تقوم بكتابة هذه القوسين بنفسك؛ يُضيف Excel هذه تلقائيًا عند إدخال الصيغة بشكل صحيح.
1. إدخال صيغ الصفائف
<br>
لإدخال صيغة صفيف، تكتب الصيغة في شريط الصيغ. بدلاً من الضغط على Enter لإنهاء، تضغط على Ctrl + Shift + Enter. هذا يخبر Excel بأنها صيغة صفيف. عند إدخالها بشكل صحيح، يعرض Excel الصيغة داخل قوسين مجزأين في شريط الصيغ للإشارة إلى أنها صيغة صفائف.
1. حالات الاستخدام:
<br>
تكون صيغ الصفائف مفيدة لأداء الحسابات عبر خلايا أو نطاقات متعددة في نفس الوقت. يمكن استخدامها للحسابات الرياضية المتقدمة، والعمليات الشرطية، وتصفية البيانات، وأكثر من ذلك.
1. الفوائد:
<br>
الصيغ الصفية تتيح لك إجراء حسابات معقدة في صيغة واحدة، مما يمكن أن يعزز الكفاءة ويبسط أوراق العمل الخاصة بك. يمكنها التعامل مع مجموعات بيانات كبيرة وإجراء حسابات قد تتطلب خطوات وسيطة متعددة بطرق أخرى.
1. القيود:
<br>
قد تكون الصيغ الصفية أكثر صعوبة في الفهم وحل المشكلات من الصيغ العادية. يمكن أن تبطئ أداء أوراق العمل، وخصوصا إذا استخدمت بشكل واسع أو مع مجموعات بيانات كبيرة.
1. الأمثلة:
<br>
جمع القيم في نطاق: **{=SUM(A1:A5*B1:B5)}**
<br>
العثور على القيمة القصوى في نطاق: **{=MAX(A1:A5+B1:B5)}**
<br>
<image src="1.png" width="70%" />
<br>

تذكر أن الصيغ الصفية يجب استخدامها بحكم، ومن المهم فهم كيفية عملها قبل تنفيذها في أوراق العمل الخاصة بك. يمكن أن تكون أدوات قوية لتحليل البيانات وتلاعبها في إكسل.

## **ما هي صيغة الصفي الديناميكية في إكسل**
الصيغ الصفية الديناميكية هي ميزة جديدة تم إدخالها في إكسل 365 وإكسل 2021. تتيح لك العمل مع مجموعات من البيانات بشكل أكثر سلاسة وكفاءة مقارنة بالصيغ الصفية التقليدية. تنسر النتائج تلقائياً في الخلايا المجاورة، مما يلغي الحاجة لـ Ctrl + Shift + Enter ويسهل تلاعب البيانات.

نقاط رئيسية حول صيغ الصفي الديناميكية في إكسل:
1. الانتشار التلقائي:
<br>
تنتشر الصيغ الصفية الديناميكية تلقائياً في الخلايا المجاورة استناداً إلى حجم البيانات الناتجة. هذا يعني أنه لا حاجة لتحديد مجموعة من الخلايا قبل إدخال الصيغة أو استخدام Ctrl + Shift + Enter لتأكيد الصيغة.
1. إدخال خلية واحدة:
<br>
يتم إدخال الصيغ الصفية الديناميكية في خلية واحدة، ويقوم إكسل تلقائياً بملء الخلايا المجاورة بالنتائج. وهذا يجعل من السهل إدارة الصيغ، حيث تحتاج فقط إلى إدخال الصيغة مرة واحدة.
1. وظائف جديدة:
<br>
تقدم الصيغ الصفية الديناميكية وظائف جديدة يمكن أن تتعامل مع المجموعات بشكل طبيعي، مثل **FILTER**, **SORT**, **UNIQUE**, **SEQUENCE**, **SORTBY**, و **RANDARRAY**. يمكن لهذه الوظائف إرجاع قيم متعددة أو تلاعب المجموعات مباشرة، مما يبسط الحسابات المعقدة.
1. التعامل المرن مع النطاقات:
<br>
تقوم الصيغ الصفية الديناميكية بضبط حجم النطاق المنتشر بشكل ديناميكي استناداً إلى حجم البيانات الداخلة أو الحساب المنجز. تسمح هذه المرونة باستخدام أكثر كفاءة لمساحة أوراق العمل وتبسط إنشاء الصيغ.
1. تحسين الأداء:
<br>
يمكن أن تعزز الصيغ الديناميكية للمصفوفة الأداء مقارنة بالصيغ العادية للمصفوفة، خصوصاً عند العمل مع مجموعات بيانات كبيرة أو حسابات معقدة.
1. التوافق:
<br>
الصيغ الديناميكية للمصفوفة متوفرة في Excel 365 و Excel 2021. قد لا تكون مدعومة في الإصدارات القديمة من Excel.
1. أمثلة من الصيغ الديناميكية للمصفوفة:
<br>
**FILTER**: يُعيد مصفوفة من القيم التي تلبي الشروط المحددة.
<br>
**SORT**: يقوم بفرز القيم في نطاق أو مصفوفة.
<br>
**UNIQUE**: يعيد القيم الفريدة من قائمة أو نطاق.
<br>
**SEQUENCE**: يولد سلسلة من الأرقام أو التواريخ.
<br>
**RANDARRAY**: يولد مصفوفة من الأرقام العشوائية.
<br>
<image src="2.png" width="70%" />
<br>

تقدم الصيغ الديناميكية للمصفوفة إمكانيات قوية لمعالجة البيانات وتحليلها في Excel، مما يجعل من السهل العمل مع مجموعات البيانات وإجراء الحسابات المعقدة بكفاءة.

## **ما هي الفرق بين صيغ الصفيف وصيغ الصفيف الديناميكية في Excel**
في Excel، يتم استخدام كل من صيغ الصفيف وصيغ الصفيف الديناميكية لأداء الحسابات على قيم متعددة بشكل متزامن، ولكن لديهم بعض الاختلافات من حيث الوظائف وكيفية تنفيذها.

### **ميزات صيغ الصفيف**
1. صيغ الصفيف هي صيغ تقليدية في Excel يمكنها إجراء حسابات على مجموعات من البيانات.
1. يتم إدخالها عن طريق الضغط على Ctrl + Shift + Enter بعد كتابة الصيغة، مما يخبر Excel أنها صيغة صفيفية.
1. تحتوي صيغ الصفيف على قيود من حيث قدرتها على سكب النتائج في الخلايا المجاورة. وعادةً ما تعيد نتيجة واحدة، على الرغم من أن تلك النتيجة قد تكون مصفوفة خلية.
1. كانت موجودة لفترة طويلة وتم دعمها في جميع إصدارات Excel.

### **ميزات صيغ الصفيف الديناميكية**
1. الصيغ الديناميكية للمصفوفة هي ميزة جديدة تم تقديمها في Excel 365 (اشتراك Office 365) وExcel 2021.
1. تسكب النتائج تلقائياً في الخلايا المجاورة استنادًا إلى حجم البيانات الإدخال أو حساب الصيغة.
1. صيغ الصيغية الديناميكية لا تتطلب الضغط على Ctrl + Shift + Enter؛ ببساطة قم بكتابة الصيغة في خلية واحدة، وسيقوم Excel تلقائيًا بملء الخلايا المجاورة بالنتائج.
1. هذه الصيغ لديها القدرة على إرجاع نتائج متعددة (نطاق من الخلايا) مباشرة دون الحاجة إلى صيغة مصفوفة أو Ctrl + Shift + Enter.
1. لديهم وظائف جديدة مثل **FILTER**, **SORT**, **UNIQUE**، الخ، والتي يمكنها التعامل بشكل طبيعي مع المصفوفات وإرجاع النتائج في تنسيق مصفوفة ديناميكية.
باختصار، صيغ الصيغة الديناميكية هي طريقة أكثر حداثة وملاءمة للعمل مع المصفوفات في Excel، حيث توفر التمييز التلقائي للنتائج وتبسيط عملية العمل مع المصفوفات مقارنة بالصيغ العادية للمصفوفات. ومع ذلك، فهي متاحة فقط في الإصدارات الأحدث من Excel التي تدعم المصفوفات الديناميكية.

## **كيفية ضبط وحساب صيغ الصيغ الديناميكية في Excel**
إعداد صيغ الصيغ الديناميكية في Excel ينطوي على استخدام وظائف محددة مصممة للعمل مع مصفوفات البيانات والسماح للنتائج بالسكب تلقائيًا في الخلايا المجاورة. 

فيما يلي دليل خطوة بخطوة لضبط صيغ الصيغ الديناميكية:
1. تحديد الخلية:
<br>
اختر الخلية التي ترغب في ظهور نتائج صيغة الصياغة الديناميكية فيها. تسكب نتائج صيغ الصياغة الديناميكية في الخلايا المجاورة، لذا تأكد من وجود مساحة كافية للنتائج المسكبة.
1. إدخال الصيغة:
<br>
اكتب صيغة الصياغة الديناميكية في شريط الصيغة في الخلية المحددة. استخدم واحدة من الوظائف الديناميكية المتاحة في Excel 365 و Excel 2021، مثل **FILTER**, **SORT**, **UNIQUE**, **SEQUENCE**, **SORTBY**، أو **RANDARRAY**. 
<br>
على سبيل المثال، قد تستخدم وظيفة FILTER لتصفية قائمة البيانات استنادًا إلى معايير محددة: **=FILTER(A2:C15,(A2:A15=F4)*(C2:C15=G4),"")**.
<br>
<image src="3.png" width="70%" />
<br>
1. الضغط على Enter:
<br>
بعد كتابة الصيغة، ببساطة اضغط على مفتاح Enter على لوحة المفاتيح الخاصة بك. على عكس الصيغ العادية للمصفوفات، لا تحتاج إلى الضغط على Ctrl + Shift + Enter.
1. مراقبة نطاق السكب:
<br>
يقوم Excel تلقائيًا بسكب نتائج الصيغة في الخلايا المجاورة. يتكيف نطاق السكب بشكل ديناميكي استنادًا إلى حجم البيانات المخرجة أو الحساب الذي قامت به الصيغة. يقوم Excel بتحديد نطاق السكب بإطار ورمز سهم قطري للإشارة إلى أنه يحتوي على بيانات مسكبة.
1. التفاعل مع نطاق السكب:
<br>
يمكنك التفاعل مع نطاق السكب تمامًا مثل أي نطاق آخر من الخلايا في Excel. استخدم نطاق السكب في صيغ أخرى، قم بإجراء حسابات عليه، قم بتنسيقه، أو الإشارة إليه في الرسوم البيانية أو الجداول.
1. تحديث الصيغة:
<br>
إذا كنت بحاجة إلى تعديل صيغة الصيغة الديناميكية، فقط عدل الصيغة في الخلية الأصلية التي تم إدخالها فيها.
بعد تحريرها ، اضغط على مفتاح Enter مرة أخرى لتأكيد التغييرات. سيقوم Excel بتحديث النطاق المطلق تلقائيًا إذا لزم الأمر.
1. مسح النطاق المطلق:
<br>
إذا كنت ترغب في مسح البيانات المطلقة ، يمكنك حذف الصيغة من الخلية الأصلية. سيقوم Excel أيضًا بمسح النطاق المطلق. بالإضافة إلى ذلك ، يمكنك حذف النطاق المطلق مباشرةً عن طريق تحديده والضغط على مفتاح حذف.
<br>

من خلال اتباع هذه الخطوات ، يمكنك إعداد صيغ الصفائف الديناميكية في Excel لتحليل وتلاعب الصفائف البيانات بكفاءة ، مما يسمح بتسهيل مهام تحليل البيانات وإعداد التقارير.

## **كيفية تعيين وتحديث صيغ الصفائف الديناميكية باستخدام Aspose.Cells**
يرجى الاطلاع على الكود النموذجي التالي الذي يحمل [ملف Excel النموذجي] (dynamicArrayFormula.xlsx) الذي يحتوي على بعض البيانات الوهمية. بعد تحميل الملف ، ادعو إلى وظيفة [Cell.SetDynamicArrayFormula](https://reference.aspose.com/cells/net/aspose.cells/cell/setdynamicarrayformula/#setdynamicarrayformula) لتعيين الصيغة الديناميكية للمصفوفة و وظيفة [Workbook.RefreshDynamicArrayFormulas](https://reference.aspose.com/cells/net/aspose.cells/workbook/refreshdynamicarrayformulas/#refreshdynamicarrayformulas) لتحديث صيغ الصفائف الديناميكية قبل استدعاء حساب الصيغة ، وأخيرًا حفظ الوظيفة على شكل [ملف Excel الناتج] (out.xlsx). 

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Formulas-dynamic-array-formulas.cs" >}}

لقطة الناتج:
<br>
<image src="4.png" width="70%" />
{{< app/cells/assistant language="csharp" >}}
