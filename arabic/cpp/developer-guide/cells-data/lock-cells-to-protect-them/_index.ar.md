---
title: كيفية قفل الخلايا لحمايتها مع C++
linktitle: كيفية قفل الخلايا لحمايتها
type: docs
weight: 130
url: /ar/cpp/how-to-lock-cells-to-protect-them/
description: يعرض هذا المقال رمزًا يوضح كيفية قفل الخلايا لحمايتها باستخدام مكتبة Aspose.Cells مع C++.
keywords: قفل الخلايا باستخدام C++، كيفية قفل الخلايا لحمايتها باستخدام C++، قفل الخلايا في C++ للحماية.
---

## **سيناريوهات الاستخدام المحتملة**
قفل الخلايا لحمايتها هو ممارسة شائعة في تطبيقات الجداول، مثل مايكروسوفت إكسل أو جوجل شيتس، للأسباب المهمة التالية:

1. منع التغييرات العرضية: يمكن لقفل الخلايا منع المستخدمين من تعديل البيانات أو الصيغ المهمة عن غير قصد. هذا مفيد بشكل خاص في جداول البيانات المعقدة حيث يمكن أن تؤدي التغييرات غير المقصودة إلى أخطاء كبيرة.

1. الحفاظ على سلامة البيانات: من خلال قفل الخلايا، يمكنك ضمان بقاء البيانات الحرجة متسقة ودقيقة. هذا ضروري للمستندات المالية، التقارير، وأي مستندات أخرى تتطلب سلامة البيانات.

1. الوصول المُتحكم فيه: في بيئات التعاون، يتيح قفل الخلايا التحكم في من يمكنه تحرير أجزاء معينة من جدول البيانات. على سبيل المثال، قد ترغب في السماح فقط لأعضاء فريق معينين بتحرير خلايا محددة مع الحفاظ على حماية باقي ورقة العمل.

1. حماية الصيغ: غالبًا ما تكون الصيغ حاسمة للحسابات وتحليل البيانات. يضمن قفل الخلايا التي تحتوي على الصيغ أن لا تتعرض هذه الصيغ للتغيير أو الحذف عن غير قصد، مما قد يعطل وظيفة ورقة العمل بأكملها.

1. تطبيق قواعد العمل: في بعض الحالات، قد تتطلب قواعد العمل أو اللوائح حماية بيانات معينة من التعديل. يساعد قفل الخلايا على الامتثال لهذه المتطلبات.

1. توجيه المستخدمين: من خلال قفل الخلايا وتقديم تعليمات واضحة حول الخلايا التي يمكن تحريرها، يمكنك إرشاد المستخدمين حول كيفية التفاعل مع جدول البيانات، مما يقلل من الالتباس والأخطاء.

## **كيفية قفل الخلايا لحمايتها في إكسل**
إليك كيفية قفل الخلايا في Microsoft Excel:

1. تحديد الخلايا لقفلها: حدد الخلايا التي تريد قفلها. إذا كنت تريد قفل الورقة بأكملها، يمكنك تخطي هذه الخطوة.
1. فتح حوار تنسيق الخلايا: انقر بزر الماوس الأيمن على الخلايا المحددة واختر "تنسيق الخلايا"، أو اضغط على Ctrl+1.
<br>
<img src="1.png" width=60% />
1. قفل الخلايا: في مربع حوار تنسيق الخلايا، انتقل إلى علامة التبويب "الحماية". ضع علامة في خانة "مقفول". انقر "موافق".
1. حماية ورقة العمل: انتقل إلى علامة التبويب "مراجعة" على الشريط. انقر على "حماية الورقة". ضع كلمة مرور (اختياري) واختر الأذونات التي ترغب في السماح بها (مثل اختيار الخلايا المقفلة، تنسيق الخلايا، وهلم جرا). انقر "موافق".
<br>
<img src="2.png" width=60% />

## **كيفية قفل الخلايا لحمايتها باستخدام C++**

Aspose.Cells هي مكتبة قوية للعمل مع ملفات Excel برمجيًا. لقفل الخلايا باستخدام Aspose.Cells، عليك اتباع الخطوات التالية: تحميل [ملف عينة](sample.xlsx)، إلغاء قفل جميع الخلايا أولاً (لأن جميع الخلايا مقفلة افتراضيًا ولكن لم يتم تفعيلها إلا عند حماية ورقة العمل)، ثم قفل الخلايا المحددة التي تريد حمايتها، وأخيرًا حماية ورقة العمل لتفعيل القفل.

```c++
#include <iostream>
#include "Aspose.Cells.h"
using namespace Aspose::Cells;

int main()
{
    Aspose::Cells::Startup();

    // Load the Excel file
    Workbook workbook(u"sample.xlsx");

    // Access the first worksheet
    Worksheet sheet = workbook.GetWorksheets().Get(0);

    // Unlock all cells first
    Style unlockStyle = workbook.CreateStyle();
    unlockStyle.SetIsLocked(false);

    StyleFlag styleFlag;
    styleFlag.SetLocked(true);
    sheet.GetCells().ApplyStyle(unlockStyle, styleFlag);

    // Lock specific cells (e.g., A1 and B2)
    Style lockStyle = workbook.CreateStyle();
    lockStyle.SetIsLocked(true);

    sheet.GetCells().Get(u"A1").SetStyle(lockStyle);
    sheet.GetCells().Get(u"B2").SetStyle(lockStyle);

    // Protect the worksheet to enforce the locking
    sheet.Protect(ProtectionType::All);

    // Save the modified workbook
    workbook.Save(u"output_locked.xlsx");

    std::cout << "Worksheet protection applied successfully!" << std::endl;

    Aspose::Cells::Cleanup();
}
```

## **نتيجة الإخراج**
تضمن هذه الشفرة قفل الخلايا المحددة فقط (A1 و B2 في هذا المثال)، ويتم حماية ورقة العمل لتطبيق هذه الإعدادات. تبقى جميع الخلايا الأخرى في ورقة العمل غير مقفلة وقابلة للتحرير.

<br>
<img src="3.png" width=60% />

