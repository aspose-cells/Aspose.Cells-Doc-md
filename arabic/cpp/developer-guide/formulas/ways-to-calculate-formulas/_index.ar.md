---
title: طرق لحساب الصيغ
type: docs
weight: 30
url: /ar/cpp/ways-to-calculate-formulas/
---

## **مقدمة**
يحتوي Aspose.Cells على محرك حسابي مدمج للصيغ. يمكنه ليس فقط إعادة حساب الصيغ المستوردة من قوالب المصمم ولكن أيضًا دعم حساب النتائج للصيغ المضافة أثناء التشغيل.
## **إضافة صيغ وحساب النتائج**
تدعم Aspose.Cells معظم الصيغ أو الدوال التي تشكل جزءًا من Microsoft Excel. يمكن استخدامها من خلال واجهة برمجة التطبيقات أو باستخدام جداول البيانات المصممة. تدعم Aspose.Cells مجموعة كبيرة من الصيغ الرياضية والنصية والمنطقية والتاريخ/الوقت والإحصائية والبحث والمرجعية.

استخدم طريقة Cell.SetFormula لإضافة صيغة إلى خلية. عند تطبيق صيغة على خلية ، يجب دائمًا أن تبدأ السلسلة برمز يساوي (=) كما تفعل عند إنشاء صيغة في Microsoft Excel. استخدم الفاصلة (,) لفصل معلمات الدالة.

لحساب نتائج الصيغ ، اتصل بطريقة Workbook.CalculateFormula() التي تقوم بمعالجة جميع الصيغ المضمنة في ملف Excel. يرجى الرجوع إلى الكود المثالي التالي الذي يضيف الصيغة ويحسب نتائجها. يرجى التحقق من [ملف الإكسل الناتج](38109185.xlsx) الذي تم إنشاؤه باستخدام هذا الكود.

**كود عينة**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-AddingFormulasAndCalculatingResults-new.cpp" >}}
<!-- - ## **الحساب المباشر للصيغة**
في بعض الأحيان، قد تحتاج إلى حساب نتائج الصيغ مباشرة دون إضافتها إلى ورقة عمل. قد تكون قيم الخلايا المستخدمة في الصيغة موجودة بالفعل في ورقة عمل وكل ما تحتاجه هو إيجاد نتيجة تلك القيم بناءً على بعض صيغ Microsoft Excel دون إضافة الصيغة في ورقة عمل.

يمكنك استخدام طريقة Worksheet.CalculateFormula(String formula) لحساب نتائج مثل هذه الصيغ دون إضافتها إلى ورقة العمل.

ينتج الكود أدناه الناتج التالي.

{{< highlight java >}}

 Value of A1: 20

Value of A2: 30

Result of Sum(A1:A2): 50

{{< /highlight >}}

**كود عينة**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-DirectCalculationOfFormula.cpp" >}}   --->
## **حساب الصيغ مرة واحدة فقط**
عند استدعاء Workbook.CalculateFormula() لحساب قيم الصيغ في قالب عمل ملف Excel ، تقوم Aspose.Cells بإنشاء سلسلة حسابية. يزيد الأداء عندما تتم حساب الصيغ للمرة الثانية أو الثالثة.

ومع ذلك ، إذا كان القالب يحتوي على الكثير من الصيغ ، فإن الوقت الذي يتم فيه حساب الصيغة لأول مرة يمكن أن يستهلك الكثير من وحدة المعالجة المركزية والذاكرة.

تتيح Aspose.Cells لك إيقاف إنشاء سلسلة الحسابات وهو ما يكون مفيدًا عندما ترغب في حساب الصيغ مرة واحدة فقط.

يرجى استدعاء Workbook.GetISettings().SetCreateCalcChain() مع المعلمة false. يمكنك استخدام [ملف الإكسل المقدم](38109186.xlsx) لاختبار هذا الكود.

**كود عينة**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-CalculatingFormulasOnceOnly-new.cpp" >}}
