---
title: طرق حساب الصيغ
type: docs
weight: 30
url: /ar/cpp/ways-to-calculate-formulas/
---
## **مقدمة**
Aspose.Cells له محرك حساب معادلة مضمنة. لا يمكنه فقط إعادة حساب الصيغ المستوردة من قوالب المصمم ولكنه يدعم أيضًا حساب نتائج الصيغ المضافة في وقت التشغيل.
## **إضافة الصيغ وحساب النتائج**
يدعم Aspose.Cells معظم الصيغ أو الوظائف التي تشكل جزءًا من Microsoft Excel. يمكن استخدامها من خلال API أو باستخدام جداول بيانات المصمم. يدعم Aspose.Cells مجموعة ضخمة من المعادلات الرياضية ، والجمل ، والمنطقية ، والتاريخ / الوقت ، والإحصائية ، والبحث والمرجع.

استخدم Cell.Formula لإضافة صيغة إلى خلية. عند تطبيق صيغة على خلية ، ابدأ السلسلة دائمًا بعلامة يساوي (=) كما تفعل عند إنشاء صيغة في Microsoft Excel. استخدم فاصلة (،) لتحديد معلمات الوظيفة.

 لحساب نتائج الصيغ ، قم باستدعاء طريقة Workbook.CalculateFormula () التي تعالج جميع الصيغ المضمنة في ملف Excel. الرجاء مراجعة نموذج التعليمات البرمجية التالي الذي يضيف الصيغة ويحسب نتائجها. رجاء تاكد من[ملف اكسل الناتج](38109185.xlsx) ولدت مع هذا الرمز.

**عينة من الرموز**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-AddingFormulasAndCalculatingResults.cpp" >}}
## **الحساب المباشر للصيغة**
في بعض الأحيان ، تحتاج إلى حساب نتائج الصيغة مباشرة دون إضافتها إلى ورقة عمل. قيم الخلايا المستخدمة في الصيغة موجودة بالفعل في ورقة عمل وكل ما تحتاجه هو العثور على نتيجة هذه القيم بناءً على بعض صيغة Excel Microsoft دون إضافة الصيغة في ورقة العمل.

يمكنك استخدام طريقة Worksheet.CalculateFormula (صيغة سلسلة) لحساب نتائج هذه الصيغ دون إضافتها إلى ورقة العمل.

ينتج الكود أدناه الإخراج التالي.

{{< highlight "java" >}}

 Value of A1: 20

Value of A2: 30

Result of Sum(A1:A2): 50

{{< /highlight >}}

**عينة من الرموز**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-DirectCalculationOfFormula.cpp" >}}
## **حساب الصيغ مرة واحدة فقط**
عندما يتم استدعاء Workbook.CalculateFormula () لحساب قيم الصيغ في قالب مصنف ، يقوم Aspose.Cells بإنشاء سلسلة حساب. يزيد من الأداء عند حساب الصيغ للمرة الثانية أو الثالثة.

ومع ذلك ، إذا كان القالب يحتوي على الكثير من الصيغ ، فإن المرة الأولى التي يتم فيها حساب الصيغة يمكن أن تستهلك الكثير من وقت معالجة وحدة المعالجة المركزية والذاكرة.

يسمح لك Aspose.Cells بإيقاف إنشاء سلسلة حساب والتي تكون مفيدة عندما تريد حساب الصيغ مرة واحدة فقط.

 يرجى الاتصال بـ Workbook.GetISettings (). SetCreateCalcChain () باستخدام معلمة خاطئة. يمكنك استخدام ال[قدم ملف اكسل](38109186.xlsx) لاختبار هذا الرمز.

**عينة من الرموز**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-CalculatingFormulasOnceOnly.cpp" >}}
