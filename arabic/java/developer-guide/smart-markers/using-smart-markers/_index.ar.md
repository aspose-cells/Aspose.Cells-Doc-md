---
title: استخدام العلامات الذكية
type: docs
weight: 40
url: /ar/java/using-smart-markers/
---

## **مقدمة**

{{% alert color="primary" %}}

**العلامات الذكية** تُستخدم لتعلم Aspose.Cells ما هي المعلومات التي يجب وضعها في جدول بيانات Microsoft Excel [المصمم](/cells/ar/java/what-is-a-designer-spreadsheet/). تسمح العلامات الذكية بإنشاء قوالب تحتوي فقط على المعلومات المتعلقة والتنسيق.

{{% /alert %}}

## **الجدول البياني للمصمم والعلامات الذكية**

الجداول البيانية للمصمم هي ملفات Excel قياسية تحتوي على تنسيقات بصرية وصيغ وعلامات ذكية. يمكن أن تحتوي على علامات ذكية تشير إلى مصدر بيانات واحد أو أكثر، مثل المعلومات من مشروع ومعلومات لجهات اتصال ذات الصلة. تُكتب العلامات الذكية في الخلايا حيث ترغب في وضع المعلومات.

تبدأ جميع العلامات الذكية بـ &=. على سبيل المثال، علامة بيانات تحتوي على &=Party.FullName. إذا أسفرت علامة البيانات عن أكثر من عنصر واحد، على سبيل المثال صف كامل، فإن الصفوف التالية تنتقل تلقائيًا لتوفير المساحة للمعلومات الجديدة. بالتالي يمكن وضع المجاميع الفرعية والمجاميع على الصف الفوري بعد علامة البيانات لإجراء حسابات استنادًا إلى المعلومات المدخلة. لإجراء حسابات على الصفوف المدخلة، استخدم [الصيغ الديناميكية](/cells/ar/java/using-smart-markers/#dynamic-formulas).

تتكون العلامات الذكية من أجزاء **مصدر البيانات** و**اسم الحقل** لمعظم المعلومات. قد يتم أيضًا تمرير معلومات خاصة باستخدام المتغيرات ومصفوفات المتغيّرات. تملأ المتغيّرات دائمًا خلية واحدة فقط بينما قد تملأ مصفوفات المتغيّرات عدة. استخدم فقط علامة بيانات واحدة لكل خلية. يتم إزالة العلامات الذكية غير المستخدمة.

يمكن أن تحتوي العلامة الذكية أيضًا على معلمات. تسمح المعلمات بتعديل كيفية ترتيب المعلومات. يتم إلحاقها بنهاية العلامة الذكية بين قوسين كقائمة مفصولة بفاصلة.

### **خيارات العلامة الذكية**

&=مصدر البيانات.اسم الحقل
&=[مصدر البيانات].[اسم الحقل]
&=$اسم المتغير
&=$مصفوفة_المتغيرات
&==الصيغة_الديناميكية
&=&=تكرار_الصيغة_الديناميكية

### **معلمات**

يُسمح بالمعلمات التالية:

- **noadd** - عدم إضافة صفوف إضافية لتناسب البيانات.
- **skip:n** - تخطي n عدد من الصفوف لكل صف من البيانات.
- *ascending:n or descending:n - فرز البيانات في العلامات الذكية. إذا كان n يساوي 1، فإن العمود هو المفتاح الأول لجهاز الفرز. يتم فرز البيانات بعد معالجة مصدر البيانات. على سبيل المثال: &=Table1.Field3(ascending:1).
- **أفقي** - اكتب البيانات من اليسار إلى اليمين بدلاً من الأعلى إلى الأسفل.
- **رقمي** - تحويل النص إلى رقم إذا كان ذلك ممكنًا.
- **تحريك** - نقل البيانات إلى الأسفل أو اليمين، مما يؤدي إلى إنشاء صفوف أو أعمدة إضافية لاستيعاب البيانات. يعمل معلمة التحريك بنفس الطريقة كما هو الحال في مايكروسوفت إكسل. على سبيل المثال في مايكروسوفت إكسل، عند تحديد مجموعة من الخلايا، انقر بزر الماوس الأيمن وحدد **إدراج** وحدد **تحريك الخلايا للأسفل**، **تحريك الخلايا يمينًا** وغيرها من الخيارات. باختصار، تعمل معلمة التحريك على نفس النحو للعلامات الذكية الرأسية/العادية (من الأعلى إلى الأسفل) أو الأفقية (من اليسار إلى اليمين).
- **فاصوليا** - تُشير إلى أن مصدر البيانات هو POJO بسيط. مدعوم فقط في واجهة برمجة التطبيقات لجافا.

يمكن دمج المعلمات noadd و skip لإدراج البيانات في الصفوف المتناوبة. نظرًا لأن القالب يتم معالجته من الأسفل إلى الأعلى، يجب عليك إضافة noadd في الصف الأول لتجنب إدراج صفوف إضافية قبل الصف المتناوب.

إذا كان لديك معلمات متعددة، يجب فصلها بفاصلة، ولكن بدون مسافة: parameterA، parameterB، parameterC

تُظهر الصور التوضيحية التالية كيفية إدراج البيانات في كل صف آخر.

![todo:image_alt_text](using-smart-markers_1.png)

**تتحول إلى...**

![todo:image_alt_text](using-smart-markers_2.png)

### **الصيغ الديناميكية**

تتيح الصيغ الديناميكية لك إدراج صيغ Excel في الخلايا حتى عندما تشير الصيغة إلى الصفوف التي سيتم إدراجها أثناء عملية التصدير. يمكن للصيغ الديناميكية أن تتكرر لكل صف تم إدراجه أو تستخدم فقط الخلية التي يتم وضع علامة البيانات فيها.

تسمح الصيغ الديناميكية بالخيارات الإضافية التالية:

- r - رقم الصف الحالي.
- 2، -1 - الإزاحة إلى رقم الصف الحالي.

توضح الصورة التالية صيغة ديناميكية متكررة والجدول الإكسل الناتج.

![todo:image_alt_text](using-smart-markers_3.png)

**تحول إلى...**

![todo:image_alt_text](using-smart-markers_4.png)

الخلية C1 تحتوي على الصيغة =A1*B1، C2 تحتوي على = A2*B2 و C3 = A3*B3.

من السهل جدًا معالجة العلامات الذكية. يوضح الكود المثال التالي كيفية استخدام الصيغ الديناميكية في العلامات الذكية. نقوم بتحميل [ملف القالب](templateDynamicFormulas.xlsx) وإنشاء بيانات اختبارية، ثم معالجة العلامات لملء البيانات في الخلايا مقابل العلامة. 

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-DynamicFormulas-DynamicFormulas.java" >}}

## **استخدام مصفوفات متغيرة**

يوضح الكود المثال التالي كيفية استخدام مصفوفات متغيرة في العلامات الذكية. نقوم بوضع علامة مصفوفة متغيرة في الخلية A1 من الورقة العمل الأولى لدفتر العمل ديناميًا، والتي تحتوي على سلسلة من القيم التي نحددها للعلامة، ثم نقوم بمعالجة العلامات لملء البيانات في الخلايا مقابل العلامة. وأخيرًا، نقوم بحفظ ملف إكسل.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingVariableArray-UsingVariableArray.java" >}}

## **تجميع البيانات**

في بعض تقارير Excel قد تحتاج إلى تقسيم البيانات إلى مجموعات لجعلها أسهل قراءة وتحليل. أحد الأغراض الرئيسية لتقسيم البيانات إلى مجموعات هو تشغيل الحسابات (أداء عمليات ملخصية) على كل مجموعة من السجلات.

تسمح علامات Aspose.Cells الذكية بتجميع البيانات حسب الحقول المعينة ووضع صفوف ملخصية بين مجموعات البيانات أو المجموعات البيانية. على سبيل المثال، إذا تم تجميع البيانات حسب Customers.CustomerID، يمكنك إضافة سجل ملخصي في كل مرة يتغير فيها المجموعة.

### **معلمات**

فيما يلي بعض معلمات العلامة الذكية المستخدمة لتجميع البيانات.

#### **group:normal/merge/repeat**

نحن ندعم ثلاثة أنواع من التجميع يمكنك الاختيار بينها.

- **عادي** - قيمة الحقل (أو الحقول) المجمعة لن تُكرر للسجلات المقابلة في العمود؛ بدلاً من ذلك، يتم طباعتها مرة واحدة لكل مجموعة من البيانات.
- **دمج** - نفس السلوك كما في المعلمة العادية، باستثناء أنها تدمج الخلايا في الحقل (أو الحقول) المجمعة لكل مجموعة محددة.
- **تكرار** - تُكرر قيمة الحقل (أو الحقول) المجمعة للسجلات المقابلة.

على سبيل المثال: &=Customers.CustomerID(group:merge)

#### **skip**

يتخطى عددًا محددًا من الصفوف بعد كل مجموعة.

على سبيل المثال &=Employees.EmployeeID(group:normal,skip:1)

#### **subtotalN**

يؤدي عملية ملخصية لبيانات حقل محددة متعلقة بحقل مجمعة. N يمثل الأرقام بين 1 و 11 التي تحدد الوظيفة المستخدمة عند حساب المجاميع الفرعية داخل قائمة البيانات. (1=متوسط، 2=عدد، 3=COUNTA، 4=MAX، 5=MIN، ... 9=SUM إلخ.) راجع المرجع Subtotal في مساعدة Microsoft Excel لمزيد من التفاصيل.

التنسيق ينص بالفعل على:
subTotalN:Ref حيث يشير Ref إلى العمود الذي يتم التجميع حسبه.

على سبيل المثال،

- &=Products.Units(subtotal9:Products.ProductID) يُحدد وظيفة الملخص عن حقل **Units** بالنسبة لحقل **ProductID** في جدول **Products**.
- &=Tabx.Col3(subtotal9:Tabx.Col1) يُحدد وظيفة الملخص عن حقل **Col3** حسب **Col1** في الجدول **Tabx**.
- &=Table1.ColumnD(subtotal9:Table1.ColumnA&Table1.ColumnB) يوضح وظيفة الملخص لحقل **ColumnD** مجموعة حسب **ColumnA** و **ColumnB** في الجدول **Table1**.

## **استخدام الكائنات المتداخلة**

تدعم Aspose.Cells الكائنات المتداخلة في العلامات الذكية، يجب أن تكون الكائنات المتداخلة بسيطة.

نستخدم ملف قالب بسيط. انظر إلى جدول البيانات التصميمي الذي يحتوي على بعض العلامات الذكية المتداخلة.

**الصفحة العمل الأولى في ملف التصميم تظهر العلامات الذكية المتداخلة.**

![todo:image_alt_text](using-smart-markers_5.png)

المثال التالي يوضح كيفية عمل هذا. تشغيل الكود أدناه يؤدي إلى النتيجة أدناه.

**الصفحة العمل الأولى في ملف الإخراج تظهر البيانات الناتجة.**

![todo:image_alt_text](using-smart-markers_6.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingNestedObjects-UsingNestedObjects.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Individual-Individual.java" >}}

## **استخدام قائمة عامة ككائن متداخل**

تدعم Aspose.Cells الآن أيضًا استخدام قائمة عامة ككائن متداخل. يرجى التحقق من لقطة شاشة من ملف إكسيل الناتج الذي تم إنشاؤه باستخدام الكود التالي. كما يمكنك رؤية في لقطة الشاشة كائن المعلم يحتوي على العديد من الكائنات الطالبة المتداخلة.

![todo:image_alt_text](using-smart-markers_7.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingGenericList-UsingGenericList.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Teacher-Teacher.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Person-Person.java" >}}

## **استخدام خاصية HTML للعلامات الذكية**

The following sample code explains the use of the HTML property of the Smart Markers. When it will be processed, it will show "World" in "Hello World" as bold because of HTML \<b> tag.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingHTMLProperty-UsingHTMLProperty.java" >}}

## **الحصول على إشعارات أثناء دمج البيانات باستخدام العلامات الذكية**

في بعض الأحيان، قد يكون من الضروري الحصول على الإشعارات حول مرجع الخلية أو العلامة الذكية المعينة التي يتم معالجتها قبل الانتهاء. يمكن تحقيق هذا باستخدام الخاصية [**WorkbookDesigner.CallBack**](https://reference.aspose.com/cells/java/com.aspose.cells/workbookdesigner#CallBack) و [**ISmartMarkerCallBack**](https://reference.aspose.com/cells/java/com.aspose.cells/ISmartMarkerCallBack).

للحصول على رمز عينة وشرح مفصل، يرجى رؤية هذه المقالة.

- [الحصول على إشعارات أثناء دمج البيانات باستخدام العلامات الذكية](/cells/ar/java/getting-notifications-while-merging-data-with-smart-markers/)
