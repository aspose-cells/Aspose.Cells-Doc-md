---
title: استخدام العلامات الذكية
type: docs
weight: 40
url: /ar/java/using-smart-markers/
---
##  **مقدمة**

{{% alert color="primary" %}}

**علامات ذكية** تُستخدم للسماح لـ Aspose.Cells بمعرفة المعلومات التي يجب وضعها في Microsoft Excel[جدول بيانات المصمم](/cells/ar/java/what-is-a-designer-spreadsheet/). تسمح لك العلامات الذكية بإنشاء قوالب تحتوي فقط على المعلومات والتنسيقات ذات الصلة.

{{% /alert %}}

##  **مصمم جداول البيانات والعلامات الذكية**

جداول بيانات المصمم هي ملفات Excel قياسية تحتوي على تنسيق مرئي وصيغ وعلامات ذكية. ويمكن أن تحتوي على علامات ذكية تشير إلى مصدر بيانات واحد أو أكثر، مثل معلومات من مشروع ومعلومات لجهات الاتصال ذات الصلة. تتم كتابة العلامات الذكية في الخلايا التي تريد الحصول على المعلومات فيها.

تبدأ جميع العلامات الذكية بـ &=. مثال على علامة البيانات هو &=Party.FullName. إذا نتج عن علامة البيانات أكثر من عنصر واحد، على سبيل المثال، صف كامل، فسيتم نقل الصفوف التالية لأسفل تلقائيًا لإفساح المجال للمعلومات الجديدة. ومن ثم، يمكن وضع الإجماليات الفرعية والإجماليات في الصف مباشرة بعد علامة البيانات لإجراء العمليات الحسابية بناءً على البيانات المدرجة. لإجراء حسابات على الصفوف المدرجة، استخدم[الصيغ الديناميكية](/cells/ar/java/using-smart-markers/#dynamic-formulas).

 تتكون العلامات الذكية من**مصدر البيانات** و**اسم الحقل** أجزاء لمعظم المعلومات. يمكن أيضًا تمرير معلومات خاصة باستخدام المتغيرات والمصفوفات المتغيرة. تملأ المتغيرات دائمًا خلية واحدة فقط بينما قد تملأ المصفوفات المتغيرة عدة خلايا. استخدم علامة بيانات واحدة فقط لكل خلية. تتم إزالة العلامات الذكية غير المستخدمة.

قد تحتوي العلامة الذكية أيضًا على معلمات. تسمح لك المعلمات بتعديل كيفية عرض المعلومات. ويتم إلحاقها بنهاية العلامة الذكية بين قوسين كقائمة مفصولة بفواصل.

###  **خيارات العلامة الذكية**

&=DataSource.FieldName
&=[مصدر البيانات].[اسم الحقل]
&=$VariableName
&=$VariableArray
&==DynamicFormula
&=&=RepeatDynamicFormula

###  **حدود**

المعلمات التالية مسموح بها:

- **لا إضافة** - لا تقم بإضافة صفوف إضافية لملاءمة البيانات.
- **تخطي: ن** - تخطي عدد n من الصفوف لكل صف من البيانات.
- *تصاعدي:ن أو تنازلي:ن - فرز البيانات في علامات ذكية. إذا كانت n تساوي 1، فإن العمود هو المفتاح الأول للفارز. يتم فرز البيانات بعد معالجة مصدر البيانات. على سبيل المثال: &=Table1.Field3(تصاعدي:1).
- **أفقي** - كتابة البيانات من اليسار إلى اليمين، بدلاً من الأعلى إلى الأسفل.
- **رقمي** - تحويل النص إلى رقم إذا أمكن.
- **يحول** - التحول إلى الأسفل أو اليمين، وإنشاء صفوف أو أعمدة إضافية لتناسب البيانات. تعمل معلمة Shift بنفس الطريقة كما في Microsoft Excel. على سبيل المثال، في Microsoft Excel، عندما تحدد نطاقًا من الخلايا، انقر بزر الماوس الأيمن وحدد**إدراج** وتحديد**إزاحة الخلايا إلى الأسفل**، **إزاحة الخلايا إلى اليمين** وخيارات أخرى. باختصار، تقوم معلمة Shift بملء نفس الوظيفة للعلامات الذكية الرأسية/العادية (من الأعلى إلى الأسفل) أو الأفقية (من اليسار إلى اليمين).
- **فاصوليا** - يشير إلى أن مصدر البيانات هو POJO بسيط. مدعوم فقط في Java API.

يمكن دمج المعلمات noadd وskip لإدراج البيانات في الصفوف البديلة. نظرًا لأنه تتم معالجة القالب من الأسفل إلى الأعلى، يجب عليك إضافة noadd في الصف الأول لتجنب إدراج صفوف إضافية قبل الصف البديل.

إذا كان لديك معلمات متعددة، فافصل بينها بفاصلة، ولكن بدون مسافة: ParameterA,parameterB,parameterC

توضح لقطات الشاشة التالية كيفية إدراج البيانات في كل صف آخر.

![ما يجب القيام به:image_alt_text](using-smart-markers_1.png)

**يصبح...**

![ما يجب القيام به:image_alt_text](using-smart-markers_2.png)

###  **الصيغ الديناميكية**

تسمح لك الصيغ الديناميكية بإدراج صيغ Excel في الخلايا حتى عندما تشير الصيغة إلى الصفوف التي سيتم إدراجها أثناء عملية التصدير. يمكن تكرار الصيغ الديناميكية لكل صف مدرج أو استخدام الخلية التي تم وضع علامة البيانات فيها فقط.

تسمح الصيغ الديناميكية بالخيارات الإضافية التالية:

- ص - رقم الصف الحالي.
- 2، -1 - إزاحة رقم الصف الحالي.

يوضح ما يلي صيغة ديناميكية متكررة وورقة عمل Excel الناتجة.

![ما يجب القيام به:image_alt_text](using-smart-markers_3.png)

**يصبح…**

![ما يجب القيام به:image_alt_text](using-smart-markers_4.png)

Cell C1 يحتوي على الصيغة =A1*B1، C2 يحتوي على = A2*B2 وC3 = A3*B3.

 من السهل جدًا معالجة العلامات الذكية. يوضح رمز المثال التالي كيفية استخدام الصيغ الديناميكية في العلامات الذكية. نقوم بتحميل[ملف نموذجي](templateDynamicFormulas.xlsx) وإنشاء بيانات اختبار، ومعالجة العلامات لملء البيانات في الخلايا مقابل العلامة.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-DynamicFormulas-DynamicFormulas.java" >}}

##  **استخدام المصفوفات المتغيرة**

يوضح رمز المثال التالي كيفية استخدام المصفوفات المتغيرة في العلامات الذكية. نضع علامة صفيف متغيرة في خلية A1 من ورقة العمل الأولى للمصنف ديناميكيًا والتي تحتوي على سلسلة من القيم التي قمنا بتعيينها للعلامة، ونقوم بمعالجة العلامات لملء البيانات في الخلايا مقابل العلامة. وأخيرا، نقوم بحفظ ملف Excel.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingVariableArray-UsingVariableArray.java" >}}

##  **تجميع البيانات**

في بعض تقارير Excel، قد تحتاج إلى تقسيم البيانات إلى مجموعات لتسهيل قراءتها وتحليلها. أحد الأغراض الأساسية لتقسيم البيانات إلى مجموعات هو إجراء العمليات الحسابية (إجراء عمليات تلخيصية) على كل مجموعة من السجلات.

تتيح لك العلامات الذكية Aspose.Cells تجميع البيانات حسب مجموعة الحقول ووضع صفوف التلخيص بين مجموعات البيانات أو مجموعات البيانات. على سبيل المثال، في حالة تجميع البيانات حسب Customers.CustomerID، يمكنك إضافة سجل ملخص في كل مرة تتغير فيها المجموعة.

###  **حدود**

فيما يلي بعض معلمات العلامة الذكية المستخدمة لتجميع البيانات.

####  **المجموعة: عادي/دمج/تكرار**

نحن ندعم ثلاثة أنواع من المجموعات التي يمكنك الاختيار من بينها.

- **طبيعي** - لا يتم تكرار التجميع حسب قيمة الحقل (الحقول) للسجلات المقابلة في العمود؛ بدلاً من ذلك تتم طباعتها مرة واحدة لكل مجموعة بيانات.
- **دمج** - نفس سلوك المعلمة العادية، باستثناء أنها تقوم بدمج الخلايا في المجموعة حسب الحقل (الحقول) لكل مجموعة مجموعة.
- **يكرر** - يتم تكرار المجموعة حسب قيمة الحقل (الحقول) للسجلات المقابلة.

على سبيل المثال: &=Customers.CustomerID(group:merge)

####  **يتخطى**

تخطي عدد محدد من الصفوف بعد كل مجموعة.

على سبيل المثال &=Employees.EmployeeID(group:normal,skip:1)

####  **المجموع الفرعي ن**

تنفيذ عملية تلخيصية لبيانات حقل محددة مرتبطة بمجموعة حسب الحقل. يمثل N الأرقام بين 1 و11 التي تحدد الوظيفة المستخدمة عند حساب الإجماليات الفرعية ضمن قائمة البيانات. (1=المتوسط، 2=COUNT، 3=COUNTA، 4=MAX، 5=MIN،...9=SUM وما إلى ذلك) راجع مرجع الإجمالي الفرعي في تعليمات Microsoft Excel للحصول على مزيد من التفاصيل.

ينص التنسيق في الواقع على ما يلي:
subtotalN:Ref حيث يشير Ref إلى المجموعة حسب العمود.

على سبيل المثال،

-  &=Products.Units(subtotal9:Products.ProductID) يحدد وظيفة التلخيص عليها**الوحدات** المجال فيما يتعلق**معرف المنتج** الميدان في**منتجات** طاولة.
-  &=Tabx.Col3(subtotal9:Tabx.Col1) يحدد وظيفة التلخيص على**العمود 3** المجموعة الميدانية بواسطة**العمود 1** في الجدول *Tabx**.
-  &=Table1.ColumnD(subtotal9:Table1.ColumnA&Table1.ColumnB) يحدد دالة التلخيص عليها**العمود د** المجموعة الميدانية بواسطة**العمود أ** و**العمود ب** في الجدول *الجدول1**.

##  **استخدام الكائنات المتداخلة**

Aspose.Cells يدعم الكائنات المتداخلة في العلامات الذكية، ويجب أن تكون الكائنات المتداخلة بسيطة.

نحن نستخدم ملف قالب بسيط. راجع جدول بيانات المصمم الذي يحتوي على بعض العلامات الذكية المتداخلة.

**تعرض ورقة العمل الأولى من ملف المصمم العلامات الذكية المتداخلة.**

![ما يجب القيام به:image_alt_text](using-smart-markers_5.png)

يوضح المثال التالي كيف يعمل هذا. يؤدي تشغيل الكود أدناه إلى الإخراج أدناه.

**تظهر ورقة العمل الأولى لملف الإخراج البيانات الناتجة.**

![ما يجب القيام به:image_alt_text](using-smart-markers_6.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingNestedObjects-UsingNestedObjects.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Individual-Individual.java" >}}

##  **استخدام القائمة العامة ككائن متداخل**

Aspose.Cells يدعم الآن أيضًا استخدام القائمة العامة ككائن متداخل. يرجى التحقق من لقطة الشاشة لملف Excel الناتج الذي تم إنشاؤه بالكود التالي. كما ترون في لقطة الشاشة، يحتوي كائن المعلم على عدة كائنات طلابية متداخلة.

![ما يجب القيام به:image_alt_text](using-smart-markers_7.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingGenericList-UsingGenericList.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Teacher-Teacher.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Person-Person.java" >}}

##  **استخدام خاصية HTML للعلامات الذكية**

يشرح نموذج التعليمات البرمجية التالي استخدام خاصية HTML الخاصة بالعلامات الذكية. عندما تتم معالجتها، ستظهر "العالم" في "Hello World" بالخط العريض بسبب HTML \<b> بطاقة شعار.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingHTMLProperty-UsingHTMLProperty.java" >}}

##  **الحصول على إشعارات أثناء دمج البيانات مع العلامات الذكية**

 في بعض الأحيان، قد يكون من الضروري الحصول على إشعارات حول مرجع الخلية أو العلامة الذكية المحددة التي تتم معالجتها قبل الإكمال. ويمكن تحقيق ذلك باستخدام[**WorkbookDesigner.CallBack**](https://reference.aspose.com/cells/java/com.aspose.cells/workbookdesigner#CallBack)الملكية و[**ISmartMarkerCallBack**](https://reference.aspose.com/cells/java/com.aspose.cells/ISmartMarkerCallBack)

للحصول على نموذج التعليمات البرمجية والشرح التفصيلي، يرجى مراجعة هذه المقالة.

- [الحصول على إشعارات أثناء دمج البيانات مع العلامات الذكية](/cells/ar/java/getting-notifications-while-merging-data-with-smart-markers/)
