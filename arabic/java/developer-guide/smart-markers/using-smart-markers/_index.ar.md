---
title: استخدام العلامات الذكية
type: docs
weight: 40
url: /ar/java/using-smart-markers/
---
## **مقدمة**

{{% alert color="primary" %}}

**علامات ذكية** تُستخدم للسماح لـ Aspose.Cells بمعرفة المعلومات التي يجب وضعها في Microsoft Excel[جدول بيانات المصمم](/cells/ar/java/what-is-a-designer-spreadsheet/). تسمح لك العلامات الذكية بإنشاء قوالب تحتوي فقط على معلومات وتنسيقات ذات صلة.

{{% /alert %}}

## **جدول بيانات مصمم وعلامات ذكية**

جداول بيانات المصمم هي ملفات Excel قياسية تحتوي على تنسيق مرئي وصيغ وعلامات ذكية. يمكن أن تحتوي على علامات ذكية تشير إلى مصدر بيانات واحد أو أكثر ، مثل معلومات من مشروع ومعلومات عن جهات الاتصال ذات الصلة. تتم كتابة العلامات الذكية في الخلايا حيث تريد المعلومات.

 تبدأ جميع العلامات الذكية بـ & =. مثال على علامة البيانات هو & = Party.FullName. إذا نتج عن علامة البيانات أكثر من عنصر واحد ، على سبيل المثال ، صف كامل ، فسيتم نقل الصفوف التالية إلى أسفل تلقائيًا لإفساح المجال للمعلومات الجديدة. وبالتالي يمكن وضع المجاميع الفرعية والإجماليات في الصف مباشرة بعد علامة البيانات لإجراء الحسابات بناءً على البيانات المدرجة. لإجراء عمليات حسابية على الصفوف المدرجة ، استخدم[الصيغ الديناميكية](/cells/ar/java/using-smart-markers/#dynamic-formulas).

 تتكون العلامات الذكية من**مصدر البيانات** و**اسم الحقل**أجزاء لمعظم المعلومات. يمكن أيضًا تمرير معلومات خاصة مع المتغيرات والمصفوفات المتغيرة. تملأ المتغيرات دائمًا خلية واحدة فقط بينما قد تملأ المصفوفات المتغيرة عدة خلايا. استخدم فقط علامة بيانات واحدة لكل خلية. تتم إزالة العلامات الذكية غير المستخدمة.

قد تحتوي العلامة الذكية أيضًا على معلمات. تسمح لك المعلمات بتعديل كيفية وضع المعلومات. يتم إلحاقها بنهاية العلامة الذكية بين قوسين كقائمة مفصولة بفواصل.

### **خيارات العلامة الذكية**

& = مصدر البيانات
& = [مصدر البيانات]. [اسم الحقل] & = $ VariableName
& = $ VariableArray
& == الصيغة الديناميكية
& = & = RepeatDynamicFormula

### **حدود**

يُسمح بالمعلمات التالية:

- **لا إضافة** - لا تقم بإضافة صفوف إضافية لتناسب البيانات.
- **تخطي:** - تخطي عدد n من الصفوف لكل صف من البيانات.
- تصاعدي: n أو تنازلي: n - فرز البيانات في العلامات الذكية. إذا كان n هو 1 ، فإن العمود هو المفتاح الأول للفرز. يتم فرز البيانات بعد معالجة مصدر البيانات. على سبيل المثال: & = Table1.Field3 (تصاعدي: 1).
- **عرضي** - اكتب البيانات من اليسار إلى اليمين ، بدلاً من كتابة البيانات من أعلى إلى أسفل.
- **رقمي** - تحويل النص إلى رقم إن أمكن.
- **تحول** - التحول لأسفل أو لليمين ، وإنشاء صفوف أو أعمدة إضافية لتناسب البيانات. تعمل معلمة التحول بنفس الطريقة كما في Microsoft Excel. على سبيل المثال في Microsoft Excel ، عند تحديد نطاق من الخلايا ، انقر بزر الماوس الأيمن وحدد**إدراج** وتحديد**تحول الخلايا إلى أسفل**, **خلايا تحول الحق** وخيارات أخرى. باختصار ، تملأ معلمة التحول نفس الوظيفة للعلامات الذكية الرأسية / العادية (من أعلى إلى أسفل) أو الأفقية (من اليسار إلى اليمين).
- **فاصوليا** - يشير إلى أن مصدر البيانات هو POJO بسيط. مدعوم فقط في Java API.

يمكن دمج المعلمات noadd و skip لإدراج البيانات في الصفوف المتناوبة. نظرًا لأنه تتم معالجة القالب من الأسفل إلى الأعلى ، يجب إضافة noadd في الصف الأول لتجنب إدراج صفوف إضافية قبل الصف البديل.

إذا كان لديك العديد من المعلمات ، فافصل بينها بفاصلة ، لكن بدون مسافة: معلمة A ، معلمة B ، معلمة C

توضح لقطات الشاشة التالية كيفية إدراج البيانات في كل صف آخر.

![ما يجب القيام به: image_بديل_نص](using-smart-markers_1.png)

**يصبح ...**

![ما يجب القيام به: image_بديل_نص](using-smart-markers_2.png)

### **الصيغ الديناميكية**

تسمح لك الصيغ الديناميكية بإدراج صيغ Excel في الخلايا حتى عندما تشير الصيغة إلى صفوف سيتم إدراجها أثناء عملية التصدير. يمكن أن تتكرر الصيغ الديناميكية لكل صف مدرج أو تستخدم فقط الخلية حيث يتم وضع علامة البيانات.

تسمح الصيغ الديناميكية بالخيارات الإضافية التالية:

- r - رقم الصف الحالي.
- 2 ، -1 - الإزاحة لرقم الصف الحالي.

يوضح ما يلي صيغة ديناميكية متكررة وورقة عمل Excel الناتجة.

![ما يجب القيام به: image_بديل_نص](using-smart-markers_3.png)

**يصبح ...**

![ما يجب القيام به: image_بديل_نص](using-smart-markers_4.png)

يحتوي Cell C1 على الصيغة = A1*يحتوي B1 ، C2 على = A2*B2 و C3 = A3 * B3.

من السهل جدًا معالجة العلامات الذكية. يوضح مقتطف الشفرة التالي كيف يتم ذلك.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-DynamicFormulas-DynamicFormulas.java" >}}

## **استخدام المصفوفات المتغيرة**

يوضح رمز المثال التالي كيفية استخدام المصفوفات المتغيرة في Smart Markers. نضع علامة صفيف متغيرة في خلية A1 من ورقة العمل الأولى من المصنف ديناميكيًا والتي تحتوي على سلسلة من القيم التي قمنا بتعيينها للعلامة ، ومعالجة العلامات لملء البيانات في الخلايا مقابل العلامة. أخيرًا ، نحفظ ملف Excel.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingVariableArray-UsingVariableArray.java" >}}

## **تجميع البيانات**

في بعض تقارير Excel ، قد تحتاج إلى تقسيم البيانات إلى مجموعات لتسهيل قراءتها وتحليلها. أحد الأغراض الأساسية لتقسيم البيانات إلى مجموعات هو إجراء العمليات الحسابية (إجراء عمليات موجزة) على كل مجموعة من السجلات.

تسمح لك العلامات الذكية Aspose.Cells بتجميع البيانات حسب مجموعة الحقول ووضع صفوف التلخيص بين مجموعات البيانات أو مجموعات البيانات. على سبيل المثال ، في حالة تجميع البيانات حسب Customer.CustomerID ، يمكنك إضافة سجل ملخص في كل مرة تتغير فيها المجموعة.

### **حدود**

فيما يلي بعض معلمات العلامات الذكية المستخدمة لتجميع البيانات.

#### **المجموعة: عادي / دمج / كرر**

نحن ندعم ثلاثة أنواع من المجموعات يمكنك الاختيار من بينها.

- **عادي** - لا تتكرر قيمة المجموعة حسب الحقل (الحقول) للسجلات المقابلة في العمود ؛ بدلاً من ذلك يتم طباعتها مرة واحدة لكل مجموعة بيانات.
- **دمج** - نفس سلوك المعلمة العادية ، باستثناء أنها تدمج الخلايا في المجموعة حسب المجال (الحقول) لكل مجموعة مجموعة.
- **كرر** - تتكرر قيمة المجموعة حسب الحقل (الحقول) للسجلات المقابلة.

على سبيل المثال: & = Customers.CustomerID (group: merge)

#### **تخطى**

يتخطى عددًا محددًا من الصفوف بعد كل مجموعة.

على سبيل المثال & = Employees.EmployeeID (مجموعة: عادي ، تخطي: 1)

#### **المجموع الفرعي**

ينفذ عملية موجزة لبيانات حقل محددة مرتبطة بمجموعة حسب الحقل. يمثل N الأرقام بين 1 و 11 والتي تحدد الوظيفة المستخدمة عند حساب المجاميع الفرعية ضمن قائمة البيانات. (1 = AVERAGE ، 2 = COUNT ، 3 = COUNTA ، 4 = MAX ، 5 = MIN ، ... 9 = SUM وما إلى ذلك) راجع المرجع الإجمالي الفرعي في تعليمات Excel Microsoft للحصول على مزيد من التفاصيل.

يوضح التنسيق في الواقع على النحو التالي:
المجموع الفرعي N: المرجع حيث يشير المرجع إلى المجموعة حسب العمود.

على سبيل المثال،

-  & = Products.Units (الإجمالي الفرعي 9: Products.ProductID) تحدد وظيفة التلخيص عليها**الوحدات** المجال فيما يتعلق**معرف المنتج** المجال في**منتجات** الطاولة.
-  & = Tabx.Col3 (المجموع الفرعي 9: Tabx.Col1) يحدد دالة التلخيص على ملف**Col3** المجموعة الميدانية**العمود 1** في الطاولة**تابكس**.
-  & = Table1.ColumnD (المجموع الفرعي 9: Table1.ColumnA & Table1.ColumnB) يحدد وظيفة التلخيص عند**العمود د** المجموعة الميدانية**العمود** و**العمود ب** في الجدول**الجدول 1**.

## **استخدام الكائنات المتداخلة**

يدعم Aspose.Cells الكائنات المتداخلة في العلامات الذكية ، يجب أن تكون الكائنات المتداخلة بسيطة.

نحن نستخدم ملف قالب بسيط. راجع جدول بيانات المصمم الذي يحتوي على بعض العلامات الذكية المتداخلة.

**تعرض ورقة العمل الأولى لملف المصمم العلامات الذكية المتداخلة.**

![ما يجب القيام به: image_بديل_نص](using-smart-markers_5.png)

المثال التالي يوضح كيف يعمل هذا. تشغيل الكود أدناه ينتج عنه الإخراج أدناه.

**تظهر ورقة العمل الأولى من ملف الإخراج البيانات الناتجة.**

![ما يجب القيام به: image_بديل_نص](using-smart-markers_6.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingNestedObjects-UsingNestedObjects.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Individual-Individual.java" >}}

## **استخدام قائمة عامة ككائن متداخل**

يدعم Aspose.Cells الآن أيضًا استخدام قائمة عامة كعنصر متداخل. يرجى التحقق من لقطة الشاشة لملف excel الناتج الذي تم إنشاؤه بالرمز التالي. كما ترى في لقطة الشاشة ، يحتوي كائن المدرس على كائنات متعددة متداخلة للطلاب.

![ما يجب القيام به: image_بديل_نص](using-smart-markers_7.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingGenericList-UsingGenericList.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Teacher-Teacher.java" >}}

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-Person-Person.java" >}}

## **استخدام خاصية HTML للعلامات الذكية**

يوضح نموذج التعليمات البرمجية التالي استخدام خاصية HTML للعلامات الذكية. عند معالجتها ، ستظهر "World" في "Hello World" بالخط العريض بسبب HTML \<b> بطاقة شعار.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-SmartMarkers-UsingHTMLProperty-UsingHTMLProperty.java" >}}

## **الحصول على إخطارات أثناء دمج البيانات مع العلامات الذكية**

 في بعض الأحيان ، قد يكون من الضروري الحصول على إعلامات حول مرجع الخلية أو العلامة الذكية المعينة التي تتم معالجتها قبل الإكمال. يمكن تحقيق ذلك باستخدام[**المصمم المصمم**](https://reference.aspose.com/cells/java/com.aspose.cells/workbookdesigner#CallBack)الملكية و[**ISmartMarkerCallBack**](https://reference.aspose.com/cells/java/com.aspose.cells/ISmartMarkerCallBack)

للحصول على نموذج التعليمات البرمجية والشرح التفصيلي ، يرجى الاطلاع على هذه المقالة.

- [الحصول على إخطارات أثناء دمج البيانات مع العلامات الذكية](/cells/ar/java/getting-notifications-while-merging-data-with-smart-markers/)
