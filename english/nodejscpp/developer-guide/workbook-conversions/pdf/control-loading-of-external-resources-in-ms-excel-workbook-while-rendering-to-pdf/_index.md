---
title: Control loading of External Resources in MS Excel Workbook while rendering to PDF with Node.js via C++
linktitle: Control loading of External Resources in MS Excel Workbook while rendering to PDF
type: docs
weight: 40
url: /nodejs-cpp/control-loading-of-external-resources-in-ms-excel-workbook-while-rendering-to-pdf/
description: Learn how to control the loading of external resources in Excel while rendering to PDF using Aspose.Cells for Node.js via C++. 
---

## **Possible Usage Scenarios**

Your Excel file may contain external resources e.g. linked images or objects. When you convert your Excel file to PDF, Aspose.Cells retrieves these external resources and renders them to PDF. But sometimes, you do not want to load these external resources and more than that, you want to manipulate them. You can do this using [**WorkbookSettings.streamProvider**](https://reference.aspose.com/cells/nodejs-cpp/workbooksettings/#streamProvider) which implements the [**IStreamProvider**](https://reference.aspose.com/cells/nodejs-cpp/istreamprovider) interface.

## **Control loading of External Resources in MS Excel Workbook while rendering to PDF**

The following sample code explains how to make use of [**WorkbookSettings.streamProvider**](https://reference.aspose.com/cells/nodejs-cpp/workbooksettings/#streamProvider) to control the loading of external resources and manipulate them. Please check the [sample Excel file](50528322.xlsx) used inside the code and the [output PDF](50528325.pdf) generated by the code. The [screenshot](50528326.png) shows how the [old external image](50528324.png) in the sample Excel file was replaced with a [new image](50528323.png) in the output PDF.

![todo:image_alt_text](control-loading-of-external-resources-in-ms-excel-workbook-while-rendering-to-pdf_1.png)

## **Sample Code**

```javascript
const path = require("path");
const AsposeCells = require("aspose.cells.node");

class MyStreamProvider {
closeStream(options) {
console.log("-----Close Stream-----");
}

initStream(options) {
const sourceDir = path.join(__dirname, "data");
console.log("-----Init Stream-----");

// Read the new image in a memory stream and assign it to Stream property
const fs = require("fs");
const bts = fs.readFileSync(path.join(sourceDir, "newPdfSaveOptions_StreamProvider.png"));
options.stream = bts; // Assigning the byte array to the stream property
}
}

async function run() {
// Source directory
const sourceDir = path.join(__dirname, "data");

// Output directory
const outputDir = path.join(__dirname, "output");

// Load source Excel file containing external image
const workbook = new AsposeCells.Workbook(path.join(sourceDir, "samplePdfSaveOptions_StreamProvider.xlsx"));

// Specify Pdf Save Options - Stream Provider
const opts = new AsposeCells.PdfSaveOptions();
opts.setOnePagePerSheet(true);

workbook.getSettings().setResourceProvider(new MyStreamProvider());

// Save the workbook to Pdf
await workbook.saveAsync(path.join(outputDir, "outputPdfSaveOptions_StreamProvider.pdf"), opts);

console.log("ControlLoadingOfExternalResourcesInExcelToPDF executed successfully.\r\n");
}
```
