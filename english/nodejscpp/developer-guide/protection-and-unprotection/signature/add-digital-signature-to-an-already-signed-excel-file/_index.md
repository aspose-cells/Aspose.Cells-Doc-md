---
title: Add Digital Signature to an already signed Excel file with Node.js via C++
linktitle: Add Digital Signature to an already signed Excel file
type: docs
weight: 20
url: /nodejs-cpp/add-digital-signature-to-an-already-signed-excel-file/
description: This article describes how to add a digital signature to an already signed Excel file using Node.js with Aspose.Cells for Node.js via C++.
keywords: Add Digital Signature to an already signed Excel file, How to add a digital signature to an already signed Excel document using Node.js via C++.
---

## **Possible Usage Scenarios**

Aspose.Cells for Node.js via C++ provides the [**Workbook.addDigitalSignature(digitalSignatureCollection)**](https://reference.aspose.com/cells/nodejs-cpp/workbook/#addDigitalSignature-digitalSignatureCollection-) method that you can use to add a digital signature to an already signed Excel file.

{{% alert color="primary" %}}

Please note while adding a digital signature to an already signed Excel document, if the original document is an Aspose.Cells generated document, it works well. But if the original document is generated by other engines (e.g. Microsoft Excel etc.), Aspose.Cells cannot keep the file the same after loading and re-saving it, which will make the original signature invalid.

{{% /alert %}}

## **How to Add Digital Signature to an Already Signed Excel File**

The following sample code demonstrates how to make use of the [**Workbook.addDigitalSignature(digitalSignatureCollection)**](https://reference.aspose.com/cells/nodejs-cpp/workbook/#addDigitalSignature-digitalSignatureCollection-) method to add a digital signature to an already signed Excel file. Please check the [sample Excel file](50528280.xlsx) used in this code. This file is already digitally signed. Please check the [output Excel file](50528281.xlsx) generated by the code. We have used the demo certificate named [AsposeDemo.pfx](50528279.pfx) in this code, which has a password **aspose**. The screenshot shows the effect of the sample code on the sample Excel file after execution.

![todo:image_alt_text](add-digital-signature-to-an-already-signed-excel-file_1.png)

## **Sample Code**

```javascript
const AsposeCells = require("aspose.cells.node");
const path = require("path");

// Certificate file path and password
const certFileName = path.join(__dirname, "AsposeDemo.pfx");
const password = "aspose";

// Load the workbook which is already digitally signed to add new digital signature
const workbook = new AsposeCells.Workbook(path.join(__dirname, "sampleDigitallySignedByCells.xlsx"));

// Create the digital signature collection
const dsCollection = new AsposeCells.DigitalSignatureCollection();

// Create new certificate
const certificate = new AsposeCells.X509Certificate(certFileName, password); // Adjust according to C++ addon specifics

// Create new digital signature and add it in digital signature collection
const signature = new AsposeCells.DigitalSignature(certificate, "Aspose.Cells added new digital signature in existing digitally signed workbook.", new Date());
dsCollection.add(signature);

// Add digital signature collection inside the workbook
workbook.addDigitalSignature(dsCollection);

// Save the workbook and dispose of it.
workbook.save(path.join(__dirname, "outputDigitallySignedByCells.xlsx"));
workbook.dispose();
```
