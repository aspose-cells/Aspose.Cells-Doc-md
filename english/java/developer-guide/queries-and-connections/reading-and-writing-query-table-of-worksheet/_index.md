---
title: Reading and Writing Query Table of Worksheet
type: docs
weight: 560
url: /java/reading-and-writing-query-table-of-worksheet/
ai_search_scope: cells_java
ai_search_endpoint: "https://docsearch.api.aspose.cloud/ask"
---

{{% alert color="primary" %}} 

Aspose.Cells provides [Worksheet.getQueryTables()](https://reference.aspose.com/cells/java/com.aspose.cells/worksheet#getQueryTables--) collection which returns the [QueryTableCollection](https://reference.aspose.com/cells/java/com.aspose.cells/QueryTableCollection). To get a specific [QueryTable](https://reference.aspose.com/cells/java/com.aspose.cells/QueryTable), use the [QueryTableCollection.get()](https://reference.aspose.com/cells/java/com.aspose.cells/querytablecollection#get-int-) property and pass the index of the QueryTable. The [QueryTable](https://reference.aspose.com/cells/java/com.aspose.cells/QueryTable) class has the following two properties for adjusting the QueryTable.

- [QueryTable.getAdjustColumnWidth()](https://reference.aspose.com/cells/java/com.aspose.cells/querytable#getAdjustColumnWidth--)
- [QueryTable.getPreserveFormatting()](https://reference.aspose.com/cells/java/com.aspose.cells/querytable#getPreserveFormatting--)

These are both boolean values. You can view them in Microsoft Excel via Data > Connections > Properties.

{{% /alert %}} 
## **Reading and Writing Query Table of Worksheet**
The following sample code reads the first [QueryTable](https://reference.aspose.com/cells/java/com.aspose.cells/QueryTable) of the first worksheet and then prints both of the [QueryTable](https://reference.aspose.com/cells/java/com.aspose.cells/QueryTable) properties. Then it sets the [QueryTable.PreserveFormatting](https://reference.aspose.com/cells/java/com.aspose.cells/querytable#setPreserveFormatting-boolean-) to **true**.

The following screenshot shows the [source excel file](5472578.xlsx) used in the code and its properties showing both of the [QueryTable](https://reference.aspose.com/cells/java/com.aspose.cells/QueryTable) values.

![todo:image_alt_text](reading-and-writing-query-table-of-worksheet_1.png)

The following screenshot shows the [output excel file](5472574.xlsx) generated by the code and its properties showing both of the [QueryTable](https://reference.aspose.com/cells/java/com.aspose.cells/QueryTable) values. As you can see the Preserved Formatting checkbox is checked now.

![todo:image_alt_text](reading-and-writing-query-table-of-worksheet_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-ReadingAndWritingQueryTable-ReadingAndWritingQueryTable.java" >}}
## **Console Output**
Here is the console output of the above sample code

{{< highlight java >}}

 Adjust Column Width: true

Preserve Formatting: false

{{< /highlight >}}

## **Retrieve query table result range**
Aspose.Cells provides the option to read the address i.e. result range of cells for a query table. Following code demonstrates this feature by reading the address of result range for a query table. The sample file can be downloaded [here](QueryTXT.xlsx).

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-ReadingAndWritingQueryTable-RetrieveQueryTableResultRange.java" >}}
{{< app/cells/assistant language="java" >}}
