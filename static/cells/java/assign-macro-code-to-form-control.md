##Assign Macro Code to Form Control
Aspose.Cells allows you to assign a Macro Code to a Form Control like a Button. Please use the [ShapeCollection.addShape()](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection#addShape-int-int-int-int-int-int-int-) method to assign a new Macro Code to a Form Control inside the workbook.
## **Assigning Macro Code to Form Control using Aspose.Cells**
The following sample code creates a new workbook, assign a Macro Code to a Form Buttom and saves the output in the XLSM format. Once, you will open the output XLSM file in Microsoft Excel you will see the following macro code.
Sub ShowMessage()
MsgBox "Welcome to Aspose!"
End Sub
Here is a sample code to generate the output XLSMÂ file with Macro Code.
