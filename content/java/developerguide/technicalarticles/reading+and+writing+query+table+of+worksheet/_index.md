---
title : "Reading and Writing Query Table of Worksheet" 
description : "" 
weight : 12523 
toc : false
type: docs
url: /java/developerguide/technicalarticles/reading+and+writing+query+table+of+worksheet/
---

# Aspose.Cells for Java : Reading and Writing Query Table of Worksheet


Aspose.Cells provides [Worksheet.getQueryTables()](https://apireference.aspose.com/java/cells/com.aspose.cells/worksheet#QueryTables) collection which returns the [QueryTableCollection](https://apireference.aspose.com/java/cells/com.aspose.cells/QueryTableCollection). To get a specific [QueryTable](https://apireference.aspose.com/java/cells/com.aspose.cells/QueryTable), use the [QueryTableCollection.get()](https://apireference.aspose.com/java/cells/com.aspose.cells/querytablecollection#Item%20(int)) property and pass the index of the QueryTable. The [QueryTable](https://apireference.aspose.com/java/cells/com.aspose.cells/QueryTable) class has the following two properties for adjusting the QueryTable.

*   [QueryTable.getAdjustColumnWidth()](https://apireference.aspose.com/java/cells/com.aspose.cells/querytable#AdjustColumnWidth)
*   [QueryTable.getPreserveFormatting()](https://apireference.aspose.com/java/cells/com.aspose.cells/querytable#PreserveFormatting)

These are both boolean values. You can view them in Microsoft Excel via `Data > Connections > Properties`.

#### Reading and Writing Query Table of Worksheet

The following sample code reads the first [QueryTable](https://apireference.aspose.com/java/cells/com.aspose.cells/QueryTable) of the first worksheet and then prints both of the [QueryTable](https://apireference.aspose.com/java/cells/com.aspose.cells/QueryTable) properties. Then it sets the [QueryTable.PreserveFormatting](https://apireference.aspose.com/java/cells/com.aspose.cells/querytable#PreserveFormatting) to **true**.

The following screenshot shows the [source excel file](https://docs2.aspose.com/cells/java/attachments/5275858/5472578.xlsx) used in the code and its properties showing both of the [QueryTable](https://apireference.aspose.com/java/cells/com.aspose.cells/QueryTable) values.

![](https://docs2.aspose.com/cells/java/attachments/5275858/5472575.png)

The following screenshot shows the [output excel file](https://docs2.aspose.com/cells/java/attachments/5275858/5472574.xlsx) generated by the code and its properties showing both of the [QueryTable](https://apireference.aspose.com/java/cells/com.aspose.cells/QueryTable) values. As you can see the Preserved Formatting checkbox is checked now.

![](https://docs2.aspose.com/cells/java/attachments/5275858/5472576.png)


#### Console Output

Here is the console output of the above sample code

{{< code lang="cs" >}}
Adjust Column Width: true
Preserve Formatting: false
{{< /code >}}

## Retrieve query table result range 

Aspose.Cells provides the option to read the address i.e. result range of cells for a query table. Following code demonstrates this feature by reading the address of result range for a query table. The sample file can be downloaded [here](https://docs.aspose.com/download/attachments/5023523/Query%20TXT.xlsx?version=1&modificationDate=1537282315660&api=v2).

## Attachments:

![](https://docs2.aspose.com/cells/java/images/icons/bullet_blue.gif) [Sample.xlsx](https://docs2.aspose.com/cells/java/attachments/5275858/5472578.xlsx) (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)  
![](https://docs2.aspose.com/cells/java/images/icons/bullet_blue.gif) [after-setting-query-table.png](https://docs2.aspose.com/cells/java/attachments/5275858/5472576.png) (image/png)  
![](https://docs2.aspose.com/cells/java/images/icons/bullet_blue.gif) [before-setting-query-table.png](https://docs2.aspose.com/cells/java/attachments/5275858/5472575.png) (image/png)  
![](https://docs2.aspose.com/cells/java/images/icons/bullet_blue.gif) [Output.xlsx](https://docs2.aspose.com/cells/java/attachments/5275858/5472574.xlsx) (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)  

