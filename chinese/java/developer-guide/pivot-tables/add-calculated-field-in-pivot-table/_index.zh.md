---
title: 在数据透视表中添加计算字段
type: docs
weight: 130
url: /zh/java/add-calculated-field-in-pivot-table/
description: 如何在Aspose.Cells中的数据透视表中添加计算字段。
keywords: 在数据透视表中添加计算字段。
---

## **可能的使用场景**
当您基于已知数据创建数据透视表时，您会发现其中的数据不是您想要的。您想要的数据是这些原始数据的组合。例如，您需要在希望获取数据之前对原始数据进行加法、减法、乘法和除法。这时，您需要构建一个计算字段并设置相应的计算公式。然后对计算字段执行一些统计和其他操作。 

## **在Excel的数据透视表中添加计算字段**
在Excel中的数据透视表中插入计算字段，请按照以下步骤进行：

1. 选择要向其添加计算字段的数据透视表。 
2. 转到功能区中的数据透视表分析选项卡。
3. 单击“字段、项和集” ，然后从下拉菜单中选择“计算字段”。
4. 在“名称”字段中输入计算字段的名称。
5. 在“公式”字段中，输入要使用适当数据透视表字段名称和数学运算符执行的公式。 
<br>
<img src="1.png" width=80% />
6. 单击"确定"创建计算字段。
7. 新的计算字段将出现在数据透视表字段列表中的值部分。
8. 将计算字段拖动到数据透视表的值部分中，以显示计算值。
<br>
<img src="2.png" width=80% />

## **在数据透视表中添加计算字段**
请参阅以下示例代码。 代码首先设置原始数据并创建数据透视表。 然后根据数据透视表中的现有PivotField创建计算字段，并将计算字段添加到数据区域。 最后，以 [output XLSX](out.xlsx) 格式保存工作簿。 执行示例代码后，工作表上将添加带有计算字段的数据透视表。

## **示例代码**
{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "PivotTables-Add-calculated-field-in-PivotTable.java" >}}
{{< app/cells/assistant language="java" >}}
