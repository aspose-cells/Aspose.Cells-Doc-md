---
title: 智能标记功能
type: docs
weight: 30
url: /zh/net/smart-markers-feature/
---

**智能标记** 用于让 Aspose.Cells 知晓要放入微软 Excel 设计者电子表格中的信息。智能标记允许您创建仅包含特定信息和格式的模板。
## **设计器电子表格和智能标记**
设计者电子表格是包含可视格式、公式和智能标记的标准 Excel 文件。它们可以包含引用一个或多个数据源的智能标记，例如来自项目和相关联系人信息的信息。智能标记被写入您希望信息放入的单元格中。

所有智能标记均以 &= 开头。数据标记的示例是 &=Party.FullName。如果数据标记导致多个项目，例如完整行，则后续行会自动向下移动，以为所有新信息腾出空间。因此，可以在数据标记之后的行上放置小计和总计，以基于插入的数据进行计算。要对插入的行进行计算，请使用动态公式。

智能标记由**数据源**和**字段名称**部分组成。还可以使用变量和变量数组传递特殊信息。变量始终只填充一个单元格，而变量数组可以填充多个单元格。每个单元格只使用一个数据标记。未使用的智能标记将被移除。

智能标记还可以包含参数。参数允许您修改信息的排版方式。它们作为逗号分隔的列表附加在智能标记的末尾括号中。
### **智能标记选项**
- &=数据源.字段名
- &=数据源.字段名
- &=$VariableName
- &=$VariableArray
- &==DynamicFormula
- &=&=RepeatDynamicFormula
### **参数**
允许以下参数：

- noadd - 不要添加额外行以适应数据。
- skip:n - 对每一行数据跳过n行。
- ascending:n or descending:n - 在智能标记中对数据进行排序。如果n为1，则该列是排序器的第一个键。数据在处理数据源后进行排序。例如 &=Table1.Field3(ascending:1)。
- horizontal - 从左到右书写数据，而不是从上到下。
- numeric - 如有可能，将文本转换为数字。仅在.NET版本中支持。
- shift - 向下或向右移动，创建额外的行或列以适应数据。shift参数的工作方式与Microsoft Excel中相同。例如，在MS Excel中，当您选择一系列单元格，右键单击并选择“插入”，然后指定移动单元格向下、向右等选项。简而言之，shift参数对垂直/正常（从上到下）或水平（从左到右）智能标记填充相同的功能。
- copystyle - 将基本单元格的样式复制到该列中的所有单元格。

参数noadd和skip可以组合在一起，以在交替行插入数据。由于模板是从下往上处理的，因此应在第一行添加noadd以避免在交替行之前插入额外行。
