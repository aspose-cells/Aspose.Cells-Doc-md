---
title: 智能地通过Java导入和放置数据智能标记在Python中
linktitle: 智能标记
type: docs
weight: 190
url: /zh/python-java/using-smart-markers/
description: 智能地根据模板Excel文件在Python中通过Java库使用Aspose.Cells来导入和放置数据。
---

## **介绍**
**智能标记**用于让Aspose.Cells知道要将哪些信息放入Microsoft Excel设计器电子表格中。智能标记允许您创建仅包含特定信息和格式的模板。
## **设计器电子表格和智能标记**
设计器电子表格是包含视觉格式、公式和智能标记的标准Excel文件。它们可以包含引用一个或多个数据源的智能标记，例如来自项目的信息和相关联系人的信息。将智能标记编写到要放置信息的单元格中。

所有智能标记都以&=开头。数据标记的示例是&=Party.FullName。如果数据标记导致多个项目，例如完整行，则其后的行会自动向下移动以腾出空间来放置新信息。因此，可以在数据标记后紧接着的行上放置小计和总计，以便根据插入的数据进行计算。要在插入行上进行计算，请使用**动态公式**。

智能标记由**数据源**和**字段名称**部分组成以获取大多数信息。特殊信息也可以通过变量和变量数组传递。变量总是只填充一个单元格，而变量数组可能填充多个。每个单元格只能使用一个数据标记。未使用的智能标记将被移除。

智能标记还可以包含参数。参数允许修改信息的布局方式。它们附加在智能标记的末尾，以逗号分隔的列表形式。
### **智能标记选项**
&=数据源.字段名称 
&=［数据源］。字段名称 
&=$变量名称 
&=$变量数组 
&==动态公式 
&=&=重复动态公式
### **参数**
允许使用以下参数：

- **noadd** - 不添加额外行以适应数据。
- **skip:n** - 跳过每行数据的n行。
- **ascending:n** 或 **descending:n** - 对智能标记中的数据进行排序。若n为1，则该列是排序器的第一个键。数据将在处理数据源后排序。例如：&=Table1.Field3(ascending:1)。
- **horizontal** - 将数据从左到右写入，而不是从上到下。
- **numeric** - 如有可能，将文本转换为数字。
- **shift** - 向下或向右移动，创建额外的行或列以适应数据。shift参数的工作方式与Microsoft Excel相同。例如在Microsoft Excel中，当你选择一系列单元格，右键单击并选择**插入**，然后指定? **向下移动单元格**，**向右移动单元格**和其他选项。简而言之，shift参数用于垂直/正常（从上到下）或水平（从左到右）智能标记的相同功能。
- **copystyle** - 将基本单元格的样式复制到该列中的所有单元格。

noadd和skip参数可以组合使用以在交替行上插入数据。由于模板从底部到顶部处理，因此应在第一行上添加noadd以避免在交替行之前插入额外行。

如果有多个参数，请用逗号分隔它们，但不留空格：parameterA,parameterB,parameterC

以下屏幕截图展示如何在每隔一行插入数据。

|**模板文件**|**输出文件**|
| :- | :- |
|![todo:image_alt_text](using-smart-markers_1.jpg)|![todo:image_alt_text](using-smart-markers_2.jpg)|
### **动态公式**
动态公式允许您在单元格中插入Excel公式，即使公式引用将在导出过程中插入的行。

动态公式允许以下额外选项:

- r - 当前行号。
- 2, -1 - 对当前行号的偏移。

例如:

{{< highlight java >}}

 &=&=B{-1}/C{-1}~(skip:1)

{{< /highlight >}}

在动态公式标记中，“-1”分别表示在B列和C列中对当前行的偏移，用于除法运算，跳过参数为一行。此外，我们应指定以下字符:

{{< highlight java >}}

 "~"

{{< /highlight >}}

作为分隔字符，以应用动态公式中的进一步参数。

以下截图演示了重复的动态公式以及生成的Excel工作表。

|**模板文件**|**输出文件**|
| :- | :- |
|![todo:image_alt_text](using-smart-markers_3.jpg)|![todo:image_alt_text](using-smart-markers_4.jpg)|
单元格“C1”包含公式**= A1*B1**，单元格“C2”包含**= A2*B2**，单元格“C3”包含**= A3*B3**。

处理智能标记非常容易。以下是Python via Java中的代码片段，演示了如何执行。

{{< gist "aspose-cells-gists" "32e50c6aabc547111966569f3fd39694" "SmartMarker-SimpleProcess.py" >}}


