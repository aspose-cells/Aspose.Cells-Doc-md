---
title: 形状のロックまたはロック解除
linktitle: 形状のロックまたはロック解除
type: docs
weight: 200
url: /ja/net/lock-or-unlock-shapes/
description: この記事は、Aspose.Cellsライブラリを使用して図形のロックまたはアンロックを行い保護する方法についてのコード例を示しています。
keywords: C#で図形をロックして保護する方法、C#を使用して図形のロックやアンロックを行う方法を解説します。
---

## **可能な使用シナリオ**

場合によっては、特定のワークシート内のすべての形状を保護して、望ましくない状況によって破壊されるのを防ぐ必要があります。その場合は、指定されたワークシート内のすべての形状をロックする必要があります。 

スプレッドシートやドキュメント内の図形をロックすることは、いくつかの理由で有益です：
1. 偶発的な変更を防ぐ：図形をロックすることで、ユーザーによる誤った移動やサイズ変更、削除を防ぎます。特に複雑なドキュメントでは、図形が注釈やイラスト、またはドキュメントのデザインの一部として使われる場合に重要です。
1. レイアウトとデザインの維持：図形はドキュメントのレイアウトやビジュアルデザインにおいて重要な役割を果たします。それらをロックすることで、意図した外観を維持し、ドキュメントの専門性と視覚的魅力を保ちます。
1. データの整合性：スプレッドシートでは、図形を使って重要なデータポイントを強調したり、コメントを追加したり、ビジュアルな説明を提供したりします。これらの図形をロックすることで、提供される文脈情報の正確性と完全性を確保します。
1. 共有ドキュメントの一貫性：複数のユーザーがドキュメントで共同作業する際、それぞれの技術レベルは異なる場合があります。図形をロックすることで、予期しない変更を防ぎ、ドキュメントの一貫性を維持します。
1. セキュリティ：敏感なドキュメントでは、図形をロックすることは情報保護の一環となります。例えば、財務報告書や法的文書において、ロックされた図形は重要な注釈やハイライトを安全に保護するために使われます。

場合によっては、保護されたワークシート内の特定の図形のみを変更できるようにしたい場合があります。この場合、これらの図形のロックおよびアンロックについて詳しく説明します。

## **Excelで図形をロックする方法**

Microsoft Excelでセルをロックする方法は次のとおりです：

1. Excelファイルを開く：ロックしたい図形を含むExcelファイルを開きます。

1. 図形を選択：ロックしたい図形をクリックします。複数の図形を選択するには、Ctrlキーを押しながら各図形をクリックします。

1. 図形の書式設定パネルを開く：選択した図形上で右クリックし、「サイズとプロパティ」を選択します。あるいは、リボンの「書式」タブに移動し、「サイズ」グループのダイアログランチャー（小さな矢印）をクリックして「図形の書式設定」パネルを開きます。
1. 図形をロック： 「図形の書式設定」パネルの「サイズとプロパティ」タブ（四角形と矢印のアイコン）に移動します。「プロパティ」セクションで、「ロック」のチェックボックスをオンにします。
<br>
<img src="1.png" width=60% />
1. シートを保護：リボンの「校閲」タブに移動し、「シートの保護」をクリックします。パスワード（任意）を設定し、許可したい操作（ロックされたセルの選択、セルの書式設定など）を選び、「OK」をクリックします。
<br>
<img src="2.png" width=60% />

## **指定したワークシート内の全ての図形をロックする方法**

指定されたワークシート内のすべての形状を保護するには、[Worksheet.Protect( ProtectionType.Objects)](https://reference.aspose.com/cells/net/aspose.cells/worksheet/protect/#protect)メソッドを使用します。以下のサンプルコード例に示すように。

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Lock-Or-Unlock-Shapes-1.cs" >}}

## **保護されたワークシート内の指定した図形のアンロック方法**

保護されたワークシート内の指定された形状をアンロックするには、[shape.IsLocked](https://reference.aspose.com/cells/net/aspose.cells.drawing/shape/islocked/)を使用します。以下のサンプルコード例に示すように。

注: [shape.IsLocked](https://reference.aspose.com/cells/net/aspose.cells.drawing/shape/islocked/)は、ワークシートが保護されている場合にのみ意味があります。

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Lock-Or-Unlock-Shapes-2.cs" >}}

{{< app/cells/assistant language="csharp" >}}
