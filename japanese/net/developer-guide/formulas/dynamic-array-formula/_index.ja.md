---
title: 動的配列数式の設定
description: Aspose.Cells Excel で動的配列数式を計算するために Aspose.Cells ライブラリを使用する方法。既存の Excel ファイルをロードするか、新しい Excel ファイルを作成することにより、Aspose.Cells によって提供されるメソッドを使用して動的配列数式を計算し、結果を取得できます。最後に、変更した Excel ファイルをディスクに保存します。
keywords: Dynamic Array Formulas, Dynamic Array Formulas in Excel, Set dynamic array formulas, Calculation of dynamic array formulas, operate dynamic array formulas of Excel.
type: docs
weight: 70
url: /ja/net/calculation-of-dynamic-array-formulas/
---
##  **Excelの配列数式とは何ですか**
Excel では、配列数式は、個々のセルではなくデータの配列に対して計算を実行できる特別なタイプの数式です。配列数式を使用すると、複雑な計算を実行し、データを操作し、特定の問題を効率的に解決できます。これらは通常の数式とは異なる方法で入力され、多くの場合、Ctrl + Shift + Enter の使用が必要になります。

Excel の配列数式に関する重要なポイントをいくつか紹介します。
1. 構文：
<br>
配列数式は通常の数式と同じように記述できますが、値の配列に対する演算が含まれます。これらは、配列数式であることを示すために中括弧 { } で囲まれています。ただし、これらの中括弧は自分で入力しません。数式を正しく入力すると、Excel はそれらを自動的に追加します。
1. 配列数式の入力:
<br>
配列数式を入力するには、数式バーに数式を入力します。Enter キーを押して終了する代わりに、Ctrl + Shift + Enter キーを押します。これにより、Excel にそれが配列数式であることがわかります。正しく入力すると、Excel では数式バーの中括弧内に数式が表示され、それが配列数式であることが示されます。
1. 使用例:
<br>
配列数式は、複数のセルまたは範囲にわたって同時に計算を実行する場合に便利です。これらは、高度な数学的計算、条件付き演算、データのフィルタリングなどに使用できます。
1. 利点：
<br>
配列数式を使用すると、複雑な計算を 1 つの数式で実行できるため、効率が向上し、ワークシートが簡素化されます。これらは大規模なデータセットを処理し、複数の中間ステップが必要となる計算を実行できます。
1. 制限事項:
<br>
配列数式は、通常の数式よりも理解やトラブルシューティングが難しい場合があります。特に広範囲に使用する場合、または大規模なデータセットで使用する場合、ワークシートのパフォーマンスが低下する可能性があります。
1. 例:
<br>
範囲内の値を合計する:**{=SUM(A1:A5*B1:B5)}**
<br>
範囲内の最大値を見つける:**{=MAX(A1:A5+B1:B5)}**
<br>
<image src="1.png" width="70%" />
<br>

配列数式は慎重に使用する必要があり、ワークシートに実装する前にその仕組みを理解することが重要であることに注意してください。これらは、Excel でのデータ分析と操作のための強力なツールとなります。

##  **Excelの動的配列数式とは何ですか**
動的配列数式は、Excel 365 および Excel 2021 で導入された新機能です。動的配列数式を使用すると、従来の配列数式と比較して、よりシームレスかつ効率的にデータの配列を操作できるようになります。動的配列数式は結果を隣接するセルに自動的に流し込むため、Ctrl + Shift + Enter の必要性がなくなり、データの操作が容易になります。

Excel の動的配列数式に関する重要なポイント:
1. 自動流出:
<br>
動的配列数式は、出力データのサイズに基づいて、結果を隣接するセルに自動的に流し込みます。つまり、数式を入力する前にセル範囲を選択したり、Ctrl + Shift + Enter を使用して数式を確認したりする必要はありません。
1. 単一-Cell エントリ:
<br>
動的配列数式は 1 つのセルに入力され、Excel によって隣接するセルに結果が自動的に入力されます。これにより、数式を一度入力するだけで済むため、数式の管理と理解が容易になります。
1. 新しい機能:
<br>
動的配列数式には、*FILTER**、*SORT**、*UNIQUE**、*SEQUENCE**、*SORTBY**、*RANDARRAY** など、配列をネイティブに処理できる新しい関数が導入されています。これらの関数は複数の値を返したり、配列を直接操作したりできるため、複雑な計算が簡素化されます。
1. 柔軟な範囲の処理:
<br>
動的配列数式は、入力データのサイズまたは実行される計算に基づいて、スピル範囲のサイズを動的に調整します。この柔軟性により、ワークシートのスペースをより効率的に使用でき、数式の作成が簡素化されます。
1. パフォーマンスを向上させた：
<br>
動的配列数式は、特に大規模なデータセットや複雑な計算を扱う場合に、従来の配列数式と比較してパフォーマンスを向上させることができます。
1. 互換性:
<br>
動的配列数式は Excel 365 および Excel 2021 で使用できます。古いバージョンの Excel ではサポートされていない可能性があります。
1. 動的配列数式の例:
<br>
*FILTER**: 指定された基準を満たす値の配列を返します。
<br>
*SORT**: 範囲または配列内の値を並べ替えます。
<br>
*UNIQUE**: リストまたは範囲から一意の値を返します。
<br>
*SEQUENCE**: 一連の数値または日付を生成します。
<br>
*RANDARRAY**: 乱数の配列を生成します。
<br>
<image src="2.png" width="70%" />
<br>

動的配列数式は、Excel でのデータ操作と分析のための強力な機能を提供し、データ配列の操作と複雑な計算の効率的な実行を容易にします。

##  **Excelの配列数式と動的配列数式の違いは何ですか**
Excel では、配列数式と動的配列数式の両方を使用して複数の値の計算を同時に実行しますが、機能と実装方法の点でいくつかの違いがあります。

###  **配列数式の機能**
1. 配列数式は、データの配列に対して計算を実行できる Excel の従来の数式です。
1. 数式を入力した後に Ctrl + Shift + Enter を押すと入力され、Excel にそれが配列数式であることが通知されます。
1. 配列数式には、結果を隣接するセルに書き込む能力の点で制限があります。通常は 1. 単一の結果を返しますが、その結果はセル配列である場合もあります。
1. これらは長い間存在しており、Excel のすべてのバージョンでサポートされています。

###  **動的配列数式の機能**
1. 動的配列数式は、Excel 365 (Office 365 サブスクリプション) および Excel 2021 に導入された新機能です。
1. 入力データのサイズまたは数式の計算に基づいて、結果を隣接するセルに自動的に流し込みます。
1. 動的配列数式では、Ctrl + Shift + Enter を押す必要はありません。 1 つのセルに数式を入力するだけで、Excel によって隣接するセルに結果が自動的に入力されます。
1. これらの数式には、配列数式や Ctrl + Shift + Enter を必要とせずに、複数の結果 (セル範囲) を直接返す機能があります。
1. *FILTER**、*SORT**、*UNIQUE** などの新しい関数があり、配列をネイティブに処理し、結果を動的配列形式で返すことができます。
要約すると、動的配列数式は Excel で配列を操作するためのより現代的で便利な方法であり、従来の配列数式と比較して結果の自動スピルを提供し、配列の操作プロセスを簡素化します。ただし、これらは動的配列をサポートする新しいバージョンの Excel でのみ使用できます。

##  **Excel で動的配列数式を設定および計算する方法**
Excel で動的配列数式を設定するには、データの配列を操作し、結果を隣接するセルに自動的に反映できるように設計された特定の関数を使用する必要があります。

ここでは、動的配列数式を設定するためのステップバイステップのガイドを示します。
1. Cell を選択します。
<br>
動的配列数式の結果を表示するセルを選択します。動的配列数式は結果を隣接するセルに書き出すため、書き出された出力用に十分なスペースがあることを確認してください。
1. 式を入力します。
<br>
選択したセルの数式バーに動的配列数式を入力します。 Excel 365 および Excel 2021 で使用できる動的配列関数 (*FILTER**、*SORT**、*UNIQUE**、*SEQUENCE**、*SORTBY**、*RANDARRAY** など) のいずれかを使用します。
<br>
たとえば、FILTER 関数を使用して、*=FILTER(A2:C15,(A2:A15=F4)*(C2:C15=G4),"")** という特定の基準に基づいてデータのリストをフィルター処理できます。
<br>
<image src="3.png" width="70%" />
<br>
1. Enter キーを押します:
<br>
数式を入力したら、キーボードの Enter キーを押すだけです。従来の配列数式とは異なり、Ctrl + Shift + Enter キーを押す必要はありません。
1. こぼれた範囲を観察します。
<br>
Excel では、数式の結果が自動的に隣接するセルに反映されます。こぼれた範囲は、出力データのサイズまたは式によって実行される計算に基づいて動的に調整されます。 Excel では、こぼれた範囲が枠線と斜めの矢印アイコンで強調表示され、こぼれたデータが含まれていることを示します。
1. こぼれた範囲と対話する:
<br>
Excel の他のセル範囲と同じように、こぼれた範囲を操作できます。こぼれた範囲を他の数式で使用したり、計算を実行したり、書式設定したり、グラフや表で参照したりできます。
1. 式を更新します。
<br>
動的配列数式を変更する必要がある場合は、数式が入力された元のセルで数式を編集するだけです。
編集後、もう一度 Enter キーを押して変更を確認します。 Excel は、必要に応じて、こぼれた範囲を自動的に更新します。
1. こぼれた範囲をクリアする:
<br>
流出したデータをクリアしたい場合は、元のセルから数式を削除できます。 Excel では、こぼれた範囲もクリアされます。あるいは、こぼれた範囲を選択して Delete キーを押すことによって、その範囲を直接削除することもできます。
<br>

これらの手順に従うと、Excel で動的配列数式を設定してデータの配列を効率的に分析および操作できるため、データ分析とレポート作成タスクが容易になります。

##  **Aspose.Cells を使用して動的配列数式を設定および更新する方法**
をロードする次のサンプルコードを参照してください。[サンプル Excel ファイル](dynamicArrayFormula.xlsx)いくつかのダミーデータが含まれています。ファイルをロードした後、[Cell.SetDynamicArrayFormula](https://reference.aspose.com/cells/net/aspose.cells/cell/setdynamicarrayformula/#setdynamicarrayformula)動的配列数式を設定する関数と[Workbook.RefreshDynamicArrayFormulas](https://reference.aspose.com/cells/net/aspose.cells/workbook/refreshdynamicarrayformulas/#refreshdynamicarrayformulas)数式計算を呼び出す前に動的配列数式を更新し、最後にワークブックを次の形式で保存する関数[Excelファイルを出力](out.xlsx). 

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Formulas-dynamic-array-formulas.cs" >}}

出力スナップショット:
<br>
<image src="4.png" width="70%" />