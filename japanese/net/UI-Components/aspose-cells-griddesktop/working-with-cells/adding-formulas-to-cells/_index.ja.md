---
title: 数式を Cells に追加する
type: docs
weight: 30
url: /ja/net/adding-formulas-to-cells/
---
{{% alert color="primary" %}} 

セルには、数値やテキストなどの単純な値だけを含めることはできませんが、セルに数式を値として挿入することもできます。いくつかの計算の後にセルの値を決定する必要がある場合、数式がセルで使用されます。このトピックでは、セルに適用された数式にアクセスして変更する方法について説明します。

{{% /alert %}} 
## **Cell に数式を追加する**
数式をセルに追加することは、前のトピックで説明したセルの値を設定するのと同じです。[Cell の値へのアクセスと変更](/cells/ja/net/accessing-and-modifying-the-value-of-a-cell/)ただし、その場合は単純な値をセルに追加しただけです。次に、数式を追加します。開発者は、セルの Value プロパティを使用して、数式にアクセスして変更することができます。**SetCellValue**セルのメソッドを使用して、セル内の数式を追加または変更することもできます。

**重要：** Value プロパティを使用する場合と使用する場合の基本的な違い**SetCellValue**セルのメソッドは、Value プロパティが呼び出すことです**RunAll式**Grid のメソッドを使用して、すべての数式の値を自動的に再計算します。**SetCellValue**メソッド開発者が呼び出す必要がある**RunAll式**数式がセルに追加された後、メソッドを明示的に呼び出します。実際、私たちが使用するとき**SetCellValue**セルのメソッドの場合、このメソッドはセルの値を**フォーミュラタイプ**式を計算しないでください。さらに、呼び出し**RunAll式**毎回の方法は必要ありません。ワークシートのセルに多くの数式を追加する場合は、呼び出すことができます**RunAll式**メソッドは最後に一度だけ。

数式は、文字列値としてセルに追加されます。さらに、数式構造は、MS Excel の数式構造と互換性がある必要があります。すべての数式は、**等号 (=)**.

以下の例では、ワークシートの 2 つのセルの値を乗算し、結果を別のセルに格納する数式を追加しています。**RunAll式**メソッドも最後に呼び出されます。



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithCells-AddingCellFormulas-1.cs" >}}



次に、アプリケーションを実行します。数式が追加されたセルをダブルクリックすると、バックエンドで実際に値を計算している数式に値が置き換えられることに気付くでしょう。

{{% alert color="primary" %}} 

 Aspose.Cells.GridDesktop は、MS Excel の一般的に使用される機能のほとんどをサポートしています。サポートされている機能のリストの詳細については、[ここをクリック。](/cells/ja/net/list-of-supported-functions/)

{{% /alert %}}
