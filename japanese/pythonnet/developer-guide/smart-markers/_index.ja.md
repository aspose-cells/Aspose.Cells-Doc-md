---
title: .Net経由でPythonのスマートマーカーを使用してデータをスマートにインポートおよび配置する
linktitle: スマートマーカー
type: docs
weight: 190
url: /ja/python-net/using-smart-markers/
description: .Net ライブラリ経由で Aspose.Cells for Python のテンプレート Excel ファイルにデータをスマートにインポートして配置します。
---
## **序章**
**スマートマーカー**Aspose.Cells Excel デザイナー スプレッドシートに配置する情報を Aspose.Cells に知らせるために使用されます。スマート マーカーを使用すると、特定の情報と書式のみを含むテンプレートを作成できます。
## **デザイナー スプレッドシートとスマート マーカー**
Designer スプレッドシートは、視覚的な書式設定、数式、およびスマート マーカーを含む標準の Excel ファイルです。プロジェクトからの情報や関連する連絡先の情報など、1 つ以上のデータ ソースを参照するスマート マーカーを含めることができます。スマート マーカーは、情報が必要なセルに書き込まれます。

すべてのスマート マーカーは &= で始まります。データ マーカーの例は &=Party.FullName です。データ マーカーの結果が複数の項目 (たとえば、完全な行) になる場合、次の行は自動的に下に移動され、新しい情報のためのスペースが確保されます。したがって、小計と合計をデータ マーカーの直後の行に配置して、挿入されたデータに基づいて計算を行うことができます。挿入された行を計算するには、次を使用します。**動的数式**.

スマート マーカーは、**情報元**と**フィールド名**ほとんどの情報の部品。特別な情報は、変数と変数配列で渡すこともできます。変数は常に 1 つのセルのみを埋めますが、変数配列は複数のセルを埋めます。セルごとに 1 つのデータ マーカーのみを使用します。未使用のスマート マーカーは削除されます。

スマート マーカーには、パラメーターを含めることもできます。パラメータを使用すると、情報のレイアウト方法を変更できます。これらは、カンマ区切りのリストとして括弧内のスマート マーカーの末尾に追加されます。
### **スマート マーカーのオプション**
 &=データソース.フィールド名
&=[データソース].[フィールド名]&=$変数名
&=$変数配列
&==動的式
&=&=RepeatDynamicFormula
### **パラメーター**
次のパラメータが許可されています。

- **noadd** - データに合わせて余分な行を追加しないでください。
- **スキップ:n** - データの各行に対して n 行をスキップします。
- **昇順:n**また**降順:n** - スマート マーカーでデータを並べ替えます。 n が 1 の場合、列はソーターの最初のキーです。データ ソースの処理後に、データが並べ替えられます。例: &=Table1.Field3(昇順:1)。
- **水平** 上から下ではなく、左から右にデータを書き込みます。
- **数値** 可能であれば、テキストを数値に変換します。
- **シフト** 下または右にシフトし、データに合わせて余分な行または列を作成します。 shift パラメータは、Microsoft Excel と同じように機能します。たとえば、Microsoft Excel では、セルの範囲を選択するときに、右クリックして選択します。**入れる**と指定しますか？**セルを下にシフト**, **セルを右にシフト**およびその他のオプション。要するに、**シフト**パラメータは、垂直/通常 (上から下) または水平 (左から右) のスマート マーカーに対して同じ機能を果たします。
- **コピースタイル** 基本セルのスタイルをその列のすべてのセルにコピーします。

パラメータ noadd と skip を組み合わせて、交互の行にデータを挿入できます。テンプレートは下から上に処理されるため、最初の行に noadd を追加して、別の行の前に余分な行が挿入されないようにする必要があります。

複数のパラメーターがある場合は、スペースを入れずにコンマで区切ります: parameterA、parameterB、parameterC

次のスクリーンショットは、1 行おきにデータを挿入する方法を示しています。

|**テンプレートファイル**|**出力ファイル**|
|:- |:- |
|![todo:画像_代替_文章](using-smart-markers_1.jpg)|![todo:画像_代替_文章](using-smart-markers_2.jpg)|
### **動的数式**
動的数式を使用すると、数式がエクスポート プロセス中に挿入される行を参照している場合でも、Excel 数式をセルに挿入できます。動的数式は、挿入された行ごとに繰り返すことも、データ マーカーが配置されているセルのみを使用することもできます。

動的数式では、次の追加オプションを使用できます。

- r - 現在の行番号。
- 2、-1 - 現在の行番号へのオフセット。

例えば：

{{< highlight "java" >}}

 &=&=B{-1}/C{-1}~(skip:1)

{{< /highlight >}}

動的数式マーカーでは、「-1」は除算演算用に設定される B 列と C 列のそれぞれの現在の行へのオフセットを示し、スキップ パラメーターは 1 行です。さらに、次の文字を指定する必要があります。

{{< highlight "java" >}}

 "~"

{{< /highlight >}}

動的数式でさらにパラメータを適用するための区切り文字として。

次のスクリーンショットは、動的数式の繰り返しと結果の Excel ワークシートを示しています。

|**テンプレートファイル**|**出力ファイル**|
|:- |:- |
|![todo:画像_代替_文章](using-smart-markers_3.jpg)|![todo:画像_代替_文章](using-smart-markers_4.jpg)|
Cell "C1" には数式が含まれています**A1*B1** 、セル「C2」が含まれています**A2*B2**セル「C3」には**A3*B3**.

スマートマーカーの処理は非常に簡単です。以下は、.Net 経由の Python のコード スニペットで、その方法を示しています。

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "SmartMarker-SimpleProcess.py" >}}


