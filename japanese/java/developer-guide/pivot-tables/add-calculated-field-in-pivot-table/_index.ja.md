---
title: ピボットテーブルに計算フィールドを追加する
type: docs
weight: 130
url: /ja/java/add-calculated-field-in-pivot-table/
description: Aspose.Cells を使用してピボット テーブルに計算フィールドを追加する方法。
keywords: Adding a calculated field in pivot table.
---
##  **考えられる使用シナリオ**
既知のデータに基づいてピボット テーブルを作成すると、そのデータが目的のものではないことがわかります。欲しいデータはこれらのオリジナルデータを組み合わせたものです。たとえば、データが必要になる前に、元のデータを加算、減算、乗算、除算する必要があります。現時点では、計算フィールドを構築し、対応する計算式を設定する必要があります。次に、計算フィールドに対して統計やその他の操作を実行します。

##  **Excelのピボットテーブルに計算フィールドを追加する**
Excel のピボットテーブルに計算フィールドを挿入するには、次の手順を実行します。

1. 計算フィールドを追加するピボットテーブルを選択します。
2. リボンの [ピボットテーブル分析] タブに移動します。
3. [フィールド、項目、セット] をクリックし、ドロップダウン メニューから [計算フィールド] を選択します。
4. [名前] フィールドに、計算フィールドの名前を入力します。
 5. [数式] フィールドに、適切なピボットテーブル フィールド名と算術演算子を使用して実行する数式を入力します。
<br>
<img src="1.png" width=80% />
6. [OK] をクリックして計算フィールドを作成します。
7. 新しい計算フィールドが、ピボットテーブル フィールド リストの [値] セクションに表示されます。
8. 計算フィールドをピボットテーブルの [値] セクションにドラッグして、計算値を表示します。
<br>
<img src="2.png" width=80% />

##  **ピボットテーブルに計算フィールドを追加する**
次のサンプルコードを参照してください。コードはまず元のデータを設定し、ピボット テーブルを作成します。次に、ピボット テーブル内の既存のピボットフィールドに従って計算フィールドを作成し、その計算フィールドをデータ領域に追加します。最後に、ワークブックを次の場所に保存します。[出力XLSX](out.xlsx)フォーマット。サンプル コードを実行すると、計算フィールドを含むピボット テーブルがワークシートに追加されます。

##  **サンプルコード**
{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "PivotTables-Add-calculated-field-in-PivotTable.java" >}}
