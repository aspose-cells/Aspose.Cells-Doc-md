---
title: ピボットテーブルに計算フィールドを追加する
type: docs
weight: 130
url: /ja/java/add-calculated-field-in-pivot-table/
description: Aspose.Cellsを使用してピボットテーブルに計算フィールドを追加する方法。
keywords: ピボットテーブルで既知のデータに基づいてピボットテーブルを作成すると、そのデータが望むものではないことがあります。望むデータは、これらの元のデータの組み合わせです。たとえば、データを望む前に元のデータを追加、減算、乗算、除算する必要があります。その場合、計算フィールドを構築し、計算のための対応する式を設定する必要があります。その後、計算フィールドにいくつかの統計およびその他の操作を行います。
---

## **可能な使用シナリオ**
既知のデータに基づいてピボットテーブルを作成すると、それに含まれるデータが望んでいるものではないことがあります。望んでいるデータは、これらの元のデータの組み合わせです。たとえば、データを望んだ形式にするために、元のデータを加算、減算、乗算、除算する必要があります。その場合、計算フィールドを構築し、計算用の対応する式を設定する必要があります。その後、計算フィールドで統計などの操作を行います。 

## **Excelのピボットテーブルに計算フィールドを追加**
Excelのピボットテーブルに計算フィールドを挿入するには、以下の手順に従います:

1. 追加したいピボットテーブルを選択します。 
2. リボットテーブルツールの「分析」タブに移動します。
3. 「フィールド、アイテム、およびセット」をクリックし、その後、ドロップダウンメニューから「計算フィールド」を選択します。
4. 「名前」フィールドに、計算フィールドの名前を入力します。
5. "式"フィールドに、適切なピボットテーブルのフィールド名と数学演算子を使用した使用法を入力します。 
<br>
<img src="1.png" width=80% />
6. 「OK」をクリックして計算フィールドを作成します。
7. 新しい計算フィールドは、値のセクションの下にあるピボットテーブルフィールドリストに表示されます。
8. 計算フィールドをピボットテーブルの値セクションにドラッグして、計算された値を表示します。
<br>
<img src="2.png" width=80% />

## **ピボットテーブルに計算フィールドを追加する**
以下のサンプルコードを参照してください。コードはまず元のデータを設定し、ピボットテーブルを作成します。次に、既存のピボットテーブル内のPivotFieldに基づいて計算フィールドを作成し、データ領域に計算フィールドを追加します。最後に、[output XLSX](out.xlsx)形式でブックを保存します。例のコードを実行すると、計算フィールドが追加されたピボットテーブルがワークシートに追加されます。

## **サンプルコード**
{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "PivotTables-Add-calculated-field-in-PivotTable.java" >}}
