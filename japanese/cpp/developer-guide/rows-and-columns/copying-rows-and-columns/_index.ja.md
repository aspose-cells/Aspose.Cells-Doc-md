---
title: 行と列のコピー
type: docs
weight: 20
url: /ja/cpp/copying-rows-and-columns/
---

## **紹介**
ワークシート内でワークシート全体をコピーせずに行や列をコピーする必要がある場合があります。Aspose.Cellsを使用すれば、行や列をワークブック内またはワークブック間でコピーすることが可能です。
行（または列）をコピーすると、その中に含まれるデータ、更新された参照を持つ数式、値、コメント、書式設定、非表示セル、画像、および他の図形オブジェクトもコピーされます。
## **Microsoft Excelで行と列をコピーする**
1. コピーしたい行または列を選択します。
1. 行または列をコピーする場合は、**標準**ツールバーの**コピー**をクリックするか、**CTRL**+**C**を押します。
1. コピーする選択範囲の下または右側に行または列を選択します。
1. 行または列をコピーする際に、**挿入**メニューで**コピーしたセル**をクリックします。

{{% alert color="primary" %}} 

必要なコンテンツを別のセルに貼り付けるには、**標準**ツールバーの**貼り付け**をクリックするか、**CTRL**+**V**を押します。**挿入**メニューでコマンドをクリックする代わりに、**標準**ツールバーの**貼り付け**をクリックすると、宛先セルの内容が置換されます。

{{% /alert %}} 
## **Aspose.Cellsの使用**
### **行のコピー**
Aspose.Cellsでは、Aspose::Cells::ICellsクラスのCopyRowメソッドを提供しています。このメソッドは、数式、値、コメント、セルの書式設定、非表示セル、画像、および他の図形オブジェクトを含むすべての種類のデータをソース行から宛先行にコピーします。

CopyRowメソッドは次のパラメータを取ります:

- ソースのCellsオブジェクト、
- ソースの行インデックス、および
- 宛先の行インデックス。

このメソッドを使用してシート内の行をコピーしたり、他のシートにコピーしたりできます。CopyRowメソッドはMicrosoft Excelと同様に機能します。そのため、宛先行の高さを明示的に設定する必要はなく、その値もコピーされます。

次の例は、ワークシート内の行をコピーする方法を示しています。テンプレートのMicrosoft Excelファイルを使用し、2番目の行（データ、書式設定、コメント、画像などを含む）を12番目の行に貼り付けます。

宛先の行の高さを設定するために**GetRowHeigh**メソッドを使用し、その後**SetRowHeight**メソッドを使用するステップをスキップすることも可能です。**CopyRow**メソッドは自動的に行の高さに対応しています。



{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-RowsAndColumns-CopyingRowsAndColumns-CopyingRows-new.cpp" >}}

{{% alert color="primary" %}} 

行をコピーする際には、関連する画像、グラフなどの図形オブジェクトに注意することが重要です（これはMicrosoft Excelと同じです）:

1. ソース行インデックスが5の場合、画像、グラフなどが3行に含まれているためコピーされます（開始行インデックスが4で終了行インデックスが6）。
1. 宛先の行に既存の画像、グラフなどは削除されません。

{{% /alert %}} 
### **列のコピー**
Aspose.Cellsでは、Aspose::Cells::ICellsクラスのCopyColumnメソッドを提供しています。このメソッドは、数式（更新された参照を持つ）、値、コメント、セルの書式設定、非表示セル、画像、および他の図形オブジェクトを含むすべての種類のデータをソース列から宛先列にコピーします。

CopyColumnメソッドは次のパラメータを取ります:

- ソースのCellsオブジェクト、
- ソースの列インデックス、および
- 宛先の列インデックス。

CopyColumnメソッドを使用して、シート内または別のシートに列をコピーします。

この例では、ワークシートから列をコピーして別のブック内のワークシートに貼り付けます。



{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-RowsAndColumns-CopyingRowsAndColumns-CopyingColumns-new.cpp" >}}
