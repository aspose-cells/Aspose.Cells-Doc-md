---
title: C++で日付として数値を書式設定する方法
linktitle: 数字を日付としてフォーマットする方法
type: docs
weight: 10
url: /ja/cpp/format-number-to-date/
description: この記事では、Aspose.Cells for C++ APIを使用して数値を日付に書式設定する方法を紹介します。
keywords: 日付としてフォーマットする、セルの設定、数字を日付にフォーマット、日付設定、日付フォーマット。
---

## **可能な使用シナリオ**
Excel（または任意のスプレッドシートソフト）で数字を日付としてフォーマットすることは、多くの理由で重要です。特に、時間やスケジュール情報を含むデータを扱う場合に役立ちます。以下は、数字を日付にフォーマットすることの利点です：

1. **日付値の正しい解釈**: エクセルでは、日付はシリアル番号として保存されています（例：1は1900年1月1日、44210は2021年9月6日）。これらの数字が日付として書式設定されていない場合、ユーザーは意味のない数字を見ることになり、見やすい日付として表示されません。適切に書式設定することで、実際の日付（例：09/06/2021）として表示されます。
2. **時間に関連する計算を簡素化**: エクセルは、日付を用いた多くの計算を行えます。たとえば、2つの日付の間の日数を計算したり、日数の加算・減算を行ったり、曜日を求めたりすることです。数値が日付として書式設定されていないと、エクセルはこれらの操作を効果的に行えません。例えば、2023/09/01と2023/10/01の間の日数を知りたい場合は、日付書式にしていると簡単に計算できます。
3. **一貫性を保証**: すべての関連値が正しく書式設定されていれば、すべての日時が統一された見やすいスタイルで表示されます。この一貫性は、ビジネスレポート、プロジェクトスケジュール、データベースで重要です。異なる地域では異なる日付フォーマット（例：米国のMM/DD/YYYYと他国のDD/MM/YYYY）を使うため、書式設定はこれらを正しく解釈させるのに役立ちます。
4. **可読性の向上**: 標準的なフォーマット（例：01/01/2024）で表示された日付は、シリアル番号（例：45000）よりも読むのが容易です。適切な日付の書式設定により、スプレッドシートの使いやすさが向上し、混乱を防ぎます。これは、スケジューリング、タイムライン、イベント計画、履歴データなどのシナリオで特に重要です。
5. **並べ替えやフィルタリングに役立つ**: 日付が正しく書式設定されている場合、エクセルはそれらを実際の日付として認識し、時系列に並べ替えたり、フィルタリングしたりすることが容易になります。例えば、イベントのリストを日付順に並べ替えたり、特定の2つの日付の間のレコードだけを表示したりできます。適切な日付書式がない場合、並べ替えは生の数値に基づいて行われる可能性があります。
6. **日付関数の利用を可能にする**: エクセルは、TODAY()、DATEDIF()、WORKDAY()、YEAR()、MONTH()、DAY()など、多彩な強力な日付関数を提供します。これらの関数は、正しく書式設定された日付に対して正確な計算を行う必要があります。
7. **視覚化（チャート/タイムライン）をサポート**: 正しくフォーマットされた日付は、時間を重要な軸とするチャートやグラフの作成に使用できます。たとえば、タイムラインチャートでは、Excelは認識されたフォーマットの日付を必要とし、イベントを正確に時間に沿ってプロットします。誤った形式や未フォーマットの数字は、意味不明なチャートや誤った情報を反映する結果になる可能性があります。
8. **誤解を防ぐ**: 生の数字は簡単に誤解されることがあります。例えば、44210は一般的な数値として解釈されるかもしれませんが、日付としてフォーマットされると、2021年9月6日を表していることが明確になります。適切にフォーマットされた日付は、データの誤解を避けるのに役立ちます。
9. **データ入力を容易に**: セルが日付としてフォーマットされていると、ユーザーは有効な日付フォーマットでデータを入力するよう促され、データ入力エラーを防止し、日付値を正しく取得できます。
10. **スケジューリングと追跡に不可欠**: スケジューリング、追跡、締め切りを伴う状況（プロジェクト管理、財務予測、時間制限のあるレポートなど）では、数字を日付としてフォーマットすることは正確さと理解を深めるために重要です。より良い計画と実行を可能にします。

## **Excelで数値を日付にフォーマットする方法**
Excelで数値を日付としてフォーマットするには、次の手順に従います：

### **リボン（ホームタブ）を使用して**
1. 日付としてフォーマットしたい数字が含まれるセルを選択します。
2. リボンのホームタブに移動します。
3. 数値グループ内の、[番号]フォーマットボックスのドロップダウン矢印をクリックします（通常は「標準」または「数字」と表示されていることがあります）。
4. ドロップダウンから「短い日付」または「長い日付」を選択します。短い日付：MM/DD/YYYY（米国形式）やDD/MM/YYYY（国際形式）のように簡潔な形式で日付を表示します。長い日付：曜日や月日を含めた詳しい形式で表示します（例：2024年1月1日（月曜日））。
<br>
<img src="1.png" width=60% />

### **セルの書式設定ダイアログボックスの使用**
1. 書式設定したいセルを選択します。
2. 選択したセルを右クリックし、「セルの書式設定」を選択するか、Ctrl + 1（Windows）または Cmd + 1（Mac）を押します。
3. セルの書式設定ダイアログボックスで、「数値」タブに移動します。
4. 左側のリストから「日付」を選択します。
5. 右側のリストから希望する日付フォーマットを選びます（例：MM/DD/YYYY、DD/MM/YYYY、またはカスタム形式）。
<br>
<img src="2.png" width=60% />
6. OKをクリックして日時のフォーマットを適用します。

## **Aspose.Cellsで数値を日付にフォーマットする方法**

Aspose.Cells Aspose.Cells for C++ライブラリを使用してExcelファイルを操作する際に、数字を日付としてフォーマットするには、セルに対してプログラム的に日付フォーマットを適用できます。C++でのやり方は次の通りです：

```cpp
#include <iostream>
#include "Aspose.Cells.h"
using namespace Aspose::Cells;

int main()
{
    Aspose::Cells::Startup();

    // Create a new workbook
    Workbook workbook;

    // Access the first worksheet
    Worksheet worksheet = workbook.GetWorksheets().Get(0);

    // Access the cell where you want to apply the date format
    Cell a1 = worksheet.GetCells().Get(u"A1");

    // Set a numeric value that represents a date (e.g., 44210 represents 09/06/2021 in Excel)
    a1.PutValue(44210);

    // Create a style object to apply the date format
    Style a1Style = a1.GetStyle();

    // "14" represents a standard date format in Excel (MM/DD/YYYY)
    a1Style.SetNumber(14);

    // Apply the style to the cell
    a1.SetStyle(a1Style);

    // Access the cell where you want to apply the currency format
    Cell a2 = worksheet.GetCells().Get(u"A2");

    // Set a numeric value to the cell
    a2.PutValue(44210);

    // Create a style object to apply the date format
    Style a2Style = a2.GetStyle();

    // Custom format for YYYY-MM-DD
    a2Style.SetCustom(u"YYYY-MM-DD");

    // Apply the style to the cell
    a2.SetStyle(a2Style);

    // Save the workbook
    workbook.Save(u"DateFormatted.xlsx");

    Aspose::Cells::Cleanup();
}
```
