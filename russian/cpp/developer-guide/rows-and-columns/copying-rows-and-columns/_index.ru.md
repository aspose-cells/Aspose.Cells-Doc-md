---
title: Копирование строк и колонок
type: docs
weight: 20
url: /ru/cpp/copying-rows-and-columns/
---

## **Введение**
Иногда необходимо скопировать строки и колонки на листе без копирования всего листа. С помощью Aspose.Cells можно копировать строки и колонки внутри либо между книгами.
При копировании строки (или колонки) копируются данные, включая формулы, обновленные ссылки, значения, комментарии, форматирование, скрытые ячейки, изображения и другие объекты рисования.
## **Копирование строк и колонок в Microsoft Excel**
1. Выберите строку или колонку, которую вы хотите скопировать.
1. Чтобы скопировать строки или колонки, нажмите **Копировать** на панели **Стандартные функции** или нажмите **CTRL**+**C**.
1. Выберите строку или колонку ниже или справа от места, куда вы хотите скопировать ваш выбор.
1. При копировании строк или колонок нажмите **Скопированные ячейки** на меню **Вставка**.

{{% alert color="primary" %}} 

Если вы нажмете **Вставить** на панели **Стандартные функции** или нажмете **CTRL**+**V**, вместо нажатия команды в меню **Вставка**, содержимое ячеек назначения будет заменено.

{{% /alert %}} 
## **Использование Aspose.Cells**
### **Копирование строк**
Aspose.Cells предоставляет метод CopyRow из класса Aspose::Cells::ICells. Этот метод копирует все типы данных, включая формулы, значения, комментарии, форматы ячеек, скрытые ячейки, изображения и другие объекты рисования с исходной строки в конечную строку.

Метод CopyRow принимает следующие параметры:

- объект исходных ячеек,
- индекс исходной строки, и
- индекс строки назначения.

Используйте этот метод для копирования строки внутри листа или на другой лист. Метод CopyRow работает аналогично Microsoft Excel. Например, вам не нужно устанавливать высоту строки назначения явно, это значение также копируется.

В следующем примере показано, как скопировать строку в листе. Используется шаблонный файл Microsoft Excel и копируется вторая строка (с данными, форматированием, комментариями, изображениями и т. д.) и вставляется в 12-ю строку на том же листе.

Вы можете пропустить шаг получения высоты исходной строки с помощью метода **GetRowHeigh**, а затем установки высоты строки назначения с помощью метода **SetRowHeight**, так как метод **CopyRow** автоматически учитывает высоту строки.



{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-RowsAndColumns-CopyingRowsAndColumns-CopyingRows-new.cpp" >}}

{{% alert color="primary" %}} 

При копировании строк важно отметить связанные изображения, диаграммы или другие объекты рисования, так как это также работает в Microsoft Excel:

1. Если индекс исходной строки равен 5, изображение, диаграмма и т. д. будут скопированы, если они находятся в трех строках (начальный индекс строки равен 4, а конечный индекс строки равен 6).
1. Существующие изображения, диаграммы и т. д. в строке назначения не будут удалены.

{{% /alert %}} 
### **Копирование столбцов**
Aspose.Cells предоставляет метод CopyColumn класса Aspose::Cells::ICells, этот метод копирует все типы данных, включая формулы - с обновленными ссылками - и значения, комментарии, форматы ячеек, скрытые ячейки, изображения и другие объекты рисования из исходного столбца в столбец назначения.

Метод CopyColumn принимает следующие параметры:

- объект исходных ячеек,
- индекс исходного столбца, и
- индекс столбца назначения.

Используйте метод CopyColumn для копирования столбца внутри листа или на другой лист.

В этом примере копируется столбец из листа и вставляется в лист другой книги.



{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-RowsAndColumns-CopyingRowsAndColumns-CopyingColumns-new.cpp" >}}
