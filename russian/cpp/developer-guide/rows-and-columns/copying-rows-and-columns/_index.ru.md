---
title: Копирование строк и столбцов
type: docs
weight: 20
url: /ru/cpp/copying-rows-and-columns/
---
##  **Введение**
Иногда вам нужно скопировать строки и столбцы на листе, не копируя весь лист. С помощью Aspose.Cells можно копировать строки и столбцы внутри книг или между ними.
При копировании строки (или столбца) содержащиеся в ней данные, включая формулы (с обновленными ссылками) и значения, комментарии, форматирование, скрытые ячейки, изображения и другие объекты рисования, также копируются.
##  **Копирование строк и столбцов с помощью Microsoft Excel**
1. Выберите строку или столбец, который вы хотите скопировать.
1.  Чтобы скопировать строки или столбцы, нажмите**Копировать** на**Стандартный** панель инструментов или нажмите**CTRL**+*С**.
1. Выберите строку или столбец ниже или справа от того места, куда вы хотите скопировать свой выбор.
1.  При копировании строк или столбцов нажмите кнопку**Скопировано Cells** на**Вставлять** меню.

{{% alert color="primary" %}} 

 Если вы нажмете**Вставить** на**Стандартный** панель инструментов или нажмите**CTRL**+**V** вместо нажатия команды на **Вставить** меню, любое содержимое ячеек назначения заменяется.

{{% /alert %}} 
##  **Использование Aspose.Cells**
###  **Копирование строк**
Aspose.Cells предоставляет метод CopyRow класса Aspose::Cells::ICells. Этот метод копирует все типы данных, включая формулы, значения, комментарии, форматы ячеек, скрытые ячейки, изображения и другие объекты рисования, из исходной строки в целевую строку.

Метод CopyRow принимает следующие параметры:

- исходный объект Cells,
- индекс исходной строки и
- индекс строки назначения.

Используйте этот метод, чтобы скопировать строку на листе или на другой лист. Метод CopyRow работает аналогично методу Microsoft Excel. Так, например, вам не нужно явно задавать высоту целевой строки, это значение тоже копируется.

В следующем примере показано, как скопировать строку на листе. Он использует файл Excel шаблона Microsoft и копирует вторую строку (вместе с данными, форматированием, комментариями, изображениями и т. д.) и вставляет ее в 12-ю строку на том же листе.

 Вы можете пропустить шаг, который получает высоту исходной строки, используя**GetRowHeigh** метод, а затем устанавливает высоту строки назначения, используя метод**SetRowHeight** метод как**Копироватьстроку** метод автоматически заботится о высоте строки.



{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-RowsAndColumns-CopyingRowsAndColumns-CopyingRows-new.cpp" >}}

{{% alert color="primary" %}} 

При копировании строк важно отмечать связанные изображения, диаграммы или другие объекты рисования, как и в случае с Microsoft Excel:

1. Если индекс исходной строки равен 5, изображение, диаграмма и т. д. копируются, если они содержатся в трех строках (индекс начальной строки — 4, а индекс конечной строки — 6).
1. Существующие изображения, диаграммы и т. д. в целевой строке не будут удалены.

{{% /alert %}} 
###  **Копирование столбцов**
Aspose.Cells предоставляет метод CopyColumn класса Aspose::Cells::ICells. Этот метод копирует все типы данных, включая формулы - с обновленными ссылками - и значения, комментарии, форматы ячеек, скрытые ячейки, изображения и другие объекты рисования из источника. столбец в целевой столбец.

Метод CopyColumn принимает следующие параметры:

- исходный объект Cells,
- индекс исходного столбца и
- индекс столбца назначения.

Используйте метод CopyColumn, чтобы скопировать столбец на листе или на другой лист.

В этом примере столбец копируется с листа и вставляется на лист другой книги.



{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-RowsAndColumns-CopyingRowsAndColumns-CopyingColumns-new.cpp" >}}
