---
title: Способы вычисления формул
type: docs
weight: 30
url: /ru/cpp/ways-to-calculate-formulas/
---

## **Введение**
У Aspose.Cells есть встроенный движок вычисления формул. Он может не только пересчитывать формулы, импортированные из шаблонов дизайнера, но также поддерживает вычисление результатов формул, добавленных во время выполнения.
## **Добавление формул и вычисление результатов**
Aspose.Cells поддерживает большинство формул или функций, которые составляют часть Microsoft Excel. их можно использовать через API или с помощью дизайнерских электронных таблиц. Aspose.Cells поддерживает огромный набор математических, строковых, логических, дата/время, статистических, поисковых и ссылочных формул.

Используйте метод Cell.SetFormula для добавления формулы в ячейку. При применении формулы к ячейке всегда начинайте строку с знака равенства (=), как это делается при создании формулы в Microsoft Excel. Используйте запятую (,) для разделения параметров функции.

Для вычисления результатов формул вызовите метод Workbook.CalculateFormula(), который обрабатывает все формулы, встроенные в файл Excel. Пожалуйста, ознакомьтесь с примером кода ниже, добавляющим формулу и вычисляющим ее результаты. Пожалуйста, проверьте [выходной файл Excel](38109185.xlsx), созданный с помощью этого кода.

**Пример кода**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-AddingFormulasAndCalculatingResults-new.cpp" >}}
<!---## **Прямое вычисление формулы**
Иногда вам нужно вычислить результаты формул напрямую, без добавления их в электронную таблицу. Значения ячеек, используемые в формуле, уже существуют в электронной таблице, и все, что вам нужно, - найти результат этих значений на основе некоторой формулы Microsoft Excel без добавления формулы в электронную таблицу.

Вы можете использовать метод Worksheet.CalculateFormula(String formula) для вычисления результатов таких формул без их добавления в электронную таблицу.

Ниже приведен код, создающий следующий выходной результат.

{{< highlight java >}}

 Value of A1: 20

Value of A2: 30

Result of Sum(A1:A2): 50

{{< /highlight >}}

**Пример кода**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-DirectCalculationOfFormula.cpp" >}}   --->
## **Вычисление формул один раз**
Когда Workbook.CalculateFormula() вызывается для вычисления значений формул в шаблоне книги, Aspose.Cells создает цепочку вычислений. Это увеличивает производительность при вычислении формул для второго или третьего раза.

Однако, если шаблон содержит много формул, первый раз вычисления формулы может занять много времени процессора и памяти.

Aspose.Cells позволяет отключить создание цепочки вычислений, что полезно, когда вы хотите вычислить формулы только один раз.

Пожалуйста, вызовите Workbook.GetISettings().SetCreateCalcChain() с параметром false. Вы можете использовать [предоставленный файл Excel](38109186.xlsx) для тестирования этого кода.

**Пример кода**

{{< gist "aspose-cells-gists" "6f7d9819d85793c3a3b5d040af42e1a9" "Examples-CellsCPP-Formulas-WaysToCalculateFormulas-CalculatingFormulasOnceOnly-new.cpp" >}}
