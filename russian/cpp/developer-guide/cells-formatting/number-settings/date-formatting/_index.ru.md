---
title: Как форматировать число как дату с помощью C++
linktitle: Как форматировать число как дату
type: docs
weight: 10
url: /ru/cpp/format-number-to-date/
description: В этой статье будет рассказано о том, как форматировать число в дату, используя API Aspose.Cells for C++.
keywords: форматировать число как дату, настройки числа ячейки, форматировать число в дату, настройки даты, формат даты.
---

## **Возможные сценарии использования**
Форматирование чисел как дат в Excel (или любом табличном редакторе) важно по нескольким причинам, особенно при работе с данными, содержащими время или планирование. Вот почему полезно форматировать числа как даты:

1. **Правильная интерпретация значений даты**: В Excel даты сохраняются как серийные номера (например, 1 — 1 января 1900 года, а 44210 — 6 сентября 2021 года). Если эти числа не отформатированы как даты, пользователи могут видеть бессмысленные числа вместо распознаваемых дат. Правильное форматирование позволяет Excel отображать их как фактические даты (например, 06.09.2021 вместо 44210).
2. **Облегчает вычисления, связанные со временем**: Excel может выполнять многие вычисления с датами, такие как расчет количества дней между двумя датами, добавление или вычитание дней, определение дня недели. Если числа не отформатированы как даты, Excel не сможет эффективно выполнять эти операции. Например, чтобы узнать количество дней между 01.09.2023 и 01.10.2023, Excel легко рассчитает это, если числа в формате даты.
3. **Обеспечивает последовательность**: Когда все значения, связанные с датами, отформатированы правильно, обеспечивается единый читаемый стиль отображения дат. Эта последовательность важна в бизнес-отчетах, планах проектов и базах данных, где важна согласованность дат. Разные регионы используют разные форматы дат (например, ММ/ДД/ГГГГ в США и ДД/ММ/ГГГГ в других странах), поэтому форматирование помогает правильно их интерпретировать.
4. **Повышает читаемость**: Даты, отображаемые в стандартном формате (например, 01/01/2024), легче воспринимаются, чем сырые серийные номера вроде 45000. Правильное форматирование даты делает вашу таблицу более удобной для пользователя и предотвращает путаницу. Особенно важно в сценариях расписания, хронологий, планирования мероприятий или исторических данных.
5. **Помогает при сортировке и фильтрации**: Когда даты правильно отформатированы, Excel распознает их как настоящие даты, что облегчает сортировку или фильтрацию данных по хронологии. Например, можно отсортировать список событий по дате или отфильтровать диапазон данных для отображения только записей между двумя датами. Без правильного форматирования дат сортировка может зависеть от сырых чисел, а не от календарных дат.
6. **Возможность использования функций даты**: Excel предоставляет множество мощных функций даты, таких как: TODAY(), DATEDIF(), WORKDAY(), YEAR(), MONTH(), DAY(). Для правильных вычислений эти функции требуют правильного форматирования дат.
7. **Поддержка визуализации (графики/таймлайн)**: Правильно отформатированные даты могут использоваться для создания графиков и диаграмм, где время — это ключевая ось. Например, в графике временной шкалы Excel необходимо даты в распознанном формате для точного отображения событий во времени. Некорректное или отсутствующее форматирование чисел может приводить к непонятным графикам или отображению неправильной информации.
8. **Предотвращение неправильной интерпретации**: Сырые числа могут легко быть неправильно поняты. Например, 44210 могут восприниматься как произвольное числовое значение, но при форматировании как даты ясно, что это 6 сентября 2021 года. Правильное форматирование дат помогает избежать неправильного истолкования данных.
9. **Облегчение ввода данных**: Когда ячейки отформатированы как даты, пользователи получают подсказки по вводу данных в правильном формате, что предотвращает ошибки при вводе и обеспечивает правильное захватывание значений даты.
10. **Критически важно для планирования и отслеживания**: В любой ситуации, связанной с планированием, отслеживанием или сроками (например, управление проектами, финансовое прогнозирование или отчеты, чувствительные к времени), форматирование чисел как дат имеет решающее значение для точности и понимания. Это способствует лучшему планированию и выполнению задач.

## **Как форматировать число как дату в Excel**
Чтобы отформатировать число как дату в Excel, выполните следующие шаги:

### **Использование ленты (Вкладка Главная)**
1. Выделите ячейки с числами, которые хотите отформатировать как даты.
2. Перейдите на вкладку Главная на ленте.
3. В группе Число щелкните стрелку рядом с полем Формат чисел (там может отображаться "Общий" или "Число" по умолчанию).
4. Выберите короткую дату или длинную дату из выпадающего списка. Короткая дата: отображает дату в кратком виде, например, ММ/ДД/ГГГГ (формат США) или ДД/ММ/ГГГГ (международный формат). Длинная дата: отображает дату более развернуто, например, понедельник, 1 января 2024.
<br>
<img src="1.png" width=60% />

### **Использование диалогового окна Формат ячеек**
1. Выберите ячейки, которые хотите отформатировать.
2. Щелкните правой кнопкой мыши по выбранным ячейкам и выберите Формат ячеек или нажмите Ctrl + 1 (Windows) или Cmd + 1 (Mac).
3. В диалоговом окне Формат ячеек перейдите на вкладку Число.
4. В списке слева выберите Дата.
5. Выберите нужный формат даты из списка справа (например, ММ/ДД/ГГГГ, ДД/ММ/ГГГГ или пользовательские форматы).
<br>
<img src="2.png" width=60% />
6. Нажмите ОК для применения формата даты.

## **Как форматировать число в дату в Aspose.Cells**

Чтобы отформатировать числа как дату в библиотеке Aspose.Cells for C++ для работы с файлами Excel, можно программно применить формат даты к ячейкам. Вот как это сделать с помощью C++ и Aspose.Cells:

```cpp
#include <iostream>
#include "Aspose.Cells.h"
using namespace Aspose::Cells;

int main()
{
    Aspose::Cells::Startup();

    // Create a new workbook
    Workbook workbook;

    // Access the first worksheet
    Worksheet worksheet = workbook.GetWorksheets().Get(0);

    // Access the cell where you want to apply the date format
    Cell a1 = worksheet.GetCells().Get(u"A1");

    // Set a numeric value that represents a date (e.g., 44210 represents 09/06/2021 in Excel)
    a1.PutValue(44210);

    // Create a style object to apply the date format
    Style a1Style = a1.GetStyle();

    // "14" represents a standard date format in Excel (MM/DD/YYYY)
    a1Style.SetNumber(14);

    // Apply the style to the cell
    a1.SetStyle(a1Style);

    // Access the cell where you want to apply the currency format
    Cell a2 = worksheet.GetCells().Get(u"A2");

    // Set a numeric value to the cell
    a2.PutValue(44210);

    // Create a style object to apply the date format
    Style a2Style = a2.GetStyle();

    // Custom format for YYYY-MM-DD
    a2Style.SetCustom(u"YYYY-MM-DD");

    // Apply the style to the cell
    a2.SetStyle(a2Style);

    // Save the workbook
    workbook.Save(u"DateFormatted.xlsx");

    Aspose::Cells::Cleanup();
}
```
