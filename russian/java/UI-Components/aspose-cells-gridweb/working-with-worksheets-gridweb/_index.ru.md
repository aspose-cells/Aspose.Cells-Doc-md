---
title: Работа с рабочими листами GridWeb
type: docs
weight: 30
url: /ru/java/working-with-worksheets-gridweb/
---
##  **Доступ к рабочим листам**

В этом разделе обсуждается доступ к листам элемента управления GridWeb. Мы также можем называть эти рабочие листы веб-листами, поскольку они принадлежат GridWeb и используются в веб-приложениях.

Все листы, содержащиеся в элементе управления GridWeb, хранятся в коллекции GridWorksheetCollection элемента управления GridWeb. Доступ к определенному листу можно легко получить по его индексу.

Разработчики могут получить доступ к определенному листу, указав его индекс листа, как показано ниже в примере фрагмента кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AccessingWorksheet-AccessingWorksheet.jsp" >}}

##  **Удаление рабочего листа**

В этом разделе представлена краткая информация об удалении листов из файлов Excel Microsoft с помощью GridWeb API. Удалите рабочий лист, указав его индекс.

Разработчики могут удалить определенный лист, указав его индекс листа с помощью метода removeAt коллекции GridWorksheetCollection, как показано ниже в примере фрагмента кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RemovingWorksheet-RemovingWorksheet.jsp" >}}

##  **Добавление листов**

Рабочие листы являются неотъемлемой частью GridWeb. Все данные управляются и хранятся в виде таблиц. GridWeb позволяет разработчикам добавлять один или несколько листов в элемент управления Aspose.Cells.GridWeb. В этом разделе показаны простые подходы к добавлению листов в GridWeb.

###  **Без указания имени листа**

Самый простой способ добавить лист в Aspose.Cells.GridWeb — вызвать метод добавления класса GridWorksheetCollection в элементе управления GridWeb. При этом создаются листы с именами по умолчанию (то есть Лист1, Лист2, Лист3 и т. д.) и добавляются в элемент управления GridWeb.

**Вывод: в GridWeb добавлен рабочий лист с именем по умолчанию.** 

![задача: image_alt_text](working-with-worksheets-gridweb_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingWorksheetWithoutSpecificName-AddingWorksheetWithoutSpecificName.jsp" >}}

###  **С указанным именем листа**

Чтобы добавить лист с определенным именем в элемент управления GridWeb вместо использования схемы именования по умолчанию, вызовите перегруженную версию метода add, который принимает указанную строку SheetName. Например, в приведенном ниже примере добавляется лист с именем «Счет».

**Вывод: в GridWeb добавлен лист с указанным именем.** 

![задача: image_alt_text](working-with-worksheets-gridweb_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingWorksheetWithSpecificName-AddingWorksheetWithSpecificName.jsp" >}}

{{% alert color="primary" %}}

 Метод add() возвращает индекс нового листа, который можно использовать для доступа к экземпляру этого листа. Более подробную информацию о том, как получить доступ к рабочим листам, см.[Доступ к рабочим листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

##  **Переименование рабочего листа**

Переименование рабочего листа может быть очень полезно при работе со многими листами в GridWeb и при необходимости изменить их имена, чтобы сделать их более содержательными. Например, лист, содержащий счет, можно переименовать в «Счет» вместо «Лист1». В этом разделе описана эта простая, но полезная функция.

###  **Переименование рабочего листа**

Все листы содержат свойство Name, которое позволяет разработчикам получать доступ к именам листов или изменять их. Чтобы переименовать рабочий лист:

1. Получите доступ к листу из коллекции GridWorksheetCollection.
1. Переименуйте выбранный лист.

{{% alert color="primary" %}}

 Более подробную информацию о том, как получить доступ к рабочим листам в Aspose.Cells.GridWeb, см.[Доступ к рабочим листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

Перед выполнением кода листу присваивается имя по умолчанию, например Лист1.

**Входной файл: лист с именем по умолчанию Лист1.** 

![задача: image_alt_text](working-with-worksheets-gridweb_3.png)

После запуска кода рабочий лист будет переименован в Invoice.

**Вывод: рабочий лист переименован в «Счет».** 

![задача: image_alt_text](working-with-worksheets-gridweb_4.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RenamingWorksheet-RenamingWorksheet.jsp" >}}

##  **Копирование рабочего листа**

[Добавление листов](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-addingworksheets)описывает, как добавлять новые листы в GridWeb. Также можно добавить копию (или реплику) другого листа в элемент управления Aspose.Cells.GridWeb. Эта функция может быть полезна, когда идентичные или похожие данные на одном листе также необходимы на другом листе. В этом случае проще скопировать существующий лист и добавить его в Aspose.Cells.GridWeb как новый лист, а не создавать его с нуля.

###  **Использование индекса листа**

В приведенном ниже примере кода показано, как добавить копию рабочего листа в элемент управления GridWeb, указав индекс рабочего листа в методе addCopy GridWorksheetCollection.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-CopyWorksheetUsingSheetIndex-CopyWorksheetUsingSheetIndex.jsp" >}}
###  **Использование имени листа**
В приведенном ниже примере кода показано, как добавить копию рабочего листа в элемент управления GridWeb, указав имя рабочего листа в методе addCopy GridWorksheetCollection.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-CopyWorksheetUsingSheetName-CopyWorksheetUsingSheetName.jsp" >}}

{{% alert color="primary" %}}

 Метод addCopy возвращает индекс вновь добавленного листа, который можно использовать для доступа к экземпляру листа. Более подробную информацию о том, как получить доступ к рабочим листам, см.[Доступ к рабочим листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

##  **Работа с именованными диапазонами**

Обычно метки столбцов и строк используются для уникальной ссылки на ячейки. Но вы можете создавать описательные имена для представления ячеек, диапазонов ячеек, формул или постоянных значений.

 Слово**имя** может относиться к строке символов, представляющей ячейку, диапазон ячеек, формулу или постоянное значение. Например, используйте понятные имена, например «Продукты», для обозначения труднопонятных диапазонов, например «Продажи!C20:C30».

 Метки можно использовать в формулах, которые ссылаются на данные на одном листе; если вы хотите представить диапазон на другом листе, вы можете использовать имя.**Именованные диапазоны** — одна из самых мощных функций Microsoft Excel.

Пользователи могут присвоить имя диапазону и использовать это имя в формулах. Aspose.Cells.GridWeb поддерживает эту функцию.

###  **Добавление/ссылка на именованные диапазоны в формулах**

Элемент управления GridWeb предоставляет два класса (GridName и GridNameCollection) для работы с именованными диапазонами.

Следующий фрагмент кода поможет вам понять, как их использовать.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingNamedRangesinFormulas-AddingNamedRangesinFormulas.jsp" >}}

##  **Управление комментариями на листе**

В этом разделе обсуждается добавление, доступ и удаление комментариев из листов. Комментарии полезны для добавления примечаний или полезной информации для пользователей, которые будут работать с листом. Разработчики имеют возможность добавлять комментарии в любую ячейку листа.

###  **Работа с комментариями**

####  **Добавление комментариев**

Чтобы добавить комментарий к листу, выполните следующие действия:

1. Добавьте элемент управления Aspose.Cells.GridWeb в веб-форму.
1. Откройте лист, к которому вы добавляете комментарии.
1. Добавьте комментарий к ячейке.
1. Установите примечание для нового комментария.

**Комментарий добавлен на лист** 

![задача: image_alt_text](working-with-worksheets-gridweb_5.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingComments-AddingComments.jsp" >}}

####  **Доступ к комментариям**

Чтобы получить доступ к комментарию:

1. Получите доступ к ячейке, содержащей комментарий.
1. Получите ссылку на ячейку.
1. Передайте ссылку на коллекцию комментариев, чтобы получить доступ к комментарию.
1. Теперь можно изменить свойства комментария.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AccessingComments-AccessingComments.jsp" >}}

####  **Удаление комментариев**

Чтобы удалить комментарий:

1. Получите доступ к ячейке, как описано выше.
1. Используйте метод removeAt коллекции Comment, чтобы удалить комментарий.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RemovingComments-RemovingComments.jsp" >}}

##  **Управление гиперссылками на листе**

В этом разделе обсуждаются, какие типы гиперссылок поддерживаются в Aspose.Cells.GridWeb и как ими программно управлять. Гиперссылки можно использовать либо для создания ссылок на веб-URL-адреса, либо для выполнения обратной передачи на сервер.

###  **Типы гиперссылок**

Следующие гиперссылки поддерживаются Aspose.Cells.GridWeb:

- Текстовые URL-гиперссылки, URL-гиперссылки, примененные к тексту.
- Гиперссылки URL-адресов изображений, гиперссылки URL-адресов, применяемые к изображениям.

####  **Текстовые URL-гиперссылки**

В приведенном ниже примере на лист добавляются две гиперссылки. У одного цель _blank, а у другого — _parent.

![задача: image_alt_text](working-with-worksheets-gridweb_6.png)

**Вывод: текстовые гиперссылки добавлены на лист.**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-TextURLHyperlinks-TextURLHyperlinks.jsp" >}}

####  **Гиперссылки URL-адреса изображения**

В приведенном ниже примере на лист добавляется гиперссылка URL-адреса изображения.

![задача: image_alt_text](working-with-worksheets-gridweb_7.png)

**Вывод: гиперссылка на изображение добавлена на лист.**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-ImageURLHyperlinks-ImageURLHyperlinks.jsp" >}}

##  **Сортировка данных**

Сортировка — очень ценная функция, когда дело доходит до обработки данных. Несортированные данные доставляют пользователям неудобства при поиске конкретной информации. Aspose.Cells.GridWeb поддерживает мощные функции сортировки. В этом разделе обсуждается сортировка данных с использованием Aspose.Cells.GridWeb API.

Aspose.Cells.GridWeb позволяет разработчикам сортировать данные по горизонтали и вертикали, чтобы разработчики могли сортировать данные сверху вниз или слева направо.

###  **Сверху вниз**

Чтобы отсортировать данные сверху вниз:

1. Добавьте элемент управления Aspose.Cells.GridWeb в свою веб-форму.
1. Откройте лист, который вы хотите отсортировать.
1. Сортировка диапазона данных в любом порядке (по возрастанию или убыванию). Обязательно выберите ориентацию сверху вниз.

В приведенном ниже примере данные сортируются в двух столбцах (идентификатор учащегося и имя учащегося) листа в порядке возрастания. Только двенадцать строк по два столбца сортируются сверху вниз.

Перед применением кода рабочий лист содержит неупорядоченные данные.

**Входные данные: несортированные данные.** 

![задача: image_alt_text](working-with-worksheets-gridweb_8.png)

После выполнения кода данные сортируются по возрастанию.

**Вывод: данные отсортированы сверху вниз в порядке возрастания.** 

![задача: image_alt_text](working-with-worksheets-gridweb_9.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-datasortedfromtoptobottomascendingorder-datasortedfromtoptobottomascendingorder.jsp" >}}

###  **Слева направо**

Чтобы отсортировать данные слева направо:

1. Добавьте элемент управления Aspose.Cells.GridWeb в свою веб-форму.
1. Откройте лист, который вы хотите отсортировать.
1. Сортировка диапазона данных в любом порядке (по возрастанию или убыванию). Обязательно выбирайте слева направо.

В приведенном ниже примере данные сортируются в две строки (идентификатор учащегося и имя учащегося) в порядке возрастания. Только две строки по четыре столбца сортируются слева направо.

Перед применением кода рабочий лист содержит неупорядоченные данные.

**Входные данные: несортированные данные перед выполнением фрагмента кода.** 

![задача: image_alt_text](working-with-worksheets-gridweb_10.png)

После выполнения кода данные сортируются по возрастанию.

**Вывод: данные отсортированы слева направо в порядке возрастания.** 

![задача: image_alt_text](working-with-worksheets-gridweb_11.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-datasortedfromleftrightascendingorder-datasortedfromleftrightascendingorder.jsp" >}}

##  **Поиск и замена**

Один из самых быстрых способов внесения повторяющихся изменений в большую электронную таблицу — использовать функцию поиска и замены. Функция «Найти» помогает найти текстовую строку или данные и заменить их новым значением. Aspose.Cells.GridWeb предоставляет эту функцию. Он позволяет вам искать и заменять определенную текстовую строку или значение на клиентской стороне листа с помощью простого диалогового окна. Он даже позволяет искать частичные данные.

###  **Диалоговое окно «Найти/Заменить»**

Существует два способа открыть диалоговое окно «Найти/Заменить»:

1.  Когда управление активно, нажмите**CTRL+Ф** чтобы открыть диалоговое окно, или нажмите**CTRL+R** клавиша для открытия диалога с**Заменять** кнопка включена.
1.  Переместите курсор в область ячейки на листе, затем щелкните правой кнопкой мыши. Выбирать**Находить** или**Заменять** из меню.

**Выбор Найти**

![задача: image_alt_text](working-with-worksheets-gridweb_12.png)

Откроется диалоговое окно поиска и замены.

**Диалоговое окно «Найти/заменить»**

![задача: image_alt_text](working-with-worksheets-gridweb_13.png)

**Использование поиска**

Искать:

1. Откройте диалоговое окно «Найти/Заменить».
1. Введите строку, которую хотите найти, в поле Найти.
1. Нажмите «Найти далее», чтобы выполнить поиск.

Следующая ячейка, соответствующая условию поиска, будет выделена.

{{% alert color="primary" %}}

Если ваш критерий поиска не найден, появится диалоговое окно, сообщающее вам об этом.

{{% /alert %}}

###  **Варианты поиска**

В диалоговом окне можно настроить некоторые параметры поиска. В таблице ниже они перечислены.

|**Нет.**|**Название опции**|**Описание**|
| :- | :- | :- |
|1|Учитывать регистр|Указывает, следует ли использовать при поиске учет регистра.|
|2|Сопоставить целое слово|Указывает, следует ли соответствовать всему слову при поиске.|
|3|Поиск вверх|Указывает, будет ли поиск осуществляться снизу вверх.|
|4|Регулярное выражение|Если этот флажок установлен, элемент управления будет обрабатывать строку в текстовом поле «Найти что» как регулярное выражение в процессе поиска.|
|5|Найти в формулах/значениях|Если выбран параметр «Формулы», элемент управления будет соответствовать формуле или неформатированному значению ячеек, если формула или неформатированное значение присутствуют. Если выбран параметр «Значения», элемент управления будет соответствовать только отображаемому значению ячеек.|

###  **Использование замены**

Чтобы заменить текст или значения:

1.  Откройте диалоговое окно «Найти/Заменить», нажав**CTRL+F** или выберите ячейку правой кнопкой мыши и выберите **Найти.** прежде чем нажать *Заменить**.
1.  Введите строку замены в поле**Заменить**поле.
1. Нажмите *Заменить**.

Чтобы заменить текст:

1. Откройте диалоговое окно.
1.  Введите текст, который хотите найти в**Найти то, что** поле и текст, который вы хотите заменить, внутри**Заменить** поле.
1.  Замените одно вхождение за раз, щелкнув**Найти следующее** за которым следует *Заменить**.
1. Если вы точно уверены в том, что содержит рабочий лист, нажмите *Заменить все**.

{{% alert color="primary" %}}

 Если рабочий лист не находится в режиме редактирования,**Заменять** кнопка не отображается.

{{% /alert %}}

## Добавить/удалить гиперссылки со стороны клиента

Aspose.Cells GridWeb теперь поддерживает добавление и удаление гиперссылок со стороны клиента. Для этого API предоставляет функции «addCelllink» и «delCelllink». Следующие фрагменты кода демонстрируют добавление и удаление гиперссылок на стороне клиента в GridWeb.

###  Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add-remove-hyperlink-from-client-side-1.jsp" >}}

Вы также можете создать ссылку на лист, используя следующий фрагмент кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add-remove-hyperlink-from-client-side-2.jsp" >}}

##  Обновление настроек шрифта со стороны клиента

Aspose.Cells GridWeb теперь поддерживает изменение настроек шрифта на стороне клиента. Для этого API предоставляет следующие функции:

- *updateCellFontStyle**: Параметры — r/i/b/ib для обычного/курсива/жирного/курсива&&жирного шрифта
- *updateCellFontSize**: Параметры — имя шрифта и т. д. «Система»
- *updateCellFontName**: Параметры — размер шрифта и т. д. '12пт'
- *updateCellFontColor**: Параметры — none/u/l/ul/ для none/underline/strikeout/underline&&strikeout
- *updateCellFontLine**: Параметры — цвет HTML, например #aa22ee, или известное название цвета, например зеленый, красный,...
- *updateCellBackGroundColor**: Параметры — цвет HTML, например #aa22ee, или известное название цвета, например зеленый, красный,...

Следующий фрагмент кода демонстрирует изменение настроек шрифта на стороне клиента в GridWeb.

###  Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-update_font_from_client_side-1.jsp" >}}

##  Добавление/удаление комментариев со стороны клиента

Aspose.Cells GridWeb теперь поддерживает добавление и удаление комментариев на стороне клиента. Для этого в API предусмотрены функции «addcomments» и «delcomments». Следующий фрагмент кода демонстрирует добавление и удаление комментариев на стороне клиента в GridWeb.

###  Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add_remove_comments_from_client_side.jsp" >}}

##  Показать кнопки для добавления/удаления листов

 Aspose.Cells GridWeb теперь поддерживает добавление и удаление листов с помощью кнопок на панели инструментов. Чтобы кнопки были видны на веб-интерфейсе, вам необходимо установить**GridWeb1.ShowAddButton** на *истину**. В следующем фрагменте кода показано добавление кнопок «Добавить/Удалить» на панель инструментов GridWeb.

###  Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "GridWeb-show_add_remove_worksheet_buttons.java" >}}
