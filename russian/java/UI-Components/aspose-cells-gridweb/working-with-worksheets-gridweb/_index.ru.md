---
title: Работа с рабочими листами GridWeb
type: docs
weight: 30
url: /ru/java/working-with-worksheets-gridweb/
---

## **Доступ к рабочим листам**

В этой теме обсуждается доступ к рабочим листам элемента управления GridWeb. Также их можно называть веб-рабочими листами, потому что они принадлежат GridWeb и используются в веб-приложениях.

Все рабочие листы, содержащиеся в элементе управления GridWeb, хранятся в коллекции GridWorksheetCollection элемента управления GridWeb. Просто получить доступ к определенному рабочему листу по его индексу листа.

Разработчики могут получить доступ к конкретному рабочему листу, указав его индекс листа, как показано ниже в примере кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AccessingWorksheet-AccessingWorksheet.jsp" >}}

## **Удаление листа**

Эта тема предоставляет краткую информацию о удалении рабочих листов из файлов Microsoft Excel с использованием API GridWeb. Удалите рабочий лист, указав его индекс листа.

Разработчики могут удалить определенный рабочий лист, указав его индекс листа с помощью метода removeAt коллекции GridWorksheetCollection, как показано ниже в примере кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RemovingWorksheet-RemovingWorksheet.jsp" >}}

## **Добавление рабочих листов**

Рабочие листы являются неотъемлемой частью GridWeb. Все данные управляются и хранятся в виде рабочих листов. GridWeb позволяет разработчикам добавить один или несколько рабочих листов в элемент управления Aspose.Cells.GridWeb. В этой теме показаны простые подходы к добавлению рабочих листов в GridWeb.

### **Без указания имени листа**

Самый простой способ добавить лист в Aspose.Cells.GridWeb - вызвать метод add класса GridWorksheetCollection в элементе управления GridWeb. Это создает листы, которые используют имена по умолчанию (например, Лист1, Лист2, Лист3 и так далее) и добавляет их в элемент управления GridWeb.

**Результат: в элемент GridWeb добавлен рабочий лист с именем по умолчанию** 

![todo:image_alt_text](working-with-worksheets-gridweb_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingWorksheetWithoutSpecificName-AddingWorksheetWithoutSpecificName.jsp" >}}

### **С указанным именем листа**

Чтобы добавить лист с определенным именем в элемент управления GridWeb, вместо использования схемы имен по умолчанию, вызовите перегруженную версию метода add, принимающую указанную строку SheetName. Например, приведенный ниже пример добавляет лист с именем Invoice.

**Вывод: в GridWeb добавлен рабочий лист с указанным именем** 

![todo:image_alt_text](working-with-worksheets-gridweb_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingWorksheetWithSpecificName-AddingWorksheetWithSpecificName.jsp" >}}

{{% alert color="primary" %}}

Метод add() возвращает индекс нового листа, который может быть использован для доступа к экземпляру данного листа. Для получения более подробной информации о доступе к листам читайте [Доступ к листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

## **Переименование листа**

Переименование листа может быть очень полезным при работе с множеством листов в GridWeb и решении изменить их имена, чтобы они стали более содержательными. Например, лист, содержащий счет-фактуру, может быть переименован в Invoice вместо Лист1. В данной теме описывается эта простая, но полезная функция.

### **Переименование листа**

Все листы содержат свойство Name, которое позволяет разработчикам получать доступ к именам листов или изменять их. Чтобы переименовать лист:

1. Получите доступ к листу из коллекции GridWorksheet.
2. Переименуйте выбранный лист.

{{% alert color="primary" %}}

Для получения более подробной информации о доступе к листам в Aspose.Cells.GridWeb обратитесь к [Доступ к листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

Перед выполнением кода у листа есть имя по умолчанию, например, Sheet1.

**Входной файл: лист с именем по умолчанию Sheet1** 

![todo:image_alt_text](working-with-worksheets-gridweb_3.png)

После выполнения кода лист переименовывается в Invoice.

**Вывод: лист переименован в Invoice** 

![todo:image_alt_text](working-with-worksheets-gridweb_4.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RenamingWorksheet-RenamingWorksheet.jsp" >}}

## **Копирование листа**

[Добавление листов](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-addingworksheets) описывает, как добавить новые листы в GridWeb. Также возможно добавить копию (или реплику) другого листа в элемент управления Aspose.Cells.GridWeb. Эта функция может быть полезна, когда необходимы идентичные или похожие данные на одном листе также требуются на другом листе. В этом случае проще скопировать существующий лист и добавить его в Aspose.Cells.GridWeb в качестве нового листа, вместо создания его с нуля.

### **Используя индекс листа**

Приведенный ниже пример кода показывает, как добавить копию листа в элемент управления GridWeb, указав индекс листа в методе addCopy GridWorksheetCollection.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-CopyWorksheetUsingSheetIndex-CopyWorksheetUsingSheetIndex.jsp" >}}
### **Использование имени листа**
Приведенный ниже пример кода показывает, как добавить копию листа в элемент управления GridWeb, указав имя листа в методе addCopy GridWorksheetCollection.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-CopyWorksheetUsingSheetName-CopyWorksheetUsingSheetName.jsp" >}}

{{% alert color="primary" %}}

Метод addCopy возвращает индекс вновь добавленного листа, который может быть использован для доступа к экземпляру листа. Для получения более подробной информации о доступе к листам читайте [Доступ к листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

## **Работа с Именованными Диапазонами**

Обычно заголовки столбцов и строк используются для уникальной ссылки на ячейки. Но вы можете создавать описательные имена для представления ячеек, диапазонов ячеек, формул или константных значений.

Слово **имя** может относиться к строке символов, представляющей ячейку, диапазон ячеек, формулу или константное значение. Например, используйте понятные имена, такие как Товары, чтобы обращаться к непонятным диапазонам, например, Продажи!C20:C30.

Метки могут использоваться в формулах, которые обращаются к данным на том же листе; если вы хотите представить диапазон на другом листе, вы можете использовать имя. **Именованные диапазоны** - одна из самых мощных функций Microsoft Excel.

Пользователи могут назначать имя диапазону и использовать это имя в формулах. Aspose.Cells.GridWeb поддерживает эту функцию.

### **Добавление/ссылка на именованные диапазоны в формулах**

Элемент управления GridWeb предоставляет два класса (GridName и GridNameCollection) для работы с именованными диапазонами.

Приведенный ниже фрагмент кода поможет вам понять, как ими пользоваться.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingNamedRangesinFormulas-AddingNamedRangesinFormulas.jsp" >}}

## **Управление комментариями в Рабочем листе**

Эта тема обсуждает добавление, доступ к и удаление комментариев из листов. Комментарии полезны для добавления заметок или полезной информации для пользователей, которые будут работать с листом. Разработчики имеют гибкость добавлять комментарии в любую ячейку листа.

### **Работа с комментариями**

#### **Добавление комментариев**

Чтобы добавить комментарий к листу, выполните следующие шаги:

1. Добавьте элемент управления Aspose.Cells.GridWeb на веб-форму.
1. Получите доступ к листу, к которому добавляете комментарии.
1. Добавьте комментарий в ячейку.
1. Установите заметку для нового комментария.

**Комментарий добавлен к листу** 

![todo:image_alt_text](working-with-worksheets-gridweb_5.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingComments-AddingComments.jsp" >}}

#### **Доступ к комментариям**

Для доступа к комментарию:

1. Получите доступ к ячейке, которая содержит комментарий.
1. Получите ссылку на ячейку.
1. Передайте ссылку коллекции Comment, чтобы получить доступ к комментарию.
1. Теперь можно изменять свойства комментария.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AccessingComments-AccessingComments.jsp" >}}

#### **Удаление комментариев**

Чтобы удалить комментарий:

1. Получите доступ к ячейке, как объяснено выше.
1. Используйте метод removeAt коллекции Comment для удаления комментария.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RemovingComments-RemovingComments.jsp" >}}

## **Управление гиперссылками в Рабочем листе**

Эта тема обсуждает, какие типы гиперссылок поддерживаются в Aspose.Cells.GridWeb и как их программно управлять. Гиперссылки могут использоваться для создания ссылок на веб-URL-адреса или для выполнения обратной связи на сервер.

### **Типы гиперссылок**

Следующие гиперссылки поддерживаются Aspose.Cells.GridWeb:

- Гиперссылки URL в тексте, гиперссылки URL примененные к тексту.
- Гиперссылки URL в изображениях, гиперссылки URL примененные к изображениям.

#### **Гиперссылки URL в тексте**

В приведенном ниже примере добавляются две гиперссылки в рабочий лист. Одна имеет цель _blank, в то время как другая установлена на _parent.

![todo:image_alt_text](working-with-worksheets-gridweb_6.png)

**Вывод: текстовые гиперссылки добавлены на лист**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-TextURLHyperlinks-TextURLHyperlinks.jsp" >}}

#### **Гиперссылки URL в изображениях**

В приведенном ниже примере добавляется гиперссылка URL изображения на рабочий лист.

![todo:image_alt_text](working-with-worksheets-gridweb_7.png)

**Результат: добавлена гиперссылка изображения на рабочий лист**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-ImageURLHyperlinks-ImageURLHyperlinks.jsp" >}}

## **Сортировка данных**

Сортировка является очень полезной функцией при обработке данных. Несортированные данные являются проблемой для пользователей при поиске конкретной информации. Aspose.Cells.GridWeb поддерживает мощные функции сортировки. В этой теме обсуждается сортировка данных с использованием API Aspose.Cells.GridWeb.

Aspose.Cells.GridWeb позволяет разработчикам сортировать данные горизонтально и вертикально, чтобы можно было сортировать данные сверху вниз или слева направо.

### **Сверху вниз**

Для сортировки данных сверху вниз выполните следующие шаги:

1. Добавьте элемент управления Aspose.Cells.GridWeb на свою веб-форму.
1. Получите доступ к листу, который вы хотите отсортировать.
1. Отсортируйте диапазон данных в любом порядке (по возрастанию или убыванию). Убедитесь, что выбрана ориентация сверху вниз.

В приведенном ниже примере данные в двух столбцах (ID студента и Имя студента) рабочего листа сортируются по возрастанию. Только двенадцать строк двух столбцов сортируются сверху вниз.

Перед применением кода лист содержит неупорядоченные данные.

**Ввод: неотсортированные данные** 

![todo:image_alt_text](working-with-worksheets-gridweb_8.png)

После выполнения кода данные отсортированы по возрастанию.

**Результат: данные отсортированы сверху вниз по возрастанию** 

![todo:image_alt_text](working-with-worksheets-gridweb_9.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-datasortedfromtoptobottomascendingorder-datasortedfromtoptobottomascendingorder.jsp" >}}

### **Слева направо**

Для сортировки данных слева направо выполните следующие шаги:

1. Добавьте элемент управления Aspose.Cells.GridWeb на свою веб-форму.
1. Получите доступ к листу, который вы хотите отсортировать.
1. Отсортируйте диапазон данных в любом порядке (по возрастанию или убыванию). Убедитесь, что выбрана ориентация слева направо.

В приведенном ниже примере данные в двух строках (ID студента и Имя студента) сортируются по возрастанию. Только две строки четырех столбцов сортируются слева направо.

Перед применением кода лист содержит неупорядоченные данные.

**Ввод: неотсортированные данные перед выполнением фрагмента кода** 

![todo:image_alt_text](working-with-worksheets-gridweb_10.png)

После выполнения кода данные отсортированы по возрастанию.

**Результат: данные отсортированы слева направо по возрастанию** 

![todo:image_alt_text](working-with-worksheets-gridweb_11.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-datasortedfromleftrightascendingorder-datasortedfromleftrightascendingorder.jsp" >}}

## **Поиск и замена**

Один из самых быстрых способов вносить повторяющиеся изменения в большую электронную таблицу - использовать функцию поиска и замены. Функция Поиск помогает находить текстовую строку или данные, а замена заменяет ее новым значением. Aspose.Cells.GridWeb предоставляет эту функцию. Она позволяет выполнять поиск и замену определенной текстовой строки или значения на стороне клиента таблицы с помощью простого диалогового окна. Она даже позволяет искать частичные данные.

### **Диалог Поиска/Замены**

Есть два способа открыть диалог Поиска/Замены:

1. Когда элемент управления активен, нажмите **CTRL+F**, чтобы открыть диалог, или нажмите клавишу **CTRL+R**, чтобы открыть диалог с включенной кнопкой **Замена**.
1. Переместите указатель в область ячейки на листе электронной таблицы, затем щелкните правой кнопкой мыши. Выберите **Поиск** или **Замена** в меню.

**Выбор функции Поиск**

![todo:image_alt_text](working-with-worksheets-gridweb_12.png)

Отображается диалоговое окно поиска и замены.

**Диалоговое окно Поиск/Замена**

![todo:image_alt_text](working-with-worksheets-gridweb_13.png)

**Использование поиска**

Для поиска:

1. Откройте диалоговое окно Поиск/Замена.
1. Введите строку, которую хотите найти в поле "Найти".
1. Щелкните "Найти далее", чтобы выполнить поиск.

Следующая ячейка, соответствующая вашему условию поиска, будет выделена.

{{% alert color="primary" %}}

Если ваш критерий поиска не найден, отобразится диалоговое окно с информацией.

{{% /alert %}}

### **Настройки поиска**

Есть несколько параметров поиска, которые можно настроить в диалоговом окне. В таблице ниже они перечислены.

|**№**|**Имя опции**|**Описание**|
| :- | :- | :- |
|1|Учитывать регистр|Указывает, следует ли использовать учет регистра при поиске.|
|2|Искать целое слово|Указывает, следует ли искать целые слова при поиске.|
|3|Поиск вверх|Указывает, следует ли выполнять поиск снизу вверх.|
|4|Регулярное выражение|Если отмечено, элемент управления будет рассматривать строку в поле "Найти" как регулярное выражение в процессе поиска.|
|5|Искать в формулах/значениях|При выборе "Формулы" элемент управления будет соответствовать формуле или неотформатированному значению ячеек, если формула или неотформатированное значение присутствуют. При выборе "Значения" элемент управления будет соответствовать только отображаемому значению ячеек.|

### **Использование функции Замена**

Для замены текста или значения:

1. Откройте окно поиска и замены, нажав **CTRL + F** или выбрав правой кнопкой мыши ячейку и выбрав **Найти**, перед тем как нажать **Заменить**.
1. Введите заменяемую строку в поле **Заменить на**.
1. Нажмите **Заменить**.

Чтобы заменить текст:

1. Откройте диалоговое окно.
1. Введите текст, который вы хотите найти в поле **Найти**, и текст, который вы хотите заменить, в поле **Заменить на**.
1. Замените по одному вхождению, нажав **Найти далее** и затем **Заменить**.
1. Если вы очень уверены в содержании рабочего листа, нажмите **Заменить все**.

{{% alert color="primary" %}}

Если рабочий лист не находится в режиме редактирования, кнопка **Заменить** не отображается.

{{% /alert %}}

## Добавление/удаление гиперссылок с клиентской стороны

Aspose.Cells GridWeb теперь поддерживает добавление и удаление гиперссылок с клиентской стороны. Для этого API предоставляет функции "addCelllink" и "delCelllink". В следующих фрагментах кода показано добавление и удаление гиперссылок с клиентской стороны в GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add-remove-hyperlink-from-client-side-1.jsp" >}}

Вы также можете ссылаться на лист, используя следующий фрагмент кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add-remove-hyperlink-from-client-side-2.jsp" >}}

## Обновление настроек шрифта с клиентской стороны

Aspose.Cells GridWeb теперь поддерживает изменение настроек шрифта с клиентской стороны. Для этого API предоставляет следующие функции

- **updateCellFontStyle**: Параметры - r/i/b/ib для обычного/курсивного/жирного/курсивного&&жирного
- **updateCellFontSize**: Параметры - название шрифта и т. д. 'Системный'
- **updateCellFontName**: Параметры - размер шрифта и т. д. '12pt'
- **updateCellFontColor**: Параметры - none/u/l/ul/ для none/подчеркивания/зачеркивания/подчеркивания&&зачеркивания
- **updateCellFontLine**: Параметры - цвет HTML, например, #aa22ee или известное имя цвета, как зеленый, красный и т. д.
- **updateCellBackGroundColor**: Параметры - HTML-цвет, например, #aa22ee или известное название цвета, такое как зеленый, красный,...

Следующий фрагмент кода демонстрирует изменение настроек шрифта с клиентской стороны в GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-update_font_from_client_side-1.jsp" >}}

## Добавление/удаление комментариев с клиентской стороны

Aspose.Cells GridWeb теперь поддерживает добавление и удаление комментариев с клиентской стороны. Для этого API предоставляет функции "addcomments" и "delcomments". В следующем фрагменте кода показано добавление и удаление комментариев с клиентской стороны в GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add_remove_comments_from_client_side.jsp" >}}

## Показ кнопок для добавления/удаления рабочих листов

Aspose.Cells GridWeb теперь поддерживает добавление и удаление листов с помощью кнопок на панели инструментов. Чтобы кнопки были видны на фронтенде, необходимо установить **GridWeb1.ShowAddButton** в **true**. Следующий фрагмент кода демонстрирует добавление кнопок Добавить/Удалить на панель инструментов GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "GridWeb-show_add_remove_worksheet_buttons.java" >}}
