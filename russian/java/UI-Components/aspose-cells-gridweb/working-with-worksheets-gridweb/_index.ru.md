---
title: Работа с рабочими листами GridWeb
type: docs
weight: 30
url: /ru/java/working-with-worksheets-gridweb/
---
## **Доступ к рабочим листам**

В этом разделе обсуждается доступ к листам элемента управления GridWeb. Мы также можем называть эти рабочие листы веб-листами, поскольку они принадлежат GridWeb и используются в веб-приложениях.

Все рабочие листы, содержащиеся в элементе управления GridWeb, хранятся в коллекции GridWorksheetCollection элемента управления GridWeb. Существует простой доступ к конкретному рабочему листу по его индексу листа.

Разработчики могут получить доступ к определенному рабочему листу, указав его индекс листа, как показано ниже в примере фрагмента кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AccessingWorksheet-AccessingWorksheet.jsp" >}}

## **Удаление рабочего листа**

В этом разделе содержится краткая информация об удалении рабочих листов из файлов Excel Microsoft с помощью GridWeb API. Удалите рабочий лист, указав его индекс листа.

Разработчики могут удалить определенный рабочий лист, указав его индекс листа с помощью метода removeAt коллекции GridWorksheetCollection, как показано ниже в примере фрагмента кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RemovingWorksheet-RemovingWorksheet.jsp" >}}

## **Добавление рабочих листов**

Рабочие листы являются неотъемлемой частью GridWeb. Все данные управляются и хранятся в виде рабочих листов. GridWeb позволяет разработчикам добавлять один или несколько рабочих листов в элемент управления Aspose.Cells.GridWeb. В этом разделе показаны простые подходы к добавлению листов в GridWeb.

### **Без указания имени листа**

Самый простой способ добавить рабочий лист в Aspose.Cells.GridWeb — вызвать метод добавления класса GridWorksheetCollection в элементе управления GridWeb. При этом создаются рабочие листы с именами по умолчанию (то есть Лист1, Лист2, Лист3 и т. д.) и добавляются в элемент управления GridWeb.

**Вывод: рабочий лист с именем по умолчанию добавлен в GridWeb.** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingWorksheetWithoutSpecificName-AddingWorksheetWithoutSpecificName.jsp" >}}

### **С указанным именем листа**

Чтобы добавить рабочий лист с определенным именем в элемент управления GridWeb вместо использования схемы именования по умолчанию, вызовите перегруженную версию метода добавления, который принимает указанную строку SheetName. Например, в приведенном ниже примере добавляется рабочий лист с именем Invoice.

**Вывод: рабочий лист с указанным именем добавлен в GridWeb.** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingWorksheetWithSpecificName-AddingWorksheetWithSpecificName.jsp" >}}

{{% alert color="primary" %}}

 Метод add() возвращает индекс нового рабочего листа, который можно использовать для доступа к экземпляру этого рабочего листа. Подробнее о том, как получить доступ к рабочим листам, см.[Доступ к рабочим листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

## **Переименование рабочего листа**

Переименование рабочего листа может быть очень полезным при работе с большим количеством рабочих листов в GridWeb и решении изменить их имена, чтобы сделать их более значимыми. Например, рабочий лист, содержащий счет-фактуру, можно переименовать в «Счет-фактура» вместо «Лист1». В этом разделе описывается эта простая, но полезная функция.

### **Переименование рабочего листа**

Все рабочие листы содержат свойство Name, которое позволяет разработчикам получать доступ к именам рабочих листов или изменять их. Чтобы переименовать рабочий лист:

1. Получите доступ к рабочему листу из коллекции GridWorksheetCollection.
1. Переименуйте выбранный рабочий лист.

{{% alert color="primary" %}}

 Дополнительные сведения о том, как получить доступ к рабочим листам в Aspose.Cells.GridWeb, см.[Доступ к рабочим листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

Перед выполнением кода рабочему листу присваивается имя по умолчанию, например Sheet1.

**Входной файл: рабочий лист с именем по умолчанию Sheet1** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_3.png)

После запуска кода рабочий лист переименовывается в Invoice.

**Вывод: рабочий лист переименовывается в счет-фактуру.** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_4.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RenamingWorksheet-RenamingWorksheet.jsp" >}}

## **Копирование рабочего листа**

[Добавление рабочих листов](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-addingworksheets)описывает, как добавлять новые рабочие листы в GridWeb. Также можно добавить копию (или реплику) другого рабочего листа в элемент управления Aspose.Cells.GridWeb. Эта функция может быть полезна, когда идентичные или похожие данные на одном листе требуются и на другом листе. В этом случае проще скопировать существующий рабочий лист и добавить его в Aspose.Cells.GridWeb в качестве нового рабочего листа, чем создавать его с нуля.

### **Использование индекса листа**

В приведенном ниже примере кода показано, как добавить копию рабочего листа в элемент управления GridWeb, указав индекс рабочего листа в методе addCopy GridWorksheetCollection.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-CopyWorksheetUsingSheetIndex-CopyWorksheetUsingSheetIndex.jsp" >}}
### **Использование имени листа**
В приведенном ниже примере кода показано, как добавить копию рабочего листа в элемент управления GridWeb, указав имя рабочего листа в методе addCopy GridWorksheetCollection.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-CopyWorksheetUsingSheetName-CopyWorksheetUsingSheetName.jsp" >}}

{{% alert color="primary" %}}

 Метод addCopy возвращает индекс недавно добавленного рабочего листа, который можно использовать для доступа к экземпляру рабочего листа. Подробнее о том, как получить доступ к рабочим листам, см.[Доступ к рабочим листам](/cells/ru/java/working-with-worksheets-gridweb/#workingwithworksheetsgridweb-accessingworksheets).

{{% /alert %}}

## **Работа с именованными диапазонами**

Обычно метки столбцов и строк используются для уникальной ссылки на ячейки. Но вы можете создавать описательные имена для представления ячеек, диапазонов ячеек, формул или постоянных значений.

 Слово**имя** может относиться к строке символов, представляющей ячейку, диапазон ячеек, формулу или постоянное значение. Например, используйте простые для понимания имена, такие как «Продукты», для обозначения труднопонятных диапазонов, таких как «Продажи!C20:C30».

 Метки можно использовать в формулах, которые ссылаются на данные на одном листе; если вы хотите представить диапазон на другом листе, вы можете использовать имя.**Именованные диапазоны** — одна из самых мощных функций Microsoft Excel.

Пользователи могут присвоить имя диапазону и использовать это имя в формулах. Aspose.Cells.GridWeb поддерживает эту функцию.

### **Добавление/ссылка на именованные диапазоны в формулах**

Элемент управления GridWeb предоставляет два класса (GridName и GridNameCollection) для работы с именованными диапазонами.

Следующий фрагмент кода поможет вам понять, как их использовать.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingNamedRangesinFormulas-AddingNamedRangesinFormulas.jsp" >}}

## **Управление комментариями на листе**

В этом разделе обсуждается добавление, доступ и удаление комментариев из рабочих листов. Комментарии полезны для добавления примечаний или полезной информации для пользователей, которые будут работать с таблицей. Разработчики могут добавлять комментарии к любой ячейке рабочего листа.

### **Работа с комментариями**

#### **Добавление комментариев**

Чтобы добавить комментарий к рабочему листу, выполните следующие действия:

1. Добавьте элемент управления Aspose.Cells.GridWeb в веб-форму.
1. Получите доступ к рабочему листу, к которому вы добавляете комментарии.
1. Добавьте комментарий к ячейке.
1. Установите примечание для нового комментария.

**На рабочий лист добавлен комментарий** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_5.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AddingComments-AddingComments.jsp" >}}

#### **Доступ к комментариям**

Чтобы получить доступ к комментарию:

1. Доступ к ячейке, содержащей комментарий.
1. Получить ссылку на ячейку.
1. Передайте ссылку на коллекцию комментариев, чтобы получить доступ к комментарию.
1. Теперь можно изменить свойства комментария.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-AccessingComments-AccessingComments.jsp" >}}

#### **Удаление комментариев**

Чтобы удалить комментарий:

1. Получите доступ к ячейке, как описано выше.
1. Используйте метод removeAt коллекции Comment, чтобы удалить комментарий.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-RemovingComments-RemovingComments.jsp" >}}

## **Управление гиперссылками на листе**

В этом разделе обсуждается, какие типы гиперссылок поддерживаются в Aspose.Cells.GridWeb и как управлять ими программно. Гиперссылки можно использовать либо для создания ссылок на веб-URL-адреса, либо для выполнения обратной передачи на сервер.

### **Типы гиперссылок**

Следующие гиперссылки поддерживаются Aspose.Cells.GridWeb:

- Текстовые URL-гиперссылки, URL-гиперссылки, применяемые к тексту.
- Гиперссылки URL-адресов изображений, гиперссылки URL-адресов, применяемые к изображениям.

#### **Текстовые URL-гиперссылки**

 В приведенном ниже примере на рабочий лист добавляются две гиперссылки. У одного есть_ пустая цель, в то время как другой установлен на_родитель.

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_6.png)

**Вывод: текстовые гиперссылки добавлены на лист.**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-TextURLHyperlinks-TextURLHyperlinks.jsp" >}}

#### **Гиперссылки URL-адреса изображения**

В приведенном ниже примере гиперссылка URL-адреса изображения добавляется на рабочий лист.

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_7.png)

**Вывод: гиперссылка на изображение добавлена на лист**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-ImageURLHyperlinks-ImageURLHyperlinks.jsp" >}}

## **Сортировка данных**

Сортировка — очень ценная функция, когда дело доходит до обработки данных. Несортированные данные доставляют неудобства пользователям при поиске конкретной информации. Aspose.Cells.GridWeb поддерживает мощные функции сортировки. В этом разделе обсуждается сортировка данных с помощью Aspose.Cells.GridWeb API.

Aspose.Cells.GridWeb позволяет разработчикам сортировать данные по горизонтали и вертикали, чтобы разработчики могли сортировать данные сверху вниз или слева направо.

### **Сверху донизу**

Чтобы отсортировать данные сверху вниз:

1. Добавьте элемент управления Aspose.Cells.GridWeb в свою веб-форму.
1. Получите доступ к рабочему листу, который вы хотите отсортировать.
1. Отсортируйте диапазон данных в любом порядке (по возрастанию или по убыванию). Обязательно выберите ориентацию сверху вниз.

В приведенном ниже примере данные в двух столбцах (идентификатор учащегося и имя учащегося) сортируются в порядке возрастания. Только двенадцать строк из двух столбцов сортируются сверху вниз.

Перед применением кода рабочий лист содержит неупорядоченные данные.

**Вход: несортированные данные** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_8.png)

После выполнения кода данные сортируются в порядке возрастания.

**Вывод: данные отсортированы сверху вниз в порядке возрастания** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_9.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-datasortedfromtoptobottomascendingorder-datasortedfromtoptobottomascendingorder.jsp" >}}

### **Слева направо**

Чтобы отсортировать данные слева направо:

1. Добавьте элемент управления Aspose.Cells.GridWeb в свою веб-форму.
1. Получите доступ к рабочему листу, который вы хотите отсортировать.
1. Отсортируйте диапазон данных в любом порядке (по возрастанию или по убыванию). Обязательно выберите слева направо.

В приведенном ниже примере данные сортируются в двух строках (идентификатор учащегося и имя учащегося) в порядке возрастания. Только две строки из четырех столбцов сортируются слева направо.

Перед применением кода рабочий лист содержит неупорядоченные данные.

**Ввод: несортированные данные перед выполнением фрагмента кода** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_10.png)

После выполнения кода данные сортируются в порядке возрастания.

**Вывод: данные отсортированы слева направо в порядке возрастания** 

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_11.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-datasortedfromleftrightascendingorder-datasortedfromleftrightascendingorder.jsp" >}}

## **Поиск и замена**

Один из самых быстрых способов внести повторяющиеся изменения в большую электронную таблицу — использовать функцию поиска и замены. Поиск помогает найти текстовую строку или данные и заменить их новым значением. Aspose.Cells.GridWeb предоставляет эту функцию. Это позволяет вам искать и заменять определенной текстовой строкой или значением на стороне клиента рабочего листа с помощью простого диалогового окна. Это даже позволяет вам искать частичные данные.

### **Диалоговое окно «Найти/Заменить»**

Диалоговое окно «Найти/Заменить» можно открыть двумя способами:

1.  Когда элемент управления активен, нажмите**CTRL+F** чтобы открыть диалоговое окно, или нажмите**CTRL+R** клавиша для открытия диалога с**Заменять** кнопка включена.
1.  Переместите курсор в область ячейки на листе, затем щелкните правой кнопкой мыши. Выбирать**Находить** или же**Заменять** из меню.

**Выбор поиска**

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_12.png)

Отображается диалоговое окно поиска и замены.

**Диалоговое окно «Найти/Заменить»**

![дело:изображение_альтернативный_текст](working-with-worksheets-gridweb_13.png)

**Использование поиска**

Искать:

1. Откройте диалоговое окно «Найти/Заменить».
1. Введите строку, которую вы хотите найти, в поле «Найти».
1. Нажмите «Найти далее» для поиска.

Следующая ячейка, соответствующая условию поиска, будет выделена.

{{% alert color="primary" %}}

Если ваш критерий поиска не найден, отображается диалоговое окно, чтобы сообщить вам об этом.

{{% /alert %}}

### **Параметры поиска**

Есть несколько параметров поиска, которые можно настроить в диалоговом окне. В таблице ниже они перечислены.

|**Нет.**|**Название опции**|**Описание**|
|:- |:- |:- |
|1|Учитывать регистр|Указывает, использовать ли регистр при поиске.|
|2|Соответствие целому слову|Указывает, следует ли сопоставлять все слово при поиске.|
|3|Искать вверх|Указывает, будет ли выполняться поиск снизу вверх.|
|4|Регулярное выражение|Если этот флажок установлен, элемент управления будет обрабатывать строку в текстовом поле «Найти что» как регулярное выражение в процессе поиска.|
|5|Найти в формулах/значениях|Когда выбраны формулы, элемент управления будет соответствовать формуле или неформатированному значению ячеек, если присутствует формула или неформатированное значение. Когда выбраны значения, элемент управления будет соответствовать только отображаемому значению ячеек.|

### **Использование замены**

Чтобы заменить текст или значения:

1.  Откройте диалоговое окно «Найти/Заменить», нажав**CTRL+F** или щелкните правой кнопкой мыши ячейку и выберите**Находить** прежде чем нажать**Заменять**.
1.  Введите строку замены в поле**Заменить**поле.
1.  Нажмите**Заменять**.

Чтобы заменить текст:

1. Откройте диалоговое окно.
1.  Введите текст, который вы хотите найти в**Найти то, что** поле и текст, который вы хотите заменить в**Заменить** поле.
1.  Замените по одному вхождению, щелкнув**Найти следующий** с последующим**Заменять**.
1.  Если вы абсолютно уверены в том, что содержит рабочий лист, щелкните**Заменить все**.

{{% alert color="primary" %}}

 Если лист не находится в режиме редактирования,**Заменять** кнопка не отображается.

{{% /alert %}}

## Добавить/удалить гиперссылки со стороны клиента

Aspose.Cells GridWeb теперь поддерживает добавление и удаление гиперссылок на стороне клиента. Для этого API предоставляет функции «addCelllink» и «delCelllink». Следующие фрагменты кода демонстрируют добавление и удаление гиперссылок на стороне клиента в GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add-remove-hyperlink-from-client-side-1.jsp" >}}

Вы также можете создать ссылку на лист, используя следующий фрагмент кода.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add-remove-hyperlink-from-client-side-2.jsp" >}}

## Обновите настройки шрифта со стороны клиента

Aspose.Cells GridWeb теперь поддерживает изменение настроек шрифта на стороне клиента. Для этого API предоставляет следующие функции

- **обновлениеCellFontStyle**: Params - r/i/b/ib для обычного/курсивного/жирного/курсивного и&жирного
- **updateCellFontSize**: Params — имя шрифта и т. д. «Система»
- **updateCellFontName**: Params - размер шрифта и т.д. '12pt'
- **обновитьCellFontColor**: Params - none/u/l/ul/ для none/underline/strikeout/underline&&strikeout
- **обновлениеCellFontLine**: Params - цвет html, например #aa22ee, или известное название цвета, например, зеленый, красный,...
- **обновитьCellBackGroundColor**: Params - цвет html, например #aa22ee, или известное название цвета, например, зеленый, красный,...

В следующем фрагменте кода показано изменение параметров шрифта на стороне клиента в GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-update_font_from_client_side-1.jsp" >}}

## Добавить/удалить комментарии со стороны клиента

Aspose.Cells GridWeb теперь поддерживает добавление и удаление комментариев на стороне клиента. Для этого в API предусмотрены функции «добавить комментарий» и «удалить комментарий». В следующем фрагменте кода показано добавление и удаление комментариев на стороне клиента в GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-worksheets-add_remove_comments_from_client_side.jsp" >}}

## Показать кнопки для добавления/удаления рабочих листов

 Aspose.Cells GridWeb теперь поддерживает добавление и удаление листов с помощью кнопок на панели инструментов. Чтобы кнопки были видны на фронтенде, нужно установить**GridWeb1.ShowAddButton** к**истинный**. В следующем фрагменте кода показано добавление кнопок «Добавить и удалить» на панель инструментов GridWeb.

### Образец кода

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "GridWeb-show_add_remove_worksheet_buttons.java" >}}
