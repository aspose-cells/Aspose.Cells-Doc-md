---
title: Работа с Cells GridWeb
type: docs
weight: 50
url: /ru/java/working-with-cells-gridweb/
---
## **Доступ к Cells на рабочем листе**
В этом разделе обсуждаются ячейки, рассматривается самая основная функция GridWeb: доступ к ячейкам.

Каждый рабочий лист содержит объект GridCells, коллекцию объектов GridCell. Объект GridCell представляет ячейку в Aspose.Cells.GridWeb. С помощью GridWeb можно получить доступ к любой ячейке. Есть два предпочтительных метода:

- [Доступ к ячейке по имени](/cells/ru/java/working-with-cells-gridweb/).
- [Доступ к ячейке по индексам строк и столбцов](/cells/ru/java/working-with-cells-gridweb/).

Ниже обсуждается каждый подход.
### **Использование имени Cell**
Все ячейки имеют уникальное имя. Например, A1, A2, B1, B2 и т. д. Aspose.Cells.GridWeb позволяет разработчикам получать доступ к любой нужной ячейке, используя имя ячейки. Просто передайте имя ячейки (в качестве индекса) в коллекцию GridCells листа GridWorksheet.



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-Accessingcellbyname-Accessingcellbyname.jsp" >}}


### **Использование индексов строк и столбцов**
Ячейку также можно распознать по ее местоположению с точки зрения индексов строк и столбцов. Просто передайте индексы строки и столбца ячейки в коллекцию GridCells таблицы GridWorksheet. Этот подход более быстрый, чем описанный выше.



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-Accessingcellbyrowandcolumnindices-Accessingcellbyrowandcolumnindices.jsp" >}}
## **Доступ и изменение значения Cell**
[Доступ к Cells на рабочем листе](/cells/ru/java/working-with-cells-gridweb/#workingwithcellsgridweb-accessingcellsintheworksheet) обсуждали доступ к ячейкам. Этот раздел расширяет это обсуждение, чтобы показать, как получить доступ к значениям ячеек и изменить их с помощью GridWeb API.
### **Доступ и изменение значения Cell**
#### **Строковые значения**
 Прежде чем получить доступ и изменить значение ячейки, вам необходимо знать, как получить доступ к ячейкам. Подробнее о различных подходах к доступу к ячейкам см.[Доступ к Cells на рабочем листе](/cells/ru/java/working-with-cells-gridweb/#workingwithcellsgridweb-accessingcellsintheworksheet).

Каждая ячейка имеет свойство с именем getStringValue(). После доступа к ячейке разработчики могут получить доступ к методу getStringValue() для доступа к строковому значению ячейки.

{{% alert color="primary" %}} 

ВАЖНО: В ячейках могут храниться значения пяти типов (логические, int, double, DateTime и string), но методы getValue()/setValue() можно использовать только для доступа/изменения значения объекта.

{{% /alert %}} 

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-AccessingModifyingCellStringValue-AccessingModifyingCellStringValue.jsp" >}}
#### **Все типы значений**
Aspose.Cells.GridWeb также предоставляет специальный метод putValue для каждой ячейки. С помощью этого метода можно вставить или изменить любой тип значения (логическое, целое, двойное, DateTime и строковое) в ячейке.



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-AccessingModifyingCell-AccessingModifyingCell.jsp" >}}



Существует также перегруженная версия метода putValue, которая может принимать любое значение в строковом формате и автоматически преобразовывать его в нужный тип данных. Чтобы это произошло, передайте логическое значение true другому параметру метода putValue, как показано ниже в примере.



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-AccessingModifyingCellAllTypeValue-AccessingModifyingCellAllTypeValue.jsp" >}}
## **Добавление формул в Cells**
Самая ценная функция, предлагаемая Aspose.Cells.GridWeb, — это поддержка формул или функций. Aspose.Cells.GridWeb имеет собственный механизм формул, который вычисляет формулы на листах. Aspose.Cells.GridWeb поддерживает как встроенные, так и определяемые пользователем функции или формулы. В этом разделе подробно обсуждается добавление формул в ячейки с помощью Aspose.Cells.GridWeb API.
### **Как добавить и рассчитать формулу?**
 Можно добавлять, получать доступ и изменять формулы в ячейках, используя свойство Формула ячейки. Aspose.Cells.GridWeb поддерживает пользовательские формулы, начиная от простых и заканчивая сложными. Однако большое количество встроенных функций или формул (аналогичных Microsoft Excel) также поставляется с Aspose.Cells.GridWeb. Полный список встроенных функций см.[список поддерживаемых функций.](/cells/ru/net/list-of-supported-functions/)

{{% alert color="primary" %}} 

Синтаксис формулы должен быть совместим с синтаксисом Excel Microsoft. Например, все формулы должны начинаться со знака равенства (=).

Чтобы добавить формулу программно, Aspose.Cells.GridWeb распознает ее как формулу, даже если вы не используете знак **=**, но если конечные пользователи, работающие в графическом интерфейсе, должны его использовать.

{{% /alert %}} 

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-AddingFormulastoCells-AddingFormulastoCells.jsp" >}}



**Формула добавлена в ячейку B3, но не рассчитана GridWeb** 

![дело:изображение_альтернативный_текст](working-with-cells-gridweb_1.png)

На приведенном выше снимке экрана видно, что формула добавлена в ячейку B3, но еще не рассчитана. Чтобы вычислить все формулы, вызовите метод calculateFormula GridWorksheetCollection элемента управления GridWeb после добавления формул на листы, как показано ниже.



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-CalculateFormula-CalculateFormula.jsp" >}}

 Пользователи также могут вычислять формулы, щелкая**Представлять на рассмотрение**.

**Нажатие кнопки «Отправить» в GridWeb** 

![дело:изображение_альтернативный_текст](working-with-cells-gridweb_2.png)

**ВАЖНЫЙ** : если пользователь щелкает**Сохранять** или же**Отменить** кнопки или вкладки листа, все формулы рассчитываются GridWeb автоматически.

**Результат формулы после расчета** 

![дело:изображение_альтернативный_текст](working-with-cells-gridweb_3.png)
### **Ссылка Cells из других рабочих листов**
Используя Aspose.Cells.GridWeb, можно ссылаться на значения, хранящиеся на разных листах, в их формулах, создавая сложные формулы.

Синтаксис для ссылки на значение ячейки из другого листа: SheetName!CellName.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-ReferencingCellsfromOtherWorksheets-ReferencingCellsfromOtherWorksheets.jsp" >}}
## **Создание проверки данных в GridCell GridWeb**
 Aspose.Cells.GridWeb позволяет добавлять**Проверка данных** используя метод GridWorksheet.getValidations().add(). Используя этот метод, вы должны указать**Cell Ассортимент** . Но если вы хотите создать проверку данных в одной ячейке GridCell, вы можете сделать это напрямую, используя метод GridCell.createValidation(). Аналогично можно удалить**Проверка данных** из GridCell с помощью метода GridCell.removeValidation().

 Следующий пример кода создает**Проверка данных** в ячейке B3. Если вы введете любое значение, отличное от 20 и 40, в ячейке B3 отобразится**Ошибка проверки** в виде**Красный ХХХ** как показано на этом снимке экрана.

![дело:изображение_альтернативный_текст](working-with-cells-gridweb_4.png)



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-CreateDataValidationinGridCellofGridWeb-CreateDataValidationinGridCellofGridWeb.jsp" >}}
## **Создание пользовательских командных кнопок**
Aspose.Cells.GridWeb содержит специальные кнопки, такие как «Отправить», «Сохранить» и «Отменить». Все эти кнопки выполняют определенные задачи для Aspose.Cells.GridWeb. Также можно добавить настраиваемые кнопки, выполняющие настраиваемые задачи. В этом разделе объясняется, как использовать эту функцию.

В следующем примере кода объясняется, как создать настраиваемую командную кнопку и как обработать ее событие щелчка. Вы можете использовать любую иконку для пользовательской командной кнопки. Для иллюстрации мы использовали этот значок изображения.

![дело:изображение_альтернативный_текст](working-with-cells-gridweb_5.png)

 Как вы можете видеть на следующем снимке экрана, когда пользователь нажимает пользовательскую кнопку команды, он добавляет текст в ячейку A1, говоря:**«Моя пользовательская командная кнопка нажата».**

![дело:изображение_альтернативный_текст](working-with-cells-gridweb_6.png)



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-CreatingCustomCommandButtons-CreatingCustomCommandButtons.jsp" >}}
### **Обработка событий пользовательской командной кнопки**
В следующем примере кода объясняется, как выполнять обработку событий пользовательской командной кнопки.



{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-EventHandlingofCustomCommandButton-EventHandlingofCustomCommandButton.jsp" >}}
## **Форматирование ячеек для GridWeb**
### **Возможные сценарии использования**
Теперь GridWeb поддерживает ввод данных ячейки в процентном формате, например 3%, и данные в ячейке будут автоматически отформатированы как 3,00%. Однако вам нужно будет установить стиль ячейки в Процентный формат, который имеет GridTableItemStyle.NumberType 9 или 10. Число 9 будет форматировать 3% как 3%, а число 10 будет форматировать 3% как 3,00%.

{{% alert color="primary" %}} 

Если вы не установили для стиля ячейки Процентный формат, то входные данные 3% будут отображаться как 0,03.

{{% /alert %}} 
### **Введите Cell Данные рабочего листа GridWeb в процентном формате.**
В следующем примере кода для ячейки A1 GridTableItemStyle.NumberType задается значение 10, поэтому входные данные 3% автоматически форматируются как 3,00%, как показано на снимке экрана.

![дело:изображение_альтернативный_текст](working-with-cells-gridweb_7.png)
### **Образец кода**
{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "examples-cells-EnterCellDataofGridWebWorksheet-EnterCellDataofGridWebWorksheet.jsp" >}}
