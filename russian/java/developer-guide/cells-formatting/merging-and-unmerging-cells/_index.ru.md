---
title: Объединение и разъединение ячеек
type: docs
weight: 140
url: /ru/java/merging-and-unmerging-cells/
---

{{% alert color="primary" %}}

Нельзя всегда одинаковое количество ячеек в каждой строке или столбце. Например, вы можете захотеть поместить заголовок в ячейку, которая занимает несколько столбцов. Или, если создаете счет-фактуру, вы можете захотеть меньше столбцов для итоговой суммы. Чтобы объединить несколько ячеек в одну, выберите их и объедините. Microsoft Excel позволяет пользователям выбирать ячейки и объединять их для структурирования таблицы так, как им удобно.

**Результат объединения, а затем разъединения диапазона ячеек с тем же форматированием, что и у ячеек слева в Microsoft Excel** 

![todo:image_alt_text](merging-and-unmerging-cells_1.png)

Aspose.Cells поддерживает эту функцию и также может объединять ячейки в листе. Вы также можете разъединить, или разделить, объединенные ячейки. Ссылка ячейки, объединенной ячейки, - это ссылка на верхнюю левую ячейку в исходно выбранном диапазоне.

Обратите внимание, что при объединении ячеек сохраняются только данные в верхней левой ячейке. Если в других ячейках в диапазоне есть данные, эти данные удаляются.

Форматирование также основано на ссылочной ячейке, поэтому при объединении ячеек на объединенную ячейку применяются настройки форматирования верхней левой ячейки в диапазоне. При разделении новые ячейки сохраняют свои исходные настройки форматирования.

{{% /alert %}}

## **Объединение ячеек в листе.**

### **Использование Microsoft Excel**

Ниже описаны действия, как объединить ячейки на листе с использованием Microsoft Excel.

1. Копируйте данные, которые вы хотите в верхнюю левую ячейку в пределах диапазона.
1. Выберите ячейки, которые вы хотите объединить.
1. Чтобы объединить ячейки в строке или столбце и центрировать содержимое ячейки, нажмите на значок **Объединить и центрировать** на панели инструментов **Форматирование**.

### **Использование Aspose.Cells**

У класса [**Cells**](https://reference.aspose.com/cells/java/com.aspose.cells/Cells) есть несколько полезных методов для этой задачи. Например, метод [**merge()**](https://reference.aspose.com/cells/java/com.aspose.cells/cells#merge(int,%20int,%20int,%20int)) объединяет ячейки в одну ячейку в указанном диапазоне ячеек.

Ниже приведен результат после выполнения приведенного ниже кода.

**Ячейки (C6:E7) были объединены** 

![todo:image_alt_text](merging-and-unmerging-cells_2.png)

#### **Пример кода**

В следующем примере показано, как объединить ячейки (C6:E7) в электронной таблице.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-data-MergingCellsInWorksheet-MergingCellsInWorksheet.java" >}}

## **Разъединение (разделение) объединенных ячеек**

### **Использование Microsoft Excel**

Следующие шаги описывают, как разделить объединенные ячейки с помощью Microsoft Excel.

1. Выберите объединенную ячейку. 
   Когда ячейки были объединены, на панели инструментов **Форматирование** выбрано **Объединить и центрировать**.
1. Нажмите на **Объединить и центрировать** на панели инструментов **Форматирование**.

#### **Использование Aspose.Cells**

У класса [**Cells**](https://reference.aspose.com/cells/java/com.aspose.cells/Cells) есть метод с названием [**unMerge()**](https://reference.aspose.com/cells/java/com.aspose.cells/cells#unMerge(int,%20int,%20int,%20int)), который разделяет ячейки на их исходное состояние. Метод разбивает ячейки, используя ссылку на ячейку в диапазоне объединенных ячеек.

#### **Пример кода**

Приведенный ниже пример показывает, как разделить объединенные ячейки (C6). Пример использует файл, созданный в предыдущем примере, и разбивает объединенные ячейки.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-data-UnMergingCellsInWorksheet-UnMergingCellsInWorksheet.java" >}}

## **Связанные статьи**

- [Поиск и разделение объединенных ячеек](/cells/ru/java/detect-merged-cells-in-a-worksheet/).
- [Объединение и разъединение диапазона ячеек с помощью методов Range.merge() и Range.unMerge()](/cells/ru/java/merge-or-unmerge-range-of-cells/).

