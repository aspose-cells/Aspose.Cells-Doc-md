---
title: Применение условного форматирования в рабочих листах
type: docs
weight: 40
url: /ru/java/apply-conditional-formatting-in-worksheets/
---

{{% alert color="primary" %}}

Эта статья предназначена для подробного понимания того, как добавить условное форматирование к диапазону ячеек на рабочем листе.

Условное форматирование - это расширенная функция в Microsoft Excel, которая позволяет применять форматы к диапазону ячеек и менять этот формат в зависимости от значения ячейки или значения формулы. Например, фон ячейки может быть красным, чтобы выделить отрицательное значение, или цвет текста может быть зеленым для положительного значения. Когда значение ячейки соответствует условию форматирования, формат применяется. Если значение ячейки не соответствует условию форматирования, используется форматирование по умолчанию для ячейки.

Возможно применить условное форматирование с помощью автоматизации Microsoft Office, но это имеет свои недостатки. В этом участвует несколько причин и проблем: например, безопасность, стабильность, масштабируемость и скорость. Основной причиной поиска другого решения является то, что сама Microsoft настоятельно рекомендует не использовать автоматизацию Office для программных решений.

Эта статья показывает, как создать консольное приложение, добавить условное форматирование в ячейки с помощью нескольких простейших строк кода с использованием API Aspose.Cells.

{{% /alert %}}

## **Работа с условным форматированием**

Эта статья разбирает следующие задачи:

1. [Использование Aspose.Cells для применения условного форматирования на основе значения ячейки](/cells/ru/java/apply-conditional-formatting-in-worksheets/#task-1-using-asposecells-to-apply-conditional-formatting-based-on-cell-value).
1. [Использование Aspose.Cells для применения условного форматирования на основе формулы](/cells/ru/java/apply-conditional-formatting-in-worksheets/#task-2-using-asposecells-to-apply-conditional-formatting-based-on-a-formula).

### **Задача 1: Использование Aspose.Cells для применения условного форматирования на основе значения ячейки**

1. **Скачайте и установите Aspose.Cells.zip**:
   1. [Скачать](https://downloads.aspose.com/cells/java) Aspose.Cells for Java.
   1. Распакуйте его на ваш компьютер для разработки.
      Все компоненты Aspose, установленные, работают в режиме оценки. Режим оценки не имеет временных ограничений и вносит в произведенные документы водяные знаки.
1. **Создайте проект**.
   Создайте проект с помощью редактора Java, такого как Eclipse, или создайте простую программу с помощью текстового редактора.
1. **Добавьте путь класса**.
   Чтобы установить Path класса с помощью Eclipse, выполните следующие шаги:
   1. Извлеките Aspose.Cells.jar и dom4j_1.6.1.jar из Aspose.Cells.zip.
   1. Установите classpath проекта в Eclipse:
      1. Выберите ваш проект в Eclipse, затем выберите **Свойства** в меню **Проект**.
      1. Выберите «Путь сборки Java» слева в диалоговом окне.
      1. На вкладке **Библиотеки** выберите **Добавить JAR** или **Добавить внешние JAR**, чтобы выбрать Aspose.Cells.jar и dom4j_1.6.1.jar и добавить их в пути сборки.
   1. Напишите приложение для вызова API компонентов Aspose.
      Или вы можете установить путь при запуске на командной строке в Windows.

{{< highlight java >}}

  javac -classpath %classpath%;e:\Aspose.Cells.jar;  ClassName .javajava -classpath %classpath%;e:\Aspose.Cells.jar;  ClassName  

{{< /highlight >}}

1. **Примените условное форматирование на основе значения ячейки**.
   Ниже приведенный код, используемый компонентом для выполнения задачи. Он применяет условное форматирование к ячейке.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-ConditionalFormattingOnCellValue-ApplyConditionalFormattingOnCellValue.java" >}}

При выполнении вышеуказанного кода условное форматирование применяется к ячейке «A1» в первом рабочем листе выходного файла (output.xls). Условное форматирование, примененное к A1, зависит от значения ячейки. Если значение ячейки A1 находится между 50 и 100, цвет фона красный из-за примененного условного форматирования. Пожалуйста, посмотрите следующие скриншоты сгенерированного файла XLS.

**Выходной файл Excel с A1 значением менее 50**

![todo:image_alt_text](apply-conditional-formatting-in-worksheets_1.png)

**Вывести файл Excel с A1 между 50 и 100**

![todo:image_alt_text](apply-conditional-formatting-in-worksheets_2.png)

### **Задача 2: Использование Aspose.Cells для применения условного форматирования на основе формулы**

1. **Применить условное форматирование в зависимости от формулы**.
   Ниже приведен фактический код, используемый компонентом для выполнения задачи. Он применяет условное форматирование к "B3".

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-ConditionalFormattingBasedOnFormula-ConditionalFormattingBasedOnFormula.java" >}}

При выполнении вышеуказанного кода условное форматирование применяется к ячейке "B3" на первом листе выходного файла (output.xls). Применяемое условное форматирование зависит от формулы, которая вычисляет значение "B3" как сумму B1 & B2. Пожалуйста, ознакомьтесь со следующими скриншотами сгенерированного файла XLS.

**Вывести файл Excel с значением B3 менее 100**

![todo:image_alt_text](apply-conditional-formatting-in-worksheets_3.png)

**Вывести файл Excel с B3 больше 100**

![todo:image_alt_text](apply-conditional-formatting-in-worksheets_4.png)

### **Заключение**

{{% alert color="primary" %}}

Эта статья показывает, как применить условное форматирование к ячейкам на листе с помощью API Aspose.Cells. Надеюсь, это даст вам некоторое представление, чтобы вы могли использовать эти параметры в своих собственных сценариях.

Aspose.Cells предлагает большую гибкость для решений и обеспечивает выдающуюся скорость, эффективность и надежность для удовлетворения конкретных бизнес-требований. Aspose.Cells получает преимущества от многолетних исследований, разработок и тщательной настройки.

Мы приветствуем ваши запросы, комментарии и предложения в [Форуме Aspose.Cells](https://forum.aspose.com/c/cells/9). Мы гарантируем быстрый ответ.

{{% /alert %}}
{{< app/cells/assistant language="java" >}}
