---
title: Применение условного форматирования на листах
type: docs
weight: 40
url: /ru/java/apply-conditional-formatting-in-worksheets/
---
{{% alert color="primary" %}}

Эта статья предназначена для подробного понимания того, как добавить условное форматирование к диапазону ячеек на листе.

Условное форматирование — это расширенная функция в Microsoft Excel, которая позволяет применять форматы к диапазону ячеек и изменять это форматирование в зависимости от значения ячейки или значения формулы. Например, фон ячейки может быть красным, чтобы выделить отрицательное значение, или цвет текста может быть зеленым, если положительное значение. Когда значение ячейки соответствует условию формата, формат применяется. Если значение ячейки не соответствует условию формата, используется форматирование ячейки по умолчанию.

Можно применить условное форматирование с помощью Microsoft Office Automation, но это имеет свои недостатки. Есть несколько причин и проблем: например, безопасность, стабильность, масштабируемость и скорость. Основная причина поиска другого решения заключается в том, что сами сотрудники Microsoft настоятельно рекомендуют использовать Office Automation для программных решений.

В этой статье показано, как создать консольное приложение, добавить условное форматирование к ячейкам с помощью нескольких простейших строк кода, используя файл Aspose.Cells API.

{{% /alert %}}

## **Работа с условным форматированием**

Эта статья работает через следующие задачи:

1. [Использование Aspose.Cells для применения условного форматирования на основе значения ячейки](/cells/ru/java/apply-conditional-formatting-in-worksheets/#task-1-using-asposecells-to-apply-conditional-formatting-based-on-cell-value).
1. [Использование Aspose.Cells для применения условного форматирования на основе формулы](/cells/ru/java/apply-conditional-formatting-in-worksheets/#task-2-using-asposecells-to-apply-conditional-formatting-based-on-a-formula).

### **Задача 1. Использование Aspose.Cells для применения условного форматирования на основе значения Cell**

1. **Скачайте и установите Aspose.Cells.zip**:
   1. [Скачать](https://downloads.aspose.com/cells/java) Aspose.Cells for Java.
 1. Разархивируйте его на своем компьютере для разработки.
 Все компоненты Aspose после установки работают в ознакомительном режиме. Режим оценки не имеет ограничения по времени и только вводит водяные знаки в создаваемые документы.
1. **Создать проект**.
 Либо создайте проект с помощью редактора Java, такого как Eclipse, либо создайте простую программу с помощью текстового редактора.
1. **Добавить путь к классу**.
 Чтобы установить путь к классу с помощью Eclipse, выполните следующие действия:
1. Извлеките файлы Aspose.Cells.jar и dom4j_1.6.1.jar из Aspose.Cells.zip.
 1. Установите путь к классам проекта в Eclipse:
 1. Выберите свой проект в Eclipse, а затем выберите**Характеристики** от**Проект** меню.
 1. Выберите «Java Путь сборки» слева от диалогового окна.
 1. На**Библиотеки** вкладка, выберите**Добавить JAR-файлы** или же**Добавить внешние JAR-файлы** чтобы выбрать Aspose.Cells.jar и dom4j_1.6.1.jar и добавить их в пути сборки.
 1. Напишите приложение для вызова API компонентов Aspose.
 Или вы можете указать путь во время выполнения в командной строке DOS в Windows.

{{< highlight "java" >}}

  javac -classpath %classpath%;e:\Aspose.Cells.jar;  ClassName .javajava -classpath %classpath%;e:\Aspose.Cells.jar;  ClassName  

{{< /highlight >}}

1. **Применение условного форматирования на основе значения ячейки**.
 Ниже приведен код, используемый компонентом для выполнения задачи. Он применяет условное форматирование к ячейке.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-ConditionalFormattingOnCellValue-ApplyConditionalFormattingOnCellValue.java" >}}

Когда приведенный выше код выполняется, условное форматирование применяется к ячейке «A1» на первом рабочем листе выходного файла (output.xls). Условное форматирование, применяемое к A1, зависит от значения ячейки. Если значение ячейки A1 находится в диапазоне от 50 до 100, цвет фона будет красным из-за примененного условного форматирования. См. следующие скриншоты сгенерированного XLS-файла.

**Выходной файл Excel со значением A1 менее 50**

![дело:изображение_альтернативный_текст](apply-conditional-formatting-in-worksheets_1.png)

**Выходной файл Excel с A1 между 50 и 100**

![дело:изображение_альтернативный_текст](apply-conditional-formatting-in-worksheets_2.png)

### **Задача 2. Использование Aspose.Cells для применения условного форматирования на основе формулы**

1. **Применение условного форматирования в зависимости от формулы**.
 Ниже приведен фактический код, используемый компонентом для выполнения задачи. Он применяет условное форматирование к «B3».

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-ConditionalFormattingBasedOnFormula-ConditionalFormattingBasedOnFormula.java" >}}

Когда приведенный выше код выполняется, условное форматирование применяется к ячейке «B3» на первом рабочем листе выходного файла (output.xls). Применяемое условное форматирование зависит от формулы, которая вычисляет значение «B3» как сумму B1 и B2. См. следующие скриншоты сгенерированного XLS-файла.

**Выходной файл Excel со значением B3 менее 100**

![дело:изображение_альтернативный_текст](apply-conditional-formatting-in-worksheets_3.png)

**Выходной файл Excel с B3 больше 100**

![дело:изображение_альтернативный_текст](apply-conditional-formatting-in-worksheets_4.png)

### **Вывод**

{{% alert color="primary" %}}

В этой статье показано, как применить условное форматирование к ячейкам на листе с помощью Aspose.Cells API. Надеюсь, это даст вам некоторое представление, чтобы вы могли использовать эти параметры в своих собственных сценариях.

Aspose.Cells предлагает большую гибкость для решений и обеспечивает выдающуюся скорость, эффективность и надежность для удовлетворения конкретных требований бизнес-приложений. Aspose.Cells — результат многолетних исследований, дизайна и тщательной настройки.

 Будем рады вашим вопросам, комментариям и предложениям в[Aspose.Cells Форум](https://forum.aspose.com/c/cells/9). Мы гарантируем быстрый ответ.

{{% /alert %}}
