---
title: Настройка общей формулы
type: docs
weight: 10
url: /ru/java/setting-shared-formula/
---
{{% alert color="primary" %}} 

Предположим, у вас есть рабочий лист, заполненный данными в формате, похожем на следующий пример рабочего листа.

**Входной файл с одним столбцом или данными** 

![дело:изображение_альтернативный_текст](setting-shared-formula_1.png)

 Вы хотите добавить в B2 функцию, которая будет вычислять налог с продаж для первой строки данных. Налог**9%** Формула, по которой рассчитывается налог с продаж, выглядит следующим образом:**"=А2*0,09"**. В этой статье объясняется, как применить эту формулу к номеру Aspose.Cells.

{{% /alert %}} 

 Aspose.Cells позволяет указать формулу с помощью[Cell.Formula](https://reference.aspose.com/cells/java/com.aspose.cells/cell#Formula) имущество, в частности[Cell.setFormula()](https://reference.aspose.com/cells/java/com.aspose.cells/cell#Formula) а также[Cell.getFormula()](https://reference.aspose.com/cells/java/com.aspose.cells/cell#Formula).

Есть два варианта добавления формул в другие ячейки (B3, B4, B5 и т. д.) в столбце.

Либо сделайте то, что вы сделали для первой ячейки, фактически установив формулу для каждой ячейки, соответственно обновив ссылку на ячейку (A3*0,09, А4*0,09, A5*0,09 и так далее). Это требует обновления ссылок на ячейки для каждой строки. Также требуется Aspose.Cells для анализа каждой формулы по отдельности, что может занять много времени для больших электронных таблиц и сложных формул. Он также добавляет дополнительные строки кода, хотя циклы могут несколько их сократить.

 Другой подход заключается в использовании**общая формула** При использовании общей формулы формулы автоматически обновляются для ссылок на ячейки в каждой строке, чтобы налог был рассчитан правильно.[Cell.setSharedFormula](https://reference.aspose.com/cells/java/com.aspose.cells/cell#setSharedFormula\(java.lang.String,%20int,%20int\)) более эффективен, чем первый.

В следующем примере показано, как его использовать. На скриншоте ниже показан выходной файл.

**Выходной файл: применена общая формула** 

![дело:изображение_альтернативный_текст](setting-shared-formula_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-SettingSharedFormula-SettingSharedFormula.java" >}}
