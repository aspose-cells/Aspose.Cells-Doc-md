---
title: Измените источник данных диаграммы на рабочий лист назначения при копировании строк или диапазона
type: docs
weight: 850
url: /ru/java/change-data-source-of-the-chart-to-destination-worksheet-while-copying-rows-or-range/
---
## **Возможные сценарии использования**
Когда вы копируете строки или диапазоны, содержащие диаграммы, на новый лист, источник данных диаграммы не меняется. Например, если источником данных диаграммы является =Лист1!$А$1:$В$4, то после копирования строк или диапазона на новый лист источник данных останется прежним, т.е. =Лист1!$А$1:$В$4. Он по-прежнему относится к старому рабочему листу, т.е. Sheet1. Это также поведение Microsoft Excel. Но если вы хотите, чтобы он ссылался на новый рабочий лист назначения, используйте свойство CopyOptions.ReferToDestinationSheet и установите для него значение true при вызове метода Cells.CopyRows(). Теперь, если целевым рабочим листом является DestSheet, источник данных вашей диаграммы изменится с =Sheet1!$A$1:$B$4 на =DestSheet!$A$1:$B$4.
## **Измените источник данных диаграммы на рабочий лист назначения при копировании строк или диапазона**
В следующем примере кода объясняется использование свойства CopyOptions.ReferToDestinationSheet при копировании строк или диапазонов, содержащих диаграмму, на новый лист. В коде используется[образец эксель файла](5472284.xlsx) и генерирует[выходной файл excel](5472283.xlsx) . На снимке экрана показано, что источник данных диаграммы в[выходной файл excel](5472283.xlsx) теперь относится к DestSheet вместо Sheet1.

![дело:изображение_альтернативный_текст](change-data-source-of-the-chart_1.png)







{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-ChangeDataSource-ChangeDataSource.java" >}}






