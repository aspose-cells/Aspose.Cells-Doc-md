---
title: Управление элементами управления
type: docs
weight: 120
url: /ru/java/managing-controls/
---

## **Введение**

Разработчики могут добавлять различные графические объекты, такие как текстовые поля, флажки, переключатели, комбинированные поля выбора, ярлыки, кнопки, линии, прямоугольники, дуги, овалы, спиннеры, полосы прокрутки, групповые рамки и т. д. Aspose.Cells предоставляет пространство имен Aspose.Cells.Drawing, которое содержит все графические объекты. Однако есть несколько графических объектов или форм, которые пока не поддерживаются. Создайте эти графические объекты в электронной таблице дизайнера с помощью Microsoft Excel, а затем импортируйте электронную таблицу дизайнера в Aspose.Cells. Aspose.Cells позволяет загружать эти графические объекты из электронной таблицы дизайнера и записывать их в созданный файл.

## **Добавление элемента управления текстовым полем на листе**

Один из способов выделить важную информацию в отчете - использовать текстовое поле. Например, добавьте текст для выделения названия компании или для обозначения географического региона с наивысшими продажами и т. д. Aspose.Cells предоставляет класс TextBoxes, используемый для добавления нового текстового поля в коллекцию. Есть еще один класс, [**TextBox**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox), который представляет текстовое поле для определения всех типов настроек. У него есть несколько важных членов:

- Метод [**getTextFrame**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#TextFrame) возвращает объект [**MsoTextFrame**](https://reference.aspose.com/cells/java/com.aspose.cells/MsoTextFrame), используемый для корректировки содержимого текстового поля.
- Метод [**setPlacement**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#Placement) указывает тип размещения.
- Метод [**setFont**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#Font) указывает атрибуты шрифта.
- Метод [**addHyperlink**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#addHyperlink-java.lang.String-) добавляет гиперссылку для текстового поля.
- Свойство [**FillFormat**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#FillFormat) возвращает объект [**MsoFillFormat**](https://reference.aspose.com/cells/java/com.aspose.cells/MsoFillFormat), используемый для установки формата заливки для текстового поля.
- Свойство [**LineFormat**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#LineFormat) возвращает объект [**MsoLineFormat**](https://reference.aspose.com/cells/java/com.aspose.cells/MsoLineFormat), обычно используемый для стиля и толщины линии текстового поля.
- Метод [**setText**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#Text) устанавливает входной текст для текстового поля.

В следующем примере создаются два текстовых поля на первом листе книги. Первое текстовое поле хорошо оборудовано различными настройками формата. Второе является простым.

Следующий вывод генерируется выполнением кода:

**На рабочем листе создано два текстовых поля** 

![todo:image_alt_text](managing-controls_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingTextBoxControl-1.java" >}}

## **Управление элементами управления текстовыми полями в дизайнерских электронных таблицах**

Aspose.Cells также позволяет вам получать доступ к текстовым полям в электронных таблицах дизайнера и манипулировать ими. Используйте свойство [**Worksheet.getTextBoxes**](https://reference.aspose.com/cells/java/com.aspose.cells/worksheet#TextBoxes), чтобы получить коллекцию текстовых полей на листе.

В следующем примере используется файл Microsoft Excel – tsttextboxes.xls – который мы создали в вышеприведенном примере. Он получает текстовые строки двух текстовых полей и изменяет текст второго текстового поля для сохранения файла.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-ManipulatingTextBoxControls-1.java" >}}

## **Добавление элемента управления флажком в рабочий лист**

Флажки удобны, если вы хотите предоставить пользователю возможность выбрать между двумя вариантами, например, true или false; да или нет. Aspose.Cells позволяет использовать флажки на листах. Например, вы можете создать рабочую книгу с финансовым прогнозом, в которой нужно учесть определенное приобретение или нет. В этом случае вы можете разместить флажок наверху листа. Затем вы можете связать состояние этого флажка с другой ячейкой, чтобы, если флажок выбран, значение ячейки будет True; если он не выбран, значение ячейки будет False.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления флажком на вашем листе, выполните следующие шаги:

1. Убедитесь, что отображается панель инструментов Формы.
1. Нажмите на инструмент **Флажок** на панели инструментов Формы.
1. В области вашего листа нажмите и перетащите, чтобы определить прямоугольник, в котором будет размещен флажок и метка рядом с флажком.
1. После размещения флажка перейдите курсором мыши в область метки и измените метку.
1. В поле Cell Link укажите адрес ячейки, к которой должен быть привязан этот флажок.
1. Нажмите на **ОК**.

### **Использование Aspose.Cells**

Aspose.Cells предоставляет класс [**CheckBoxCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/checkboxcollection), который используется для добавления нового флажка в коллекцию. Еще один класс, [**Aspose.Cells.Drawing.CheckBox**](https://reference.aspose.com/cells/java/com.aspose.cells/CheckBox), представляет флажок. Он имеет некоторые важные члены:

- Метод [**setLinkedCell**](https://reference.aspose.com/cells/java/com.aspose.cells/checkbox#LinkedCell) устанавливает ячейку, к которой связан флажок.
- Метод [**setText**](https://reference.aspose.com/cells/java/com.aspose.cells/checkbox#Text) устанавливает текстовую строку, связанную с флажком. Это метка флажка.
- Метод [**setValue**](https://reference.aspose.com/cells/java/com.aspose.cells/checkbox#Value) указывает, установлен ли флажок или нет.

Далее приведен пример того, как добавить флажок на лист. Результат ниже генерируется после выполнения кода.

**На листе добавлен флажок** 

![todo:image_alt_text](managing-controls_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingCheckBoxControl-1.java" >}}

## **Добавление элемента управления радиокнопкой на лист**

Кнопка радио или кнопка опции — это элемент управления в форме круглого фрагмента, пользователь принимает решение, выбирая круглый фрагмент. Кнопка радио обычно, если не всегда, сопровождается другими. Такие кнопки радио отображаются и действуют как группа. Пользователь определяет, какая кнопка является действительной, выбирая только одну из них. При выборе одной кнопки она заполняется. Когда выбрана одна кнопка из группы, кнопки той же группы остаются пустыми.

### **Использование Microsoft Excel**

Для размещения элемента управления кнопкой радио на листе выполните следующие шаги:

1. Убедитесь, что панель **Формы** отображается.
1. Нажмите инструмент **Кнопка опции**.
1. На листе щелкните и перетащите для определения прямоугольника, который будет содержать кнопку опции и метку рядом с кнопкой опции.
1. После размещения кнопки радио на листе перейдите курсором мыши в область метки и измените метку.
1. В поле Cell Link укажите адрес ячейки, к которой должна быть привязана эта кнопка радио.
1. Нажмите **ОК**.

### **Использование Aspose.Cells**

Класс [**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) предоставляет метод с именем addShape, который может использоваться для добавления элемента управления радиокнопкой на лист. Метод может вернуть объект RadioButton. Класс RadioButton представляет элемент управления опцией. Он имеет некоторые важные члены:

- Метод setLinkedCell указывает ячейку, которая связана с радиокнопкой.
- Метод setText указывает текстовую строку, связанную с радиокнопкой. Это подпись радиокнопки.
- Свойство Checked указывает, установлена ли радиокнопка или нет.
- Метод setFillFormat указывает формат заливки радиокнопки.
- Метод setLineFormat указывает стили формата линии элемента управления опцией.

Далее приведен пример того, как добавить радиокнопки на лист. В примере добавляются три радиокнопки, представляющие возрастные группы. Результат, приведенный ниже, будет получен после выполнения кода.

**На листе добавлены некоторые радиокнопки** 

![todo:image_alt_text](managing-controls_3.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingRadioButtonControl-1.java" >}}

## **Добавление элемента управления 'Комбинированный список' на рабочий лист**

Для упрощения ввода данных или ограничения ввода определенных элементов, можно создать комбинированный список или раскрывающийся список допустимых записей, которые собраны из ячеек в другом месте рабочего листа. Когда вы создаете раскрывающийся список для ячейки, рядом с этой ячейкой отображается стрелка. Чтобы ввести информацию в эту ячейку, щелкните стрелку, а затем щелкните нужную запись.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления 'Комбинированный список' на рабочем листе, выполните следующие шаги:

1. Убедитесь, что панель **Формы** отображается.
1. Щелкните инструмент **Комбинированный список**.
1. В области рабочего листа нажмите и перетащите, чтобы определить прямоугольник, который будет содержать комбинированный список.
1. Как только комбинированный список размещен на рабочем листе, щелкните правой кнопкой мыши по элементу управления и выберите **Формат элемента управления**, чтобы указать диапазон ввода.
1. В поле **Связь с ячейкой** укажите адрес ячейки, к которой должен быть привязан этот комбинированный список.
1. Нажмите на **ОК**.

### **Использование Aspose.Cells**

Класс [**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) предоставляет метод с именем addShape, который можно использовать для добавления элемента управления комбинированным списком на лист. Метод может возвращать объект ComboBox. Класс ComboBox представляет комбинированный список. В нем есть несколько важных членов:

- Метод setLinkedCell задает ячейку, которая связана с комбинированным списком.
- Метод setInputRange указывает диапазон ячеек на листе, используемых для заполнения комбинированного списка.
- Метод setDropDownLines указывает количество отображаемых строк списка в выпадающей части комбинированного списка.
- Метод setShadow указывает, имеет ли комбинированный список трехмерное затенение.

В следующем примере показано, как добавить комбинированный список на лист. При выполнении кода генерируется следующий вывод.

**На листе добавлен комбинированный список** 

![todo:image_alt_text](managing-controls_4.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingComboBoxControl-1.java" >}}

## **Добавление элемента управления 'Метка' на рабочий лист**

Метки - это средство предоставления пользователям информации о содержании электронных таблиц. Aspose.Cells позволяет добавлять и управлять метками на листе. Класс [**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) предоставляет метод с именем addShape, используемый для добавления элемента управления меткой на лист. Метод возвращает объект Label. Класс Label представляет метку на листе. У него есть несколько важных членов:

- Метод setText задает подпись метки.
- Метод setPlacement указывает тип расположения, способ, которым метка прикреплена к ячейкам на листе.

В следующем примере показано, как добавить метку на лист. При выполнении кода генерируется следующий вывод.

**Метка добавлена на листе**

![todo:image_alt_text](managing-controls_5.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingLabelControl-1.java" >}}

## **Добавление элемента управления список на листе**

Элемен управления список создает элемент управления, который позволяет выбирать один или несколько элементов.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления список на листе:

1. Убедитесь, что панель **Формы** отображается.
1. Нажмите кнопку **Элемент управления список**.
1. В области вашего листа щелкните и перетащите, чтобы определить прямоугольник, который будет содержать список.
1. Как только элемент управления списка размещен на листе, щелкните правой кнопкой мыши на элементе управления и щелкните **Форматировать элемент управления**, чтобы указать диапазон ввода.
1. В поле **Связь с ячейкой** укажите адрес ячейки, с которой должен быть связан этот список, и установите атрибут типа выбора (Одиночный, Множественный, Расширенный)
1. Нажмите **ОК**.

### **Использование Aspose.Cells**

Класс [**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) предоставляет метод с именем addShape, который используется для добавления элемента управления списка на лист. Метод возвращает объект ListBox. Класс ListBox представляет список. У него есть несколько важных членов:

- Метод setLinkedCell указывает на связанную с списком ячейку.
- Метод setInputRange указывает диапазон ячеек на листе, используемый для заполнения списка.
- Метод setSelectionType указывает режим выбора списка.
- Метод setShadow указывает, имеет ли список трехмерную тень.

Приведенный ниже пример показывает, как добавить список на лист. При выполнении кода генерируется следующий результат.

**Список добавлен на лист** 

![todo:image_alt_text](managing-controls_6.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingListBoxControl-1.java" >}}

## **Добавление элемента управления кнопка на лист**

Кнопки полезны для выполнения некоторых действий. Иногда полезно назначить макрос VBA на кнопку или назначить гиперссылку для открытия веб-страницы.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления кнопка на вашем листе:

1. Убедитесь, что панель **Формы** отображается.
1. Щелкните инструмент **Кнопка**.
1. В области вашего листа щелкните и перетащите для определения прямоугольника, который будет содержать кнопку.
1. Как только список размещен на листе, щелкните правой кнопкой мыши на элементе управления и выберите **Формат управления**, затем укажите VBA-макрос и атрибуты, касающиеся шрифта, выравнивания, размера, полей и т. д.
1. Нажмите на **ОК**.

### **Использование Aspose.Cells**

[**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) класс предоставляет метод с именем addShape, используемый для добавления элемента управления кнопкой на рабочий лист. Метод может вернуть объект кнопки. Класс Button представляет кнопку. Он имеет несколько важных членов:

- Метод setText указывает заголовок кнопки.
- Метод setPlacement указывает тип размещения, способ, которым кнопка прикреплена к ячейкам на рабочем листе.
- Метод addHyperlink добавляет гиперссылку для элемента управления кнопкой. При нажатии на кнопку будет осуществлен переход по связанному URL.

В следующем примере показано, как добавить кнопку на рабочий лист. Ниже приведен результат выполнения кода:

**Кнопка добавлена в рабочий лист**

![todo:image_alt_text](managing-controls_7.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingButtonControl-1.java" >}}

## **Добавление линейного элемента управления на рабочий лист**

Aspose.Cells позволяет рисовать автофигуры на рабочих листах. Вы можете легко создать линию. Также вы можете форматировать линию. Например, вы можете изменить цвет линии, указать толщину и стиль линии по вашему усмотрению.

### **Использование Microsoft Excel**

1. На панели инструментов **Рисование** щелкните **Автофигуры**, наведите указатель на **Линии** и выберите стиль линии.
1. Перетащите для создания линии.
1. Выполните одно или оба из следующего:
   1. Для ограничения углов рисования линии под углом 15 градусов от начальной точки удерживайте клавишу SHIFT при перетаскивании.
   1. Чтобы удлинить линию в противоположных направлениях от первой конечной точки, удерживайте клавишу CTRL при перетаскивании.

### **Использование Aspose.Cells**

[**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) класс предоставляет метод с именем addShape, который используется для добавления формы линии на рабочий лист. Метод может вернуть объект LineShape. Класс LineShape представляет линию. Он имеет несколько важных членов:

- Метод setDashStyle указывает формат линии.
- Метод setPlacement указывает тип размещения, способ, которым линия прикреплена к ячейкам на рабочем листе.

Приведенный пример показывает, как добавить линии на рабочий лист. Создаются три линии с различными стилями. Следующий вывод генерируется после выполнения кода

**На рабочий лист добавлены несколько линий** 

![todo:image_alt_text](managing-controls_8.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingLineControl-1.java" >}}

### **Добавление стрелочки к линии**

Aspose.Cells также позволяет вам рисовать стрелки. Возможно добавление стрелки к линии и форматирование линии. Например, вы можете изменить цвет линии или указать ее толщину и стиль.

Приведенный пример показывает, как добавить стрелочку к линии. Следующий вывод генерируется при выполнении кода.

**На рабочий лист добавлена линия с стрелочкой** 

![todo:image_alt_text](managing-controls_9.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddinganArrowHead.java" >}}

## **Добавление прямоугольного контроля на лист**

Aspose.Cells позволяет вам рисовать прямоугольные формы в ваших листах. Вы можете создать прямоугольник, квадрат и т. д. Вы также можете форматировать цвет заливки и цвет граничной линии контроля. Например, вы можете изменить цвет прямоугольника, задать цвет заливки, указать толщину и стиль прямоугольника по вашему усмотрению.

### **Использование Microsoft Excel**

1. На панели **Рисование** щелкните **Прямоугольник**.
1. Перетащите, чтобы нарисовать прямоугольник.
1. Выполните одно или оба из следующего:
   1. Чтобы ограничить прямоугольник и нарисовать квадрат от его начальной точки, удерживайте клавишу SHIFT во время перетаскивания.
   1. Чтобы нарисовать прямоугольник из центральной точки, удерживайте клавишу CTRL во время перетаскивания.

### **Использование Aspose.Cells**

Класс [**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) предоставляет метод addShape, который используется для добавления прямоугольной формы на рабочий лист. Метод может возвращать объект RectangleShape. Класс RectangleShape представляет собой прямоугольник. У него есть несколько важных членов:

- Метод setLineFormat указывает атрибуты формата линии прямоугольника.
- Метод setPlacement указывает тип размещения, способ, которым прямоугольник прикреплен к ячейкам на рабочем листе.
- Свойство FillFormat указывает стили формата заливки прямоугольника.

Приведенный пример показывает, как добавить прямоугольник на рабочий лист. Следующий вывод генерируется при выполнении кода.

**На рабочий лист добавлен прямоугольник** 

![todo:image_alt_text](managing-controls_10.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingRectangleControl-1.java" >}}

## **Добавление дугового контроля на лист**

Aspose.Cells позволяет вам рисовать дуговые формы на ваших листах. Вы можете создавать простые и заполненные дуги. Вы можете форматировать цвет заливки и цвет граничной линии контроля. Например, вы можете указать / изменить цвет дуги, установить цвет заливки, указать толщину и стиль формы по вашему усмотрению.

### **Использование Microsoft Excel**

1. На панели **Рисование** щелкните **Дуга** в **Автофигуры**.
1. Перетащите, чтобы нарисовать дугу.

### **Использование Aspose.Cells**

Класс [**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) предоставляет метод с именем addShape, который используется для добавления дуговой формы на лист. Метод может возвращать объект ArcShape. Класс ArcShape представляет собой дугу. У него есть несколько важных членов:

- Метод setLineFormat указывает атрибуты формата линии дуговой формы.
- Метод setPlacement указывает тип размещения, способ, которым дуга привязана к ячейкам на листе.
- Cвойство FillFormat указывает стили формата заливки для формы.

Приведенный ниже пример показывает, как добавить дуговые формы на лист. Пример создает две дуговые формы: одна закрашена, а другая - простая. Следующий вывод генерируется при выполнении кода

**На лист добавлены две дуговые формы** 

![todo:image_alt_text](managing-controls_11.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingArcControl-1.java" >}}

## **Добавление овального элемента управления на лист**

Aspose.Cells позволяет вам рисовать овальные формы на листах. Создайте простые и закрашенные овальные формы и отформатируйте цвет заливки и цвет граничной линии элемента управления. Например, вы можете указать / изменить цвет овала, установить цвет закрашивания, указать вес и стиль формы.

### **Использование Microsoft Excel**

1. На панели инструментов **Рисование** щелкните **Овал**.
1. Перетащите, чтобы нарисовать овал.
1. Выполните одно или оба из следующего:
   1. Чтобы ограничить овал и нарисовать круг из его начальной точки, удерживайте клавишу SHIFT при перетаскивании.
   1. Чтобы нарисовать овал из центральной точки, удерживайте клавишу CTRL при перетаскивании.

### **Использование Aspose.Cells**

Класс [**ShapeCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) предоставляет метод с именем addShape, который используется для добавления овальной формы на лист. Метод может возвращать объект Oval. Класс Oval представляет овальную форму. У него есть несколько важных членов:

- Метод setLineFormat указывает атрибуты формата линии овальной формы.
- Метод setPlacement указывает **PlacementType**, способ, которым овал привязан к ячейкам на листе.
- Cвойство FillFormat указывает стили формата заливки для формы.

Следующий пример показывает, как добавить овальные формы на лист. В примере создаются две овальные формы: одна заполненная, а вторая - просто круг. Пример кода генерирует следующий вывод.

**На лист добавлены две овальные формы** 

![todo:image_alt_text](managing-controls_12.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddinganOvalControl-1.java" >}}

## **Продвинутые темы**
- [Добавление элементов ActiveX в Aspose.Cells](/cells/ru/java/add-activex-controls-using-aspose-cells/)
- [Удалить элемент управления ActiveX](/cells/ru/java/remove-activex-control/)
{{< app/cells/assistant language="java" >}}
