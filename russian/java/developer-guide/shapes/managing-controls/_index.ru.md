---
title: Управление элементами управления
type: docs
weight: 120
url: /ru/java/managing-controls/
---
## **Введение**

Разработчики могут добавлять различные объекты рисования, такие как текстовые поля, флажки, переключатели, поля со списком, метки, кнопки, линии, прямоугольники, дуги, овалы, счетчики, полосы прокрутки, групповые поля и т. д. Aspose.Cells предоставляет пространство имен Aspose.Cells.Drawing, которое содержит все объекты рисования. Однако есть несколько объектов рисования или фигур, которые пока не поддерживаются. Создайте эти объекты чертежа в электронной таблице дизайнера с помощью Microsoft Excel, а затем импортируйте электронную таблицу дизайнера в Aspose.Cells. Aspose.Cells позволяет загружать эти объекты чертежа из электронной таблицы дизайнера и записывать их в сгенерированный файл.

## **Добавление элемента управления TextBox на рабочий лист**

Один из способов выделить важную информацию в отчете — использовать текстовое поле. Например, добавьте текст, чтобы выделить название компании или указать географический регион с самыми высокими продажами и т. д. Aspose.Cells предоставляет класс TextBoxes, используемый для добавления нового текстового поля в коллекцию. Есть еще класс,[**Текстовое окно**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox), который представляет собой текстовое поле, используемое для определения всех типов настроек. В него входят несколько важных членов:

- [**получитьтекстовый кадр**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#TextFrame) метод возвращает[**Мсотекстфрейм**](https://reference.aspose.com/cells/java/com.aspose.cells/MsoTextFrame) объект, используемый для настройки содержимого текстового поля.
- [**setPlacement**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#Placement) метод определяет тип размещения.
- [**установитьШрифт**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#Font) метод определяет атрибуты шрифта.
- [**добавить гиперссылку**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#addHyperlink(java.lang.String)) добавляет гиперссылку для текстового поля.
- [**ЗаполнитьФормат**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#FillFormat) недвижимость возвращается[**Мсофиллформат**](https://reference.aspose.com/cells/java/com.aspose.cells/MsoFillFormat) объект, используемый для установки формата заполнения для текстового поля.
- [**LineFormat**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#LineFormat) свойство возвращает[**Мсолинеформат**](https://reference.aspose.com/cells/java/com.aspose.cells/MsoLineFormat) объект, обычно используемый для стиля и веса строки текстового поля.
- [**setText**](https://reference.aspose.com/cells/java/com.aspose.cells/textbox#Text)метод задает вводимый текст для текстового поля.

В следующем примере создаются два текстовых поля на первом листе книги. Первое текстовое поле хорошо оснащено различными настройками формата. Второй — простой.

Следующий вывод генерируется при выполнении кода:

**На листе создаются два текстовых поля.** 

![дело:изображение_альтернативный_текст](managing-controls_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingTextBoxControl-1.java" >}}

## **Управление элементами управления текстовыми полями в электронных таблицах конструктора**

 Aspose.Cells также позволяет вам получать доступ к текстовым полям на листах конструктора и управлять ими. Использовать[**Рабочий лист.getTextBoxes**](https://reference.aspose.com/cells/java/com.aspose.cells/worksheet#TextBoxes) свойство, чтобы получить коллекцию текстовых полей на листе.

В следующем примере используется файл Excel Microsoft — tsttextboxes.xls, который мы создали в приведенном выше примере. Он получает текстовые строки двух текстовых полей и изменяет текст второго текстового поля, чтобы сохранить файл.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-ManipulatingTextBoxControls-1.java" >}}

## **Добавление элемента управления CheckBox на рабочий лист**

Флажки удобны, если вы хотите предоставить пользователю возможность выбора между двумя вариантами, например, true или false; Да или нет. Aspose.Cells позволяет использовать флажки на листах. Например, вы, возможно, разработали рабочий лист финансового прогноза, в котором вы можете либо учитывать конкретное приобретение, либо нет. В этом случае вы можете установить флажок в верхней части рабочего листа. Затем вы можете связать состояние этого флажка с другой ячейкой, чтобы, если флажок установлен, значением ячейки было True; если он не выбран, значение ячейки равно False.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления флажком на листе, выполните следующие действия.

1. Убедитесь, что панель инструментов «Формы» отображается.
1.  Нажмите на**Флажок** на панели инструментов «Формы».
1. В области рабочего листа щелкните и перетащите, чтобы определить прямоугольник, который будет содержать флажок и метку рядом с флажком.
1. После установки флажка переместите курсор мыши в область метки и измените метку.
1.  в**Cell Ссылка**поле укажите адрес ячейки, к которой должен быть привязан этот флажок.
1.  Нажмите на**ХОРОШО**.

### **Использование Aspose.Cells**

 Aspose.Cells обеспечивает[**CheckBoxCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/checkboxcollection) класс, который используется для добавления нового флажка в коллекцию. Есть еще класс,[**Aspose.Cells.Drawing.CheckBox**](https://reference.aspose.com/cells/java/com.aspose.cells/CheckBox), который представляет собой флажок. В него входят несколько важных членов:

- [**setLinkedCell**](https://reference.aspose.com/cells/java/com.aspose.cells/checkbox#LinkedCell) метод указывает ячейку, которая связана с флажком.
- [**setText**](https://reference.aspose.com/cells/java/com.aspose.cells/checkbox#Text) Метод указывает текстовую строку, связанную с флажком. Это метка флажка.
- [**установить значение**](https://reference.aspose.com/cells/java/com.aspose.cells/checkbox#Value) метод указывает, установлен ли флажок или нет.

В следующем примере показано, как добавить флажок на лист. Вывод ниже генерируется после выполнения кода.

**CheckBox добавляется на лист** 

![дело:изображение_альтернативный_текст](managing-controls_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingCheckBoxControl-1.java" >}}

## **Добавление элемента управления RadioButton на рабочий лист**

Радиокнопка или опциональная кнопка — это элемент управления, состоящий из круглого прямоугольника. Пользователь принимает решение, выбирая круглое поле. Радиокнопка обычно, если не всегда, сопровождается другими. Такие переключатели отображаются и ведут себя как группа. Пользователь решает, какая кнопка действительна, выбирая только одну из них. Когда пользователь нажимает одну кнопку, она заполняется. Когда выбрана одна кнопка в группе, кнопки той же группы пусты.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления Radio Button на листе, выполните следующие действия.

1.  Убедитесь, что**Формы** отображается панель инструментов.
1.  Нажмите на**Кнопка выбора** инструмент.
1. На рабочем листе щелкните и перетащите, чтобы определить прямоугольник, который будет содержать кнопку выбора и метку рядом с кнопкой выбора.
1. Как только переключатель будет помещен на рабочий лист, переместите курсор мыши в область метки и измените метку.
1.  в**Cell Ссылка** поле укажите адрес ячейки, к которой должна быть привязана данная радиокнопка.
1.  Нажмите**ХОРОШО**.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection)Класс предоставляет метод с именем addShape, который можно использовать для добавления переключателя на рабочий лист. Метод может возвращать объект RadioButton. Класс RadioButton представляет кнопку выбора. В него входят несколько важных членов:

- Метод setLinkedCell указывает ячейку, которая связана с переключателем.
- Метод setText указывает текстовую строку, связанную с переключателем. Это метка переключателя.
- Свойство Checked указывает, установлен ли переключатель или нет.
- Метод setFillFormat указывает формат заполнения переключателя.
- Метод setLineFormat задает стили формата строки переключателя.

В следующем примере показано, как добавить переключатели на лист. В примере добавлены три переключателя, представляющие возрастные группы. После выполнения кода будет сгенерирован следующий вывод.

**Некоторые RadioButtons добавлены на рабочий лист** 

![дело:изображение_альтернативный_текст](managing-controls_3.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingRadioButtonControl-1.java" >}}

## **Добавление элемента управления Combo Box на рабочий лист**

Чтобы упростить ввод данных или ограничить записи определенными элементами, которые вы определяете, вы можете создать поле со списком или раскрывающийся список допустимых записей, который скомпилирован из ячеек в другом месте на рабочем листе. Когда вы создаете раскрывающийся список для ячейки, он отображает стрелку рядом с этой ячейкой. Чтобы ввести информацию в эту ячейку, щелкните стрелку и выберите нужную запись.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления полем со списком на листе, выполните следующие действия.

1.  Убедитесь, что**Формы** отображается панель инструментов.
1.  Нажми на**Поле со списком** инструмент.
1. В области рабочего листа щелкните и перетащите, чтобы определить прямоугольник, который будет содержать поле со списком.
1.  Как только поле со списком будет помещено на рабочий лист, щелкните правой кнопкой мыши элемент управления, чтобы щелкнуть**Управление форматом** и укажите диапазон ввода.
1.  в**Cell Ссылка** поле укажите адрес ячейки, к которой должен быть привязан этот выпадающий список.
1.  Нажмите на**ХОРОШО**.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection)Класс предоставляет метод с именем addShape, который можно использовать для добавления элемента управления полем со списком на рабочий лист. Метод может возвращать объект ComboBox. Класс ComboBox представляет поле со списком. В него входят несколько важных членов:

- Метод setLinkedCell указывает ячейку, которая связана с полем со списком.
- Метод setInputRange указывает диапазон ячеек рабочего листа, используемый для заполнения поля со списком.
- Метод setDropDownLines указывает количество строк списка, отображаемых в раскрывающейся части поля со списком.
- Метод setShadow указывает, имеет ли поле со списком трехмерное затенение.

В следующем примере показано, как добавить поле со списком на лист. При выполнении кода генерируется следующий вывод.

**Поле со списком добавляется на лист** 

![дело:изображение_альтернативный_текст](managing-controls_4.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingComboBoxControl-1.java" >}}

## **Добавление элемента управления метками на рабочий лист**

 Метки — это средство предоставления пользователям информации о содержимом электронной таблицы. Aspose.Cells позволяет добавлять метки и управлять ими на листе.[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection)Класс предоставляет метод с именем addShape, используемый для добавления элемента управления меткой на рабочий лист. Метод возвращает объект Label. Класс Label представляет собой метку на рабочем листе. В него входят несколько важных членов:

- Метод setText указывает строку заголовка метки.
- Метод setPlacement указывает PlacementType, способ прикрепления метки к ячейкам на листе.

В следующем примере показано, как добавить метку на лист. При выполнении кода генерируется следующий вывод.

**Метка добавляется на лист**

![дело:изображение_альтернативный_текст](managing-controls_5.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingLabelControl-1.java" >}}

## **Добавление элемента управления «Список» на рабочий лист**

Элемент управления "список" создает элемент управления "список", который позволяет выбирать один или несколько элементов.

### **Использование Microsoft Excel**

Чтобы разместить элемент управления списком на листе:

1.  Убедитесь, что**Формы** отображается панель инструментов.
1.  Нажми на**Список** инструмент.
1. В области рабочего листа щелкните и перетащите, чтобы определить прямоугольник, который будет содержать поле со списком.
1.  После того, как поле списка будет помещено на лист, щелкните правой кнопкой мыши элемент управления, чтобы щелкнуть**Управление форматом** и укажите диапазон ввода.
1.  в**Cell Ссылка**поле, укажите адрес ячейки, к которой этот список должен быть привязан, и установите атрибут типа выбора (Одиночный, Несколько, Расширить)
1.  Нажмите**ХОРОШО**.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) Класс предоставляет метод с именем addShape, который используется для добавления элемента управления списком на рабочий лист. Метод возвращает объект ListBox. Класс ListBox представляет собой список. В него входят несколько важных членов:

- Метод setLinkedCell указывает ячейку, которая связана со списком.
- Метод setInputRange указывает диапазон ячеек рабочего листа, используемый для заполнения списка.
- Метод setSelectionType указывает режим выбора списка.
- Метод setShadow указывает, имеет ли поле списка трехмерное затенение.

В следующем примере показано, как добавить список на лист. При выполнении кода генерируется следующий вывод.

**Список добавляется на лист** 

![дело:изображение_альтернативный_текст](managing-controls_6.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingListBoxControl-1.java" >}}

## **Добавление элемента управления «Кнопка» на рабочий лист**

Кнопки полезны для выполнения некоторых действий. Иногда полезно назначить макрос VBA для кнопки или назначить гиперссылку для открытия веб-страницы.

### **Использование Microsoft Excel**

Чтобы поместить элемент управления «Кнопка» на лист:

1.  Убедитесь, что**Формы** отображается панель инструментов.
1.  Нажми на**Кнопка** инструмент.
1. В области рабочего листа щелкните и перетащите, чтобы определить прямоугольник, который будет удерживать кнопку.
1.  Как только поле со списком будет помещено на лист, щелкните правой кнопкой мыши элемент управления и выберите**Управление форматом**, затем укажите макрос VBA и атрибуты, относящиеся к шрифту, выравниванию, размеру, полям и т. д.
1.  Нажмите на**ХОРОШО**.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) Класс предоставляет метод с именем addShape, используемый для добавления элемента управления «кнопка» на рабочий лист. Метод может возвращать объект Button. Класс Button представляет кнопку. В него входят несколько важных членов:

- Метод setText указывает заголовок кнопки.
- Метод setPlacement указывает PlacementType, способ прикрепления кнопки к ячейкам на листе.
- Метод addHyperlink добавляет гиперссылку для кнопки. Нажав на кнопку, вы перейдете к соответствующему URL-адресу.

В следующем примере показано, как добавить кнопку на лист. Следующий вывод генерируется при выполнении кода

**Кнопка добавлена на лист**

![дело:изображение_альтернативный_текст](managing-controls_7.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingButtonControl-1.java" >}}

## **Добавление элемента управления линией на рабочий лист**

Aspose.Cells позволяет рисовать автофигуры на рабочих листах. Вы можете легко создать линию. Вы также можете отформатировать строку. Например, вы можете изменить цвет линии, указать толщину и стиль линии для ваших нужд.

### **Использование Microsoft Excel**

1.  На**Рисунок** панель инструментов, нажмите**Автофигуры** , указать на**Линии**и выберите нужный стиль линии.
1. Перетащите, чтобы нарисовать линию.
1. Выполните одно или оба из следующих действий:
 1. Чтобы линия рисовалась под углом 15 градусов от начальной точки, удерживайте нажатой клавишу SHIFT при перетаскивании.
 1. Чтобы удлинить линию в противоположных направлениях от первой конечной точки, удерживайте нажатой клавишу CTRL при перетаскивании.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection)Класс предоставляет метод с именем addShape, который используется для добавления формы линии на рабочий лист. Метод может возвращать объект LineShape. Класс LineShape представляет линию. В него входят несколько важных членов:

- Метод setDashStyle определяет формат строки.
- Метод setPlacement указывает PlacementType, способ прикрепления строки к ячейкам на листе.

В следующем примере показано, как добавить строки на лист. Он создает три линии с разными стилями. Следующий вывод генерируется после выполнения кода

**В рабочий лист добавлено несколько строк** 

![дело:изображение_альтернативный_текст](managing-controls_8.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingLineControl-1.java" >}}

### **Добавление стрелки к линии**

Aspose.Cells также позволяет рисовать линии со стрелками. К строке можно добавить стрелку и отформатировать строку. Например, вы можете изменить цвет линии или указать толщину и стиль линии.

В следующем примере показано, как добавить стрелку к линии. При выполнении кода генерируется следующий вывод.

**На листе добавляется строка со стрелкой** 

![дело:изображение_альтернативный_текст](managing-controls_9.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddinganArrowHead.java" >}}

## **Добавление элемента управления «Прямоугольник» на рабочий лист**

Aspose.Cells позволяет рисовать прямоугольные формы на ваших листах. Вы можете создать прямоугольник, квадрат и т. д. Вам также разрешено форматировать цвет заливки и цвет линии границы элемента управления. Например, вы можете изменить цвет прямоугольника, установить цвет заливки, указать вес и стиль прямоугольника для ваших нужд.

### **Использование Microsoft Excel**

1.  На**Рисунок** панель инструментов, нажмите**Прямоугольник**.
1. Перетащите, чтобы нарисовать прямоугольник.
1. Выполните одно или оба из следующих действий:
 1. Чтобы заставить прямоугольник рисовать квадрат из начальной точки, удерживайте нажатой клавишу SHIFT при перетаскивании.
 1. Чтобы нарисовать прямоугольник из центральной точки, удерживайте нажатой клавишу CTRL при перетаскивании.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) Класс предоставляет метод с именем addShape, который используется для добавления прямоугольной формы на рабочий лист. Метод может возвращать объект RectangleShape. Класс RectangleShape представляет прямоугольник. В него входят несколько важных членов:

- Метод setLineFormat задает атрибуты формата линии прямоугольника.
- Метод setPlacement указывает PlacementType, способ прикрепления прямоугольника к ячейкам на листе.
- Свойство FillFormat указывает стили формата заливки прямоугольника.

В следующем примере показано, как добавить прямоугольник на лист. При выполнении кода генерируется следующий вывод.

**На рабочий лист добавляется прямоугольник** 

![дело:изображение_альтернативный_текст](managing-controls_10.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingRectangleControl-1.java" >}}

## **Добавление управления дугой на рабочий лист**

Aspose.Cells позволяет рисовать дуги на рабочих листах. Вы можете создавать простые и заполненные дуги. Вы можете форматировать цвет заливки и цвет границы элемента управления. Например, вы можете указать/изменить цвет дуги, установить цвет штриховки, указать вес и стиль формы для ваших нужд.

### **Использование Microsoft Excel**

1.  На**Рисунок** панель инструментов, нажмите**Дуга** в**Автофигуры**.
1. Перетащите, чтобы нарисовать дугу.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) Класс предоставляет метод с именем addShape, который используется для добавления формы дуги на рабочий лист. Метод может возвращать объект ArcShape. Класс ArcShape представляет дугу. В него входят несколько важных членов:

- Метод setLineFormat задает атрибуты формата линии дуги.
- Метод setPlacement указывает PlacementType, способ прикрепления дуги к ячейкам на листе.
- Свойство FillFormat указывает стили формата заливки фигуры.

В следующем примере показано, как добавить дуги на рабочий лист. В примере создаются две формы дуги: одна заполненная, а другая простая. Следующий вывод генерируется при выполнении кода

**На рабочий лист добавляются две дуги** 

![дело:изображение_альтернативный_текст](managing-controls_11.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddingArcControl-1.java" >}}

## **Добавление овального элемента управления на рабочий лист**

Aspose.Cells позволяет рисовать овалы на рабочих листах. Создавайте простые овальные формы с заливкой и форматируйте цвет заливки и цвет линии границы элемента управления. Например, вы можете указать/изменить цвет овала, задать цвет штриховки, указать вес и стиль фигуры.

### **Использование Microsoft Excel**

1.  На**Рисунок** панель инструментов, нажмите**Овал** .
1. Перетащите, чтобы нарисовать овал.
1. Выполните одно или оба из следующих действий:
 1. Чтобы заставить овал рисовать окружность из начальной точки, удерживайте нажатой клавишу SHIFT при перетаскивании.
1. Чтобы нарисовать овал из центральной точки, удерживайте нажатой клавишу CTRL при перетаскивании.

### **Использование Aspose.Cells**

[**Коллекция форм**](https://reference.aspose.com/cells/java/com.aspose.cells/shapecollection) Класс предоставляет метод с именем addShape, который используется для добавления овальной формы на лист. Метод может возвращать объект Oval. Класс Oval представляет овальную форму. В него входят несколько важных членов:

- Метод setLineFormat указывает атрибуты формата линии овальной формы.
-  Метод setPlacement указывает**Тип размещения** , способ прикрепления овала к ячейкам на рабочем листе.
- Свойство FillFormat указывает стили формата заливки фигуры.

В следующем примере показано, как добавить на лист овальные фигуры. В примере создаются две овальные формы: одна заполнена овалом, другая представляет собой простой круг. При выполнении кода генерируется следующий вывод.

**На рабочий лист добавлены две овальные формы.** 

![дело:изображение_альтернативный_текст](managing-controls_12.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-DrawingObjects-controls-AddinganOvalControl-1.java" >}}

## **Предварительные темы**
- [Добавьте элементы управления ActiveX, используя Aspose.Cells.](/cells/ru/java/add-activex-controls-using-aspose-cells/)
- [Удалить элемент управления ActiveX](/cells/ru/java/remove-activex-control/)
