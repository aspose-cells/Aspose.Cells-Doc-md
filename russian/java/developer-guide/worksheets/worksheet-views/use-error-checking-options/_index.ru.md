---
title: Используйте параметры проверки ошибок
type: docs
weight: 60
url: /ru/java/use-error-checking-options/
---
{{% alert color="primary" %}} 

Microsoft Excel позволяет пользователям определять параметры и правила проверки ошибок. Пользователи часто видят проверку ошибок при создании формул, небольшой треугольник в правом верхнем углу ячейки указывает на наличие проблемы с ячейкой. Excel предоставляет информацию, которая помогает пользователям устранять распространенные проблемы.

{{% /alert %}} 
## **Типы ошибок**
Ошибки, которые означают, что формула не может вернуть результат, например деление числа на ноль, требуют немедленного внимания, и в ячейке отображается значение ошибки. При нажатии на зеленый треугольник отображается восклицательный знак, при нажатии открывается список параметров.

Ошибка может быть устранена с помощью опций или проигнорирована. Игнорирование ошибки означает, что эта ошибка не появится при дальнейших проверках ошибок.

Aspose.Cells предоставляет функции проверки ошибок. Класс ErrorCheckOptions управляет различными типами проверок ошибок, например, числами, хранящимися в виде текста, ошибками вычисления формулы и ошибками проверки. Используйте перечисление ErrorCheckType, чтобы установить желаемую проверку ошибок.
## **Числа, сохраненные как текст**
Иногда числа могут быть отформатированы и сохранены в ячейках как текст. Это может вызвать проблемы с вычислениями или привести к запутанному порядку сортировки. Числа, отформатированные как текст, выравниваются по левому краю, а не по правому краю в ячейке. Если формула, которая должна выполнять математическую операцию над ячейками, не возвращает значение, проверьте выравнивание в ячейках, на которые ссылается формула — некоторые или все эти ячейки могут быть числами, отформатированными как текст.

Вы можете использовать параметры проверки ошибок, чтобы быстро преобразовать числа, сохраненные в виде текста, в действительные числа. В Microsoft Excel 2003:

1.  На**Инструменты** меню, нажмите**Опции**.
1. Выберите вкладку Проверка ошибок.
   **Число сохранено как текст** опция отмечена по умолчанию.
1. Отключите его.
 На рисунке ниже показано, как зеленый треугольник отображается для данных в MS Excel.

![дело:изображение_альтернативный_текст](use-error-checking-options_1.png)

 В следующем примере кода показано, как отключить числа, хранящиеся в качестве параметра проверки текстовых ошибок, для рабочего листа в файле шаблона XLS с помощью API-интерфейсов Aspose.Cells.

**Java**

{{< highlight "csharp" >}}

 //Create a workbook and opening a template spreadsheet

Workbook workbook = new Workbook("d:\\files\\Book1.xls");

//Get the first worksheet

Worksheet sheet = workbook.getWorksheets().get(0);

//Instantiate the error checking options

ErrorCheckOptionCollection opts = sheet.getErrorCheckOptions();

int index = opts.add();

ErrorCheckOption opt = opts.get(index);

//Disable the numbers stored as text option

opt.setErrorCheck(ErrorCheckType.TEXT_NUMBER, false);

//Set the range

opt.addRange(CellArea.createCellArea(0, 0, 65535, 255));

//Save the Excel file

workbook.save("d:\\files\\out_test.xls");



{{< /highlight >}}
