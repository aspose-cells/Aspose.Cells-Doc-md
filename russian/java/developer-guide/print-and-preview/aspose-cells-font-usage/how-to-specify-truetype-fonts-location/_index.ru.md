---
title: Как указать расположение шрифтов TrueType
type: docs
weight: 30
url: /ru/java/how-to-specify-truetype-fonts-location/
---
{{% alert color="primary" %}}

В этой статье описаны:

1. [Где Aspose.Cells API ищет шрифты TrueType](/cells/ru/java/how-to-specify-truetype-fonts-location/#where-asposecells-looks-for-truetype-fonts-on-windows).
1. [Как явно указать папки шрифтов TrueType для Aspose.Cells API](/cells/ru/java/how-to-specify-truetype-fonts-location/#how-to-explicitly-specify-a-font-folder).
1. [Как ограничить Aspose.Cells API для использования только одного местоположения шрифтов TrueType](/cells/ru/java/how-to-specify-truetype-fonts-location/#how-to-restrict-the-asposecells-to-use-only-one-font-folder).

{{% /alert %}}

## **Работа со шрифтами**

### **Где Aspose.Cells ищет шрифты TrueType на Windows**

 Aspose.Cells ищет шрифты в**Windows\Шрифты** папка. Этот параметр по умолчанию работает большую часть времени, поэтому указывайте свои собственные папки со шрифтами только в том случае, если вам это действительно нужно.

### **Где Aspose.Cells ищет шрифты TrueType в Linux**

По умолчанию Aspose.Cells API ищет шрифты во всех следующих местах, хотя разные дистрибутивы Linux хранят шрифты в разных папках.

1. /usr/доля/шрифты
1. /usr/местные/доля/шрифты

{{% alert color="primary" %}}

 Это поведение по умолчанию будет работать для большинства дистрибутивов Linux, но не гарантируется, что оно будет работать постоянно. Возможно, вам потребуется явно указать расположение шрифтов TrueType.

{{% /alert %}}

### **Как явно указать папку со шрифтами**

Aspose.Cells API-интерфейсы предоставили множество фабричных методов для класса FontConfigs для указания шрифтов или папок шрифтов, как описано ниже.

1. Метод setFontFolder принимает первый параметр типа String с расположением в каталоге шрифтов, тогда как второй параметр типа Boolean указывает Aspose.Cells AP на рекурсивный поиск в папках файлов шрифтов.
1. Метод setFontFolders принимает массив типа String, поэтому вы можете указать множество каталогов шрифтов, используя этот подход. Вы также можете указать AP Aspose.Cells для рекурсивного поиска в папках, указав true в качестве второго параметра.
1. Метод setFontSources принимает массив типа FontSourceBase, чтобы вы могли указать список местоположений отдельных шрифтов.

{{% alert color="primary" %}}

При указании папки со шрифтами любым из вышеперечисленных способов мы рекомендуем указывать расположение шрифта при запуске приложения, иначе вы можете получить плохо отформатированные результаты.

{{% /alert %}} {{% alert color="primary" %}}

Установка папки шрифтов с помощью любого из вышеперечисленных методов не гарантирует, что Aspose.Cells API не будет искать шрифты в местах по умолчанию, таких как системная папка шрифтов.

{{% /alert %}}

### **Как ограничить Aspose.Cells для использования только одной папки шрифтов**

 Начиная с Aspose.Cells for Java 8.1.0, установка аргументов JVM как**-DAspose.Cells.FontDirExc="ВашКаталогШрифта**гарантирует, что Aspose.Cells API будет использовать только указанное расположение шрифтов.

Установите указанные аргументы с помощью метода System.setProperty, как показано ниже.

{{< highlight "java" >}}

System.setProperty("Aspose.Cells.FontDirExc", "FontDirSet");

{{< /highlight >}}

{{% alert color="primary" %}}

Обратите внимание на следующее:

- Приведенный выше оператор должен быть в начале вашего приложения.
- Использование описанного выше подхода не требует установки каталога шрифтов с помощью любого из рассмотренных выше методов FontConfigs.
- Строка «FontDirSet» должна быть полным путем к папке, содержащей необходимые шрифты.

{{% /alert %}}
