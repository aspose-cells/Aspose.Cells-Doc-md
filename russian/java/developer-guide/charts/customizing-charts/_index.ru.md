---
title: Настройка диаграмм
type: docs
weight: 15
url: /ru/java/creating-and-customizing-charts/
---
## **Создание диаграмм**

С помощью Aspose.Cells можно добавлять различные диаграммы в электронные таблицы. Aspose.Cells предоставляет множество гибких объектов диаграмм. В этом разделе обсуждаются объекты диаграммы Aspose.Cells'.

### **Простое создание диаграммы**

Создать диаграмму с номером Aspose.Cells очень просто, используя следующие примеры кодов:

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-Java-Charts-ManipulateChart-HowToCreateColumnChart-1.java" >}}


### **Что нужно знать для создания диаграммы**

Перед созданием диаграмм важно понять некоторые основные понятия, которые будут полезны при создании диаграмм с помощью Aspose.Cells.

#### **Объекты диаграммы**

 Aspose.Cells предоставляет специальный набор классов, используемых для создания всех видов диаграмм. Эти классы используются для создания**графические объекты**, которые действуют как строительные блоки диаграммы. Объекты диаграммы перечислены ниже:

- [**Ось**](https://reference.aspose.com/cells/java/com.aspose.cells/Axis), ось диаграммы.
- [**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart), одна диаграмма Excel.
- [**ДиаграммаОбласть**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartArea), область диаграммы на листе.
- [**ДиаграммаДанныеТаблица**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartDataTable), таблица данных диаграммы.
- [**ДиаграммаКадр**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartFrame), объект кадра на диаграмме.
- [**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartPoint), одна точка в ряду на диаграмме.
- [**ChartPointCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartPointCollection), коллекция, содержащая все точки одной серии.
- [**ChartCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) , коллекция[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart)объекты.
-  DataLabels, DataLabels для указанного[**Серии**](https://reference.aspose.com/cells/java/com.aspose.cells/Series), [**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartPoint), [**линия тренда**](https://reference.aspose.com/cells/java/com.aspose.cells/Trendline), так далее.
- [**ЗаполнитьФормат**](https://reference.aspose.com/cells/java/com.aspose.cells/FillFormat), формат заливки для фигуры.
- [**Пол**](https://reference.aspose.com/cells/java/com.aspose.cells/Floor), пол трехмерной диаграммы.
- [**Легенда**](https://reference.aspose.com/cells/java/com.aspose.cells/Legend), легенда диаграммы.
- [**Линия**](https://reference.aspose.com/cells/java/com.aspose.cells/Line), линия графика.
- [**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection) , коллекция[**Серии**](https://reference.aspose.com/cells/java/com.aspose.cells/Series)объекты.
- [**Серии**](https://reference.aspose.com/cells/java/com.aspose.cells/Series), представляет один ряд данных на диаграмме.
- [**TickLabels**](https://reference.aspose.com/cells/java/com.aspose.cells/TickLabels), метки делений, связанные с делениями на оси диаграммы.
- [**Заголовок**](https://reference.aspose.com/cells/java/com.aspose.cells/Title), название диаграммы или оси.
- [**линия тренда**](https://reference.aspose.com/cells/java/com.aspose.cells/Trendline), линия тренда на графике.
- [**TrendlineКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/TrendlineCollection), набор всех объектов Trendline для указанного ряда данных.
- [**Стены**](https://reference.aspose.com/cells/java/com.aspose.cells/Walls), стены трехмерной диаграммы.

#### **Использование объектов диаграммы**

Как упоминалось выше, все объекты диаграммы являются экземплярами соответствующих классов и предоставляют определенные свойства и методы для выполнения определенных задач. Используйте объекты диаграммы для создания диаграмм.

Добавьте любой тип диаграммы на рабочий лист, используя[**ChartCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) коллекция. Каждый элемент в[**ChartCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) коллекция представляет собой[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart) объект. А[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart)Объект инкапсулирует все объекты диаграммы, необходимые для настройки внешнего вида диаграммы. В следующем разделе показано, как использовать несколько основных объектов диаграммы для создания простой диаграммы.

### **Создание простой диаграммы**

 С помощью Aspose.Cells можно создать множество различных типов диаграмм. Все стандартные диаграммы, поддерживаемые Aspose.Cells, предварительно определены в перечислении с именем[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType). Предустановленные типы диаграмм:

|**Типы диаграмм**|**Описание**|
|:- |:- |
|Столбец|Представляет кластеризованную столбчатую диаграмму|
|КолонкаС накоплением|Представляет столбчатую диаграмму с накоплением|
|Столбец100PercentStacked|Представляет столбчатую диаграмму с накоплением на 100 %|
|Column3DClustered|Представляет 3D кластеризованную столбчатую диаграмму|
|Столбец3DStacked|Представляет трехмерную столбчатую диаграмму с накоплением|
|Столбец3D100PercentStacked|Представляет трехмерную столбчатую диаграмму со 100% накоплением|
|Колонка3D|Представляет трехмерную столбчатую диаграмму|
|Бар|Представляет кластеризованную гистограмму|
|БарСложенный|Представляет столбчатую диаграмму с накоплением|
|Bar100PercentStacked|Представляет гистограмму со 100% накоплением|
|Bar3DCкластеризованный|Представляет трехмерную кластеризованную гистограмму|
|Bar3DStacked|Представляет трехмерную линейчатую диаграмму с накоплением|
|Bar3D100PercentStacked|Представляет трехмерную линейчатую диаграмму со 100% накоплением|
|Линия|Представляет линейную диаграмму|
|LineStacked|Представляет составную линейную диаграмму|
|Line100PercentStacked|Представляет 100% линейную диаграмму с накоплением|
|LineWithDataMarkers|Представляет линейную диаграмму с маркерами данных|
|LineStackedWithDataMarkers|Представляет составную линейную диаграмму с маркерами данных|
|Line100PercentStackedWithDataMarkers|Представляет линейную диаграмму с накоплением 100% с маркерами данных|
|Линия3D|Представляет трехмерную линейную диаграмму|
|пирог|Представляет круговую диаграмму|
|Пирог3D|Представляет трехмерную круговую диаграмму|
|пирог пирог|Представляет круговую диаграмму|
|ПирогВзорван|Представляет развернутую круговую диаграмму|
|Pie3DВзорван|Представляет трехмерную развернутую круговую диаграмму|
|Пиг-Бар|Представляет гистограмму круговой диаграммы|
|Разброс|Представляет точечную диаграмму|
|ScatterConnectedByCurvesWithDataMarker|Представляет точечную диаграмму, соединенную кривыми, с маркерами данных.|
|ScatterConnectedByCurvesWithoutDataMarker|Представляет точечную диаграмму, соединенную кривыми, без маркеров данных.|
|ScatterConnectedByLinesWithDataMarker|Представляет точечную диаграмму, соединенную линиями, с маркерами данных.|
|ScatterConnectedByLinesWithoutDataMarker|Представляет точечную диаграмму, соединенную линиями, без маркеров данных.|
|Область|Представляет диаграмму областей|
|ПлощадьСложенный|Представляет составную диаграмму с областями|
|Area100PercentStacked|Представляет 100% диаграмму областей с накоплением|
|Площадь3D|Представляет трехмерную диаграмму с областями|
|Площадь3DС накоплением|Представляет трехмерную диаграмму с накоплением областей|
|Area3D100PercentStacked|Представляет трехмерную диаграмму с областями со 100% накоплением|
|Пончик|Представляет кольцевую диаграмму|
|ПончикВзорван|Представляет развернутую кольцевую диаграмму|
|Радар|Представляет радарную диаграмму|
|Радарвисдатамаркерс|Представляет радарную диаграмму с маркерами данных|
|Радар заполнен|Представляет заполненную радиолокационную диаграмму|
|Поверхность3D|Представляет трехмерную поверхностную диаграмму|
|ПоверхностьКаркас3D|Представляет каркасную трехмерную поверхностную диаграмму.|
|ПоверхностьКонтур|Представляет контурную диаграмму|
|ПоверхностьКонтурКаркас|Представляет контурную диаграмму каркаса|
|Пузырь|Представляет пузырьковую диаграмму|
|Пузырь3D|Представляет трехмерную пузырьковую диаграмму|
|Цилиндр|Представляет цилиндрическую диаграмму|
|ЦилиндрСложенный|Представляет составную цилиндрическую диаграмму|
|Цилиндр100PercentStacked|Представляет 100%-ную цилиндрическую диаграмму с накоплением|
|ЦилиндрическийБар|Представляет собой цилиндрическую гистограмму.|
|ЦилиндрическийБарС накоплением|Представляет цилиндрическую гистограмму с накоплением|
|ЦилиндрическийBar100PercentStacked|Представляет цилиндрическую гистограмму со 100% накоплением|
|ЦилиндрическаяКолонка3D|Представляет трехмерную цилиндрическую столбчатую диаграмму|
|Конус|Представляет конусную диаграмму|
|КонусСложенный|Представляет составную конусную диаграмму|
|конус100процентов|Представляет конусную диаграмму со 100% накоплением|
|КоническийБар|Представляет коническую гистограмму|
|КоническийБарС накоплением|Представляет составную коническую гистограмму|
|ConicalBar100PercentStacked|Представляет 100%-ную коническую гистограмму с накоплением|
|КоническаяКолонна3D|Представляет трехмерную коническую столбчатую диаграмму|
|Пирамида|Представляет пирамидальную диаграмму|
|ПирамидаСложенный|Представляет пирамидальную диаграмму с накоплением|
|Пирамида100PercentStacked|Представляет 100% пирамидальную диаграмму с накоплением|
|ПирамидаБар|Представляет гистограмму пирамиды|
|ПирамидаБарС накоплением|Представляет гистограмму с накоплением пирамиды|
|PyramidBar100PercentStacked|Представляет гистограмму пирамидальной гистограммы со 100% накоплением|
|ПирамидаКолонка3D|Представляет гистограмму трехмерной пирамиды|
Чтобы создать диаграмму с помощью Aspose.Cells:

1.  Добавьте некоторые данные в ячейки листа с помощью[**Cell**](https://reference.aspose.com/cells/java/com.aspose.cells/Cell) объекты[**установить значение**](https://reference.aspose.com/cells/java/com.aspose.cells/cell#Value)метод.
 Это будет использоваться в качестве источника данных для диаграммы.
1.  Добавьте диаграмму на лист, вызвав метод[**ChartCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) коллекция[*добавлять*](https://reference.aspose.com/cells/java/com.aspose.cells/chartcollection#add(int,%20int,%20int,%20int,%20int) ), инкапсулированный в[**Рабочий лист**](https://reference.aspose.com/cells/java/com.aspose.cells/Worksheet)объект.
1.  Укажите тип диаграммы с помощью[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType)перечисление.
 Например, в примере используется[**ChartType.PYRAMID**](https://reference.aspose.com/cells/java/com.aspose.cells/charttype#PYRAMID)значение в качестве типа диаграммы.
1.  Доступ к новым[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart) объект из[**ChartCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection)коллекции, передав ее индекс.
1.  Используйте любой из объектов диаграммы, инкапсулированных в[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart)объект для управления диаграммой.
 В приведенном ниже примере используется[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection)объект диаграммы, чтобы указать источник данных диаграммы.

При добавлении исходных данных на диаграмму источником данных может быть диапазон ячеек (например, «A1:C3»), последовательность несмежных ячеек (например, «A1, A3, A5») или последовательность ячеек. значения (например, "1,2,3").

{{% alert color="primary" %}}

Когда вы назначаете диапазон ячеек в качестве источника данных, вы можете установить только диапазон от левого верхнего угла до правого нижнего. Например, «A1:C3» является допустимым, а «C3:A1» — недопустимым.

{{% /alert %}}

Эти общие шаги позволяют создавать диаграммы любого типа. Используйте разные объекты диаграмм для создания разных диаграмм.

При выполнении примера кода на рабочий лист добавляется пирамидальная диаграмма, как показано ниже.

**Пирамидальная диаграмма с ее источником данных**

![дело:изображение_альтернативный_текст](creating-and-customizing-charts_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-HowToCreatePyramidChart-HowToCreatePyramidChart.java" >}}

 Чтобы создать пузырьковую диаграмму,[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType)должен быть установлен на[**ChartType.BUBBLE**](https://reference.aspose.com/cells/java/com.aspose.cells/charttype#BUBBLE)и несколько дополнительных свойств, таких как BubbleSizes, Values и XValues, должны быть установлены соответствующим образом. После выполнения следующего кода на рабочий лист добавляется пузырьковая диаграмма, как показано ниже.

**Пузырьковая диаграмма с источником данных**

![дело:изображение_альтернативный_текст](creating-and-customizing-charts_2.jpg)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-HowToCreateBubbleChart-HowToCreateBubbleChart.java" >}}

#### **Линия с диаграммой маркеров данных**

Чтобы создать линию с диаграммой маркеров данных,[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType)должен быть установлен на[**ChartType.LINE_WITH_DATA_MARKERS**](https://reference.aspose.com/cells/java/com.aspose.cells/charttype#LINE_WITH_DATA_MARKERS) и несколько дополнительных свойств, таких как фоновая область, маркеры серии, значения и XValues, должны быть установлены соответствующим образом. После выполнения следующего кода на лист добавляется строка с диаграммой маркеров данных.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-AsposeCellsExamples-Charts-CreateLineWithDataMarkerChart-1.java" >}}

## **Создание пользовательских диаграмм**

До сих пор при обсуждении диаграмм мы рассматривали стандартные диаграммы со стандартными настройками форматирования. Мы только определяем источник данных, устанавливаем несколько свойств, и диаграмма создается с настройками формата по умолчанию. Но Aspose.Cells также поддерживает создание пользовательских диаграмм, что позволяет разработчикам создавать диаграммы с собственными настройками формата.

### **Создание пользовательских диаграмм**

Разработчики могут создавать собственные диаграммы во время выполнения, используя Aspose.Cells простой API.

 Диаграмма состоит из ряда данных. Каждый ряд данных в Aspose.Cells представлен[**Серии**](https://reference.aspose.com/cells/java/com.aspose.cells/Series) объект, тогда как[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection) объект представляет собой совокупность[**Серии**](https://reference.aspose.com/cells/java/com.aspose.cells/Series)объекты. При создании пользовательской диаграммы разработчики могут свободно использовать различные типы диаграмм для разных рядов данных (собранных в[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection)объект).

{{% alert color="primary" %}}

 В настоящее время Aspose.Cells поддерживает только настраиваемые диаграммы, которые сочетают в себе круговые, линейные, столбчатые и столбчатые диаграммы, но в будущих выпусках будет поддерживаться больше диаграмм. Полный список стандартных диаграмм, поддерживаемых Aspose.Cells, см.[Типы диаграмм](/cells/ru/java/chart-types/) статья.

{{% /alert %}}

В приведенном ниже примере кода показано, как создавать собственные диаграммы. В этом примере мы собираемся использовать столбчатую диаграмму для первого ряда данных и линейную диаграмму для второго ряда. В результате мы добавляем столбчатую диаграмму в сочетании с линейной диаграммой на рабочий лист.

**Пользовательская диаграмма, сочетающая столбчатые и линейные диаграммы**

![дело:изображение_альтернативный_текст](creating-and-customizing-charts_3.png)

**Пример программирования**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-HowToCreateCustomChart-HowToCreateCustomChart.java" >}}

{{% alert color="primary" %}}

Чтобы увидеть список поддерживаемых типов диаграмм, прочтите[Типы диаграмм](/cells/ru/java/chart-types/) статья.

{{% /alert %}}

