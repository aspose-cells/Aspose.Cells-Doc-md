---
title: Настройка диаграмм
type: docs
weight: 15
url: /ru/java/creating-and-customizing-charts/
alias: [/java/customizing-charts/]
---
##  **Создание диаграмм**

В электронные таблицы можно добавлять различные диаграммы с помощью Aspose.Cells. Aspose.Cells предоставляет множество гибких объектов диаграмм. В этом разделе обсуждаются объекты диаграмм Aspose.Cells'.

###  **Простое создание диаграммы**

Создать диаграмму с номером Aspose.Cells просто, используя следующие примеры кодов:

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-Java-Charts-ManipulateChart-HowToCreateColumnChart-1.java" >}}


###  **Что нужно знать для создания диаграммы**

Прежде чем создавать диаграммы, важно понять некоторые основные понятия, которые будут полезны при создании диаграмм с использованием Aspose.Cells.

####  **Объекты диаграммы**

Aspose.Cells предоставляет специальный набор классов, используемых для создания всех видов диаграмм. Эти классы используются для создания *объектов диаграмм**, которые действуют как строительные блоки диаграмм. Объекты диаграммы перечислены ниже:

- [**Ось**](https://reference.aspose.com/cells/java/com.aspose.cells/Axis), ось диаграммы.
- [**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart), одна диаграмма Excel.
- [**Область диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartArea), область диаграммы на листе.
- [**Таблица данных диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartDataTable), таблица данных диаграммы.
- [**ДиаграммаКадр**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartFrame), объект рамки на диаграмме.
- [**Чартпойнт**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartPoint), одна точка в серии на диаграмме.
- [**ChartPointCollection**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartPointCollection), коллекция, содержащая все точки одной серии.
- [**ДиаграммаКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) , коллекция[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart)объекты.
-  DataLabels, DataLabels для указанного[**Ряд**](https://reference.aspose.com/cells/java/com.aspose.cells/Series), [**Чартпойнт**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartPoint), [**Линия тренда**](https://reference.aspose.com/cells/java/com.aspose.cells/Trendline), и т. д.
- [**Формат заполнения**](https://reference.aspose.com/cells/java/com.aspose.cells/FillFormat), формат заполнения фигуры.
- [**Пол**](https://reference.aspose.com/cells/java/com.aspose.cells/Floor), пол трехмерной диаграммы.
- [**Легенда**](https://reference.aspose.com/cells/java/com.aspose.cells/Legend), легенда диаграммы.
- [**Линия**](https://reference.aspose.com/cells/java/com.aspose.cells/Line), линия диаграммы.
- [**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection) , коллекция[**Ряд**](https://reference.aspose.com/cells/java/com.aspose.cells/Series)объекты.
- [**Ряд**](https://reference.aspose.com/cells/java/com.aspose.cells/Series)представляет один ряд данных на диаграмме.
- [**TickLabels**](https://reference.aspose.com/cells/java/com.aspose.cells/TickLabels), метки делений, связанные с делениями на оси диаграммы.
- [**Заголовок**](https://reference.aspose.com/cells/java/com.aspose.cells/Title), название диаграммы или оси.
- [**Линия тренда**](https://reference.aspose.com/cells/java/com.aspose.cells/Trendline), линия тренда на графике.
- [**TrendlineКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/TrendlineCollection), коллекция всех объектов линии тренда для указанного ряда данных.
- [**Стены**](https://reference.aspose.com/cells/java/com.aspose.cells/Walls), стены трехмерной диаграммы.

####  **Использование объектов диаграммы**

Как упоминалось выше, все объекты диаграмм являются экземплярами соответствующих классов и предоставляют определенные свойства и методы для выполнения определенных задач. Используйте объекты диаграмм для создания диаграмм.

 Добавьте любой тип диаграммы на рабочий лист, используя[**ДиаграммаКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) коллекция. Каждый предмет в[**ДиаграммаКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) коллекция представляет собой[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart) объект. А[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart)Объект инкапсулирует все объекты диаграммы, необходимые для настройки внешнего вида диаграммы. В следующем разделе показано, как использовать несколько основных объектов диаграмм для создания простой диаграммы.

###  **Создание простой диаграммы**

С помощью Aspose.Cells можно создавать множество различных типов диаграмм. Все стандартные диаграммы, поддерживаемые Aspose.Cells, заранее определены в перечислении с именем[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType). Предопределенные типы диаграмм:

|**Типы диаграмм**|**Описание**|
| :- | :- |
|Столбец|Представляет кластеризованную столбчатую диаграмму|
|СтолбецСложенный|Представляет столбчатую диаграмму с накоплением|
|Столбец100Процент|Представляет 100%-ную столбчатую диаграмму с накоплением|
|Столбец3DКластерный|Представляет трехмерную кластеризованную столбчатую диаграмму|
|Столбец3DСложенный|Представляет трехмерную столбчатую диаграмму с накоплением|
|Столбец3D100PercentStacked|Представляет трехмерную столбчатую диаграмму со 100% накоплением|
|Колонка3D|Представляет трехмерную столбчатую диаграмму|
|Бар|Представляет кластерную гистограмму|
|БарСтекированный|Представляет гистограмму с накоплением|
|Бар100ПроцентСложенный|Представляет 100% гистограмму с накоплением|
|Бар3DКластерный|Представляет трехмерную кластеризованную гистограмму|
|Бар3DСложенный|Представляет трехмерную гистограмму с накоплением|
|Бар3D100ПроцентСложенный|Представляет трехмерную гистограмму со 100% накоплением|
|Линия|Представляет линейный график|
|Линия с накоплением|Представляет сложную линейную диаграмму|
|Линия100Процент|Представляет линейную диаграмму со 100% накоплением|
|LineWithDataMarkers|Представляет линейную диаграмму с маркерами данных.|
|LineStackedWithDataMarkers|Представляет составную линейную диаграмму с маркерами данных.|
|Line100PercentStackedWithDataMarkers|Представляет 100% сложную линейную диаграмму с маркерами данных.|
|Линия3D|Представляет трехмерную линейную диаграмму|
|Пирог|Представляет круговую диаграмму|
|Пирог3D|Представляет трехмерную круговую диаграмму|
|ПирогПирог|Представляет круговую диаграмму|
|ПирогВзорвался|Представляет собой развернутую круговую диаграмму|
|Пирог3DВзорванный|Представляет трехмерную развернутую круговую диаграмму|
|пироговый бар|Представляет собой круговую диаграмму|
|Разброс|Представляет точечную диаграмму|
|ScatterConnectedByCurvesWithDataMarker|Представляет точечную диаграмму, соединенную кривыми, с маркерами данных.|
|ScatterConnectedByCurvesWithoutDataMarker|Представляет точечную диаграмму, соединенную кривыми, без маркеров данных.|
|ScatterConnectedByLinesWithDataMarker|Представляет точечную диаграмму, соединенную линиями, с маркерами данных.|
|ScatterConnectedByLinesWithoutDataMarker|Представляет точечную диаграмму, соединенную линиями, без маркеров данных.|
|Область|Представляет диаграмму областей|
|ПлощадьСложенный|Представляет диаграмму с накоплением|
|Площадь100ПроцентовСложены|Представляет 100% диаграмму с областями с накоплением|
|Площадь3D|Представляет трехмерную диаграмму с областями|
|Площадь3DСложенный|Представляет трехмерную составную диаграмму с областями|
|Площадь3D100ПроцентСложенный|Представляет трехмерную диаграмму с областями со 100% накоплением|
|Пончик|Представляет кольцевую диаграмму|
|ПончикВзорванный|Представляет собой развернутую кольцевую диаграмму|
|Радар|Представляет радиолокационную диаграмму|
|РадарСДаннымиМаркерами|Представляет радарную диаграмму с маркерами данных.|
|РадарЗаполнен|Представляет заполненную радарную диаграмму|
|Поверхность3D|Представляет трехмерную диаграмму поверхности|
|ПоверхностьКаркас3D|Представляет каркасную трехмерную поверхностную диаграмму.|
|ПоверхностьКонтур|Представляет контурную диаграмму|
|ПоверхностьКонтурКаркас|Представляет каркасную контурную диаграмму|
|Пузырь|Представляет пузырьковую диаграмму|
|Пузырь3D|Представляет трехмерную пузырьковую диаграмму|
|Цилиндр|Представляет цилиндрическую диаграмму|
|ЦилиндрСложенный|Представляет сложенную цилиндрическую диаграмму|
|Цилиндр100Процентов|Представляет 100% сложенную цилиндрическую диаграмму|
|ЦилиндрическийБар|Представляет цилиндрическую гистограмму.|
|ЦилиндрическийБарСложенный|Представляет сложенную цилиндрическую гистограмму|
|ЦилиндрическийБар100%С накоплением|Представляет 100%-ную цилиндрическую гистограмму с накоплением|
|ЦилиндрическаяКолонна3D|Представляет трехмерную цилиндрическую гистограмму|
|Конус|Представляет конусную диаграмму|
|КонусСложенный|Представляет составную конусную диаграмму|
|Конус100ПроцентовСложены|Представляет 100% сложную конусную диаграмму|
|КоническийБар|Представляет коническую гистограмму|
|КоническийБарСложенный|Представляет составную коническую гистограмму|
|КоническийБар100ПроцентСложенный|Представляет 100% сложенную коническую гистограмму|
|КоническаяКолонна3D|Представляет трехмерную коническую столбчатую диаграмму|
|Пирамида|Представляет пирамидальную диаграмму|
|ПирамидаСложены|Представляет сложную пирамидальную диаграмму|
|Пирамида100Процентов|Представляет 100% сложную пирамидальную диаграмму|
|ПирамидаБар|Представляет пирамидальную гистограмму|
|ПирамидаБарСложены|Представляет столбчатую пирамидальную диаграмму с накоплением|
|ПирамидаБар100ПроцентСложенный|Представляет 100%-ную пирамидальную диаграмму с накоплением|
|ПирамидаКолонна3D|Представляет трехмерную пирамидальную гистограмму|
Чтобы создать диаграмму с помощью Aspose.Cells:

1. Добавьте данные в ячейки листа с помощью[**Cell**](https://reference.aspose.com/cells/java/com.aspose.cells/Cell) объекты[**установить значение**](https://reference.aspose.com/cells/java/com.aspose.cells/cell#Value)метод.
 Это будет использоваться в качестве источника данных для диаграммы.
1.  Добавьте диаграмму на лист, вызвав метод[**ДиаграммаКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection) коллекция[*добавлять*](https://reference.aspose.com/cells/java/com.aspose.cells/chartcollection#add(int,%20int,%20int,%20int,%20int) ) метод, инкапсулированный в[**Рабочий лист**](https://reference.aspose.com/cells/java/com.aspose.cells/Worksheet)объект.
1.  Укажите тип диаграммы с помощью[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType)перечисление.
 Например, в примере используется[**ChartType.PYRAMID**](https://reference.aspose.com/cells/java/com.aspose.cells/charttype#PYRAMID)значение в качестве типа диаграммы.
1.  Доступ к новому[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart) объект из[**ДиаграммаКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartCollection)коллекцию, передав ее индекс.
1.  Используйте любой из объектов диаграммы, инкапсулированных в[**Диаграмма**](https://reference.aspose.com/cells/java/com.aspose.cells/Chart)объект для управления диаграммой.
 В приведенном ниже примере используется[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection)объект диаграммы, чтобы указать источник данных диаграммы.

При добавлении исходных данных в диаграмму источником данных может быть диапазон ячеек (например, «A1:C3»), последовательность несмежных ячеек (например, «A1, A3, A5») или последовательность ячеек. значения (например, «1,2,3»).

{{% alert color="primary" %}}

Когда вы назначаете диапазон ячеек в качестве источника данных, вы можете установить только диапазон от верхнего левого угла до нижнего правого. Например, «A1:C3» является допустимым, а «C3:A1» — недействительным.

{{% /alert %}}

Эти общие шаги позволяют создавать диаграммы любого типа. Используйте разные объекты диаграмм для создания разных диаграмм.

При выполнении примера кода на лист добавляется пирамидальная диаграмма, как показано ниже.

**Пирамидальная диаграмма с источником данных**

![задача: image_alt_text](creating-and-customizing-charts_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-HowToCreatePyramidChart-HowToCreatePyramidChart.java" >}}

 Чтобы создать пузырьковую диаграмму,[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType)должен быть установлен на[**Тип диаграммы.BUBBLE**](https://reference.aspose.com/cells/java/com.aspose.cells/charttype#BUBBLE)и несколько дополнительных свойств, таких как BubbleSizes, Values и XValues, необходимо установить соответствующим образом. После выполнения следующего кода на лист добавляется пузырьковая диаграмма, как показано ниже.

**Пузырьковая диаграмма с источником данных**

![задача: image_alt_text](creating-and-customizing-charts_2.jpg)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-HowToCreateBubbleChart-HowToCreateBubbleChart.java" >}}

####  **Линия с диаграммой маркеров данных**

Чтобы создать линию с диаграммой маркеров данных,[**Тип диаграммы**](https://reference.aspose.com/cells/java/com.aspose.cells/ChartType)должен быть установлен на[**Тип диаграммы.LINE_WITH_DATA_MARKERS**](https://reference.aspose.com/cells/java/com.aspose.cells/charttype#LINE_WITH_DATA_MARKERS) и несколько дополнительных свойств, таких как область фона, маркеры серий, значения и значения X, необходимо установить соответствующим образом. После выполнения следующего кода на лист добавляется строка с диаграммой маркеров данных.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-AsposeCellsExamples-Charts-CreateLineWithDataMarkerChart-1.java" >}}

##  **Создание пользовательских диаграмм**

До сих пор, когда мы обсуждали диаграммы, мы рассматривали стандартные диаграммы со стандартными настройками форматирования. Мы только определяем источник данных, устанавливаем несколько свойств, и диаграмма создается с настройками формата по умолчанию. Но Aspose.Cells также поддерживает создание пользовательских диаграмм, что позволяет разработчикам создавать диаграммы со своими собственными настройками формата.

###  **Создание пользовательских диаграмм**

Разработчики могут создавать собственные диаграммы во время выполнения, используя простой Aspose.Cells API.

 Диаграмма состоит из ряда данных. Каждая серия данных в Aspose.Cells представлена[**Ряд**](https://reference.aspose.com/cells/java/com.aspose.cells/Series)объект, тогда как[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection) объект служит совокупностью[**Ряд**](https://reference.aspose.com/cells/java/com.aspose.cells/Series)объекты. При создании пользовательской диаграммы разработчики имеют право использовать разные типы диаграмм для разных рядов данных (собранных в виде[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection)объект).

{{% alert color="primary" %}}

 В настоящее время Aspose.Cells поддерживает только пользовательские диаграммы, сочетающие в себе круговые, линейные, столбчатые и столбчатые диаграммы, но в будущих выпусках будет поддерживаться больше диаграмм. Полный список стандартных диаграмм, которые поддерживает Aspose.Cells, см.[Типы диаграмм](/cells/ru/java/chart-types/) статья.

{{% /alert %}}

В примере кода ниже показано, как создавать собственные диаграммы. В этом примере мы собираемся использовать столбчатую диаграмму для первого ряда данных и линейную диаграмму для второго ряда. В результате мы добавляем на лист гистограмму в сочетании с линейной диаграммой.

**Пользовательская диаграмма, объединяющая столбчатые и линейные диаграммы**

![задача: image_alt_text](creating-and-customizing-charts_3.png)

**Пример программирования**

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-HowToCreateCustomChart-HowToCreateCustomChart.java" >}}

{{% alert color="primary" %}}

Чтобы просмотреть список поддерживаемых типов диаграмм, прочтите[Типы диаграмм](/cells/ru/java/chart-types/) статья.

{{% /alert %}}

