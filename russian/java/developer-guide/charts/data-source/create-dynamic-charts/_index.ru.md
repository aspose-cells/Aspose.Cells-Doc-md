---
title: Создание динамических графиков
type: docs
weight: 200
url: /ru/java/create-dynamic-charts/
---

{{% alert color="primary" %}}

Динамические (или интерактивные) графики имеют возможность изменяться, когда вы изменяете область данных. Другими словами, динамические графики могут автоматически отражать изменения, когда изменяется источник данных. Чтобы вызвать изменение источника данных, можно использовать опцию фильтрации таблиц Excel или использовать элемент управления, такой как ComboBox или выпадающий список.

Эта статья демонстрирует использование API Aspose.Cells for Java для создания динамических диаграмм с использованием обоих упомянутых подходов.

{{% /alert %}}

## **Использование таблиц Excel**

{{% alert color="primary" %}}

Таблицы Excel в перспективе Aspose.Cells называются ListObjects, поэтому мы будем использовать термин "ListObject" вместо "Table" для ясности. Пожалуйста, подробно ознакомьтесь с тем, как [создать ListObjects](/cells/ru/java/creating-a-list-object/) с помощью API Aspose.Cells for .NET.

{{% /alert %}}

ListObjects обеспечивает встроенную функциональность сортировки и фильтрации данных при взаимодействии пользователя. Обе опции сортировки и фильтрации предоставляются с помощью выпадающих списков, которые автоматически добавляются в заголовочную строку ListObject. Благодаря этим функциям (сортировке и фильтрации), ListObject кажется идеальным кандидатом для службы источником данных для динамической диаграммы, потому что при изменении сортировки или фильтрации данные на диаграмме будут изменяться, отражая текущее состояние ListObject.

Чтобы сделать демонстрацию понятной, мы создадим рабочую книгу с нуля и будем двигаться шаг за шагом, как описано ниже.

1. Создать пустую рабочую книгу.
1. Получить доступ к ячейкам первого листа в книге.
1. Вставить некоторые данные в ячейки.
1. Создать ListObject на основе вставленных данных.
1. Создать диаграмму на основе диапазона данных ListObject.
1. Сохраните результат на диск.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-UsingExcelTables-UsingExcelTables.java" >}}

## **Использование динамических формул**

Если вы не хотите использовать ListObjects в качестве источника данных для динамической диаграммы, другой вариант - использовать функции Excel (или формулы) для создания динамического диапазона данных и управляющий элемент (например, ComboBox) для вызова изменения данных. В этом сценарии мы будем использовать функцию VLOOKUP для извлечения соответствующих значений на основе выбора ComboBox. При изменении выбора функция VLOOKUP будет обновлять значение ячейки. Если диапазон ячеек использует функцию VLOOKUP, весь диапазон может быть обновлен при взаимодействии пользователя и, таким образом, может быть использован в качестве источника для динамической диаграммы.

Чтобы сделать демонстрацию понятной, мы создадим рабочую книгу с нуля и будем двигаться шаг за шагом, как описано ниже.

1. Создать пустую рабочую книгу.
1. Получить доступ к ячейкам первого листа в книге.
1. Вставить некоторые данные в ячейки, создав Именованный диапазон. Эти данные будут служить в качестве серии для динамической диаграммы.
1. Создать ComboBox на основе Именованного диапазона, созданного на предыдущем шаге.
1. Вставить ещё некоторые данные в ячейки, которые будут служить источником для функции VLOOKUP.
1. Вставить функцию VLOOKUP (с подходящими параметрами) в диапазон ячеек. Этот диапазон будет служить источником для динамической диаграммы.
1. Создайте диаграмму на основе диапазона, созданного на предыдущем шаге.
1. Сохраните результат на диск.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-articles-UsingDynamicFormulas-UsingDynamicFormulas.java" >}}
{{< app/cells/assistant language="java" >}}
