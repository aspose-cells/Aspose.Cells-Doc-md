---
title: Форматирование диаграммы
type: docs
weight: 20
url: /ru/java/chart-formatting/
---
## **Настройка внешнего вида диаграммы**

 В[Типы диаграмм](/cells/ru/java/chart-types/), мы дали краткое введение в типы диаграмм и объектов диаграмм, предлагаемых Aspose.Cells.

В этой статье мы обсудим, как настроить внешний вид диаграмм, установив ряд различных свойств:

- [Настройка области диаграммы](/cells/ru/java/chart-formatting/#setting-chart-area).
- [Настройка линий графика](/cells/ru/java/chart-formatting/#setting-chart-lines).
- [Применение тем](/cells/ru/java/chart-formatting/#applying-microsoft-excel-20072010-themes-to-charts).
- [Установка заголовков для диаграмм и осей](/cells/ru/java/chart-formatting/#setting-the-titles-of-charts-or-axes).
- [Работа с линиями сетки](/cells/ru/java/chart-formatting/#setting-major-gridlines).
- [Установка бордюров для задней и боковых стенок](/cells/ru/java/chart-formatting/#setting-borders-for-back-and-side-walls).

### **Настройка области диаграммы**

На диаграмме есть разные типы областей, и номер Aspose.Cells обеспечивает гибкость изменения внешнего вида каждой области. Разработчики могут применять различные параметры форматирования к области, изменяя цвет переднего плана, цвет фона, формат заливки и т. д.

В приведенном ниже примере мы применили разные настройки форматирования к разным областям диаграммы. Эти области включают в себя:

- Площадь участка
- Область диаграммы
- [**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection) площадь
- Площадь одной точки в[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection)

После выполнения примера кода на рабочий лист будет добавлена столбчатая диаграмма, как показано ниже:

**Столбчатая диаграмма с заполненными областями** 

![дело:изображение_альтернативный_текст](chart-formatting_1.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-SettingChartArea-SettingChartArea.java" >}}

### **Настройка линий диаграммы**

 Разработчики также могут применять различные стили к линиям или маркерам данных.[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection)как показано ниже в примере. Выполнение примера кода добавляет гистограмму на рабочий лист, как показано ниже:

**Столбчатая диаграмма после применения стилей линий** 

![дело:изображение_альтернативный_текст](chart-formatting_2.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-SettingChartLines-SettingChartLines.java" >}}

### **Применение тем Excel 2007/2010 Microsoft к диаграммам**

Разработчики могут применять различные темы и цвета Excel Microsoft к[**СерияКоллекция**](https://reference.aspose.com/cells/java/com.aspose.cells/SeriesCollection)или другие объекты диаграммы, как показано в примере ниже.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-ApplyingThemes-ApplyingThemes.java" >}}

### **Установка заголовков диаграмм или осей**

Вы можете использовать Microsoft Excel, чтобы установить заголовки диаграммы и ее осей в среде WYSIWYG, как показано ниже.

**Установка заголовков диаграммы и ее осей с помощью Microsoft Excel** 

![дело:изображение_альтернативный_текст](chart-formatting_3.png)

 Aspose.Cells также позволяет разработчикам устанавливать заголовки диаграммы и ее оси во время выполнения. Все диаграммы и их оси содержат[**Заголовок.setText**](https://reference.aspose.com/cells/java/com.aspose.cells/title#Text)метод, который можно использовать для установки их заголовков, как показано ниже в примере. После выполнения примера кода на рабочий лист будет добавлена столбчатая диаграмма, как показано ниже:

**Столбчатая диаграмма после установки заголовков** 

![дело:изображение_альтернативный_текст](chart-formatting_4.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-SettingTitlesAxes-SettingTitlesAxes.java" >}}

### **Настройка основных линий сетки**

#### **Скрытие основных линий сетки**

 Разработчики могут контролировать видимость основных линий сетки с помощью[**setVisible**](https://reference.aspose.com/cells/java/com.aspose.cells/line#IsVisible) метод[**Линия**](https://reference.aspose.com/cells/java/com.aspose.cells/Line)объект. После скрытия основных линий сетки столбчатая диаграмма, добавленная на рабочий лист, имеет следующий вид:

**Столбчатая диаграмма со скрытыми основными линиями сетки** 

![дело:изображение_альтернативный_текст](chart-formatting_5.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-SettingChartsAppearance-MajorGridlines-1.java" >}}

#### **Изменение основных настроек линий сетки**

Разработчики могут контролировать не только видимость основных линий сетки, но и другие свойства, включая цвет и т. д. После установки цвета основных линий сетки столбчатая диаграмма, добавленная на рабочий лист, будет иметь следующий вид:

**Столбчатая диаграмма с цветными основными линиями сетки** 

![дело:изображение_альтернативный_текст](chart-formatting_6.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-SettingChartsAppearance-ChangingMajorGridlines-1.java" >}}

### **Установка границ для задней и боковых стенок**

 С момента выпуска Microsoft Excel 2007 стенки трехмерной диаграммы были разделены на две части: боковую стенку и заднюю стенку, поэтому мы должны использовать две части.[**Стены**](https://reference.aspose.com/cells/java/com.aspose.cells/Walls) объекты, чтобы представлять их отдельно, и вы можете получить к ним доступ, используя[**Диаграмма.getBackWall()**](https://reference.aspose.com/cells/java/com.aspose.cells/chart#BackWall) и[**Диаграмма.getSideWall()**](https://reference.aspose.com/cells/java/com.aspose.cells/chart#SideWall).

В приведенном ниже примере показано, как установить границу боковой стенки с помощью различных атрибутов.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-SettingChartsAppearance-SettingBorders-1.java" >}}

## **Изменить положение и размер диаграммы**

 Иногда вы хотите изменить положение или размер новой или существующей диаграммы внутри рабочего листа. Aspose.Cells обеспечивает[**Диаграмма.getChartObject()**](https://reference.aspose.com/cells/java/com.aspose.cells/chart#ChartObject)свойство для достижения этого. Вы можете использовать его подсвойства, чтобы изменить размер диаграммы с помощью новых**рост** и**ширина** или переместите его с новым** Х** и**Координаты Y**.

### **Изменение положения и размера диаграммы**

Чтобы изменить положение диаграммы (координаты X, Y) и размер (высота, ширина), используйте эти свойства:

1. [**Диаграмма.getChartObject().get/setWidth()**](https://reference.aspose.com/cells/java/com.aspose.cells/chartshape#Width)
1. [**Диаграмма.getChartObject().get/setHeight()**](https://reference.aspose.com/cells/java/com.aspose.cells/chartshape#Height)
1. [**Диаграмма.getChartObject().get/setX()**](https://reference.aspose.com/cells/java/com.aspose.cells/chartshape#X)
1. [**Диаграмма.getChartObject().get/setY()**](https://reference.aspose.com/cells/java/com.aspose.cells/chartshape#Y)

В следующем примере объясняется использование вышеуказанных свойств. Он загружает существующую книгу, содержащую диаграмму на первом листе. Затем он изменяет размер и положение диаграммы и сохраняет книгу.

Перед выполнением примера кода исходный файл выглядит так:

**Размер и положение диаграммы перед выполнением примера кода** 

![дело:изображение_альтернативный_текст](chart-formatting_7.png)

После выполнения выходной файл выглядит так:

**Размер и положение диаграммы после выполнения примера кода** 

![дело:изображение_альтернативный_текст](chart-formatting_8.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-ChangeChartPositionAndSize-ChangeChartPositionAndSize.java" >}}

## **Управление диаграммами конструктора**

Иногда вам может понадобиться манипулировать диаграммами в файлах шаблонов конструктора или изменять их. Aspose.Cells полностью поддерживает работу с диаграммами конструктора с их содержимым и элементами. Данные, содержимое диаграммы, фоновое изображение и форматирование могут быть сохранены с точностью.

### **Управление диаграммами конструктора в файлах шаблонов**

 Для управления диаграммами конструктора в файле шаблона используйте все связанные с диаграммами вызовы API. Например, используйте[**Рабочий лист.getCharts**](https://reference.aspose.com/cells/java/com.aspose.cells/worksheet#Charts) свойство, чтобы получить существующую коллекцию диаграмм в файле шаблона.

#### **Создание диаграммы**

В следующем примере показано, как создать круговую диаграмму. Мы будем манипулировать этой диаграммой позже. Следующий вывод генерируется кодом.

**Входная круговая диаграмма** 

![дело:изображение_альтернативный_текст](chart-formatting_9.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-CreateChart-CreateChart.java" >}}

#### **Управление диаграммой**

В следующем примере показано, как управлять существующей диаграммой. В этом примере мы модифицируем диаграмму, созданную выше. Следующий вывод генерируется кодом. Обратите внимание, что цвет заголовка диаграммы изменился с синего на черный, а «Англия 30000» — на «Великобритания, 30 тыс.».

**Круговая диаграмма была изменена** 

![дело:изображение_альтернативный_текст](chart-formatting_10.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-ModifyPieChart-ModifyPieChart.java" >}}

#### **Управление линейным графиком в шаблоне конструктора**

В этом примере мы будем манипулировать линейной диаграммой. Мы добавим некоторые ряды данных в существующую диаграмму и изменим цвета их линий.

Во-первых, взгляните на линейный график дизайнера.

**Входная линейная диаграмма** 

![дело:изображение_альтернативный_текст](chart-formatting_11.png)

 Теперь мы манипулируем линейной диаграммой (которая содержится в**линейная диаграмма.xls** файл) с помощью следующего кода. Следующий вывод генерируется кодом.

**Управляемый линейный график** 

![дело:изображение_альтернативный_текст](chart-formatting_12.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-ModifyLineChart-ModifyLineChart.java" >}}

## **Использование спарклайнов**

Microsoft Excel 2010 может анализировать информацию самыми разными способами. Это позволяет пользователям отслеживать и выделять важные тенденции данных с помощью новых инструментов анализа и визуализации данных. Спарклайны — это мини-диаграммы, которые вы можете разместить внутри ячеек, чтобы вы могли просматривать данные и диаграмму в одной таблице. При правильном использовании спарклайнов анализ данных выполняется быстрее и точнее. Они также обеспечивают простое представление информации, избегая переполненных рабочих листов с большим количеством занятых диаграмм.

Aspose.Cells предоставляет API для управления спарклайнами в электронных таблицах.

### **Спарклайны в Microsoft Excel**

Чтобы вставить спарклайны в Microsoft Excel 2010:

1. Выберите ячейки, в которых вы хотите, чтобы отображались спарклайны. Чтобы их было легко просматривать, выберите ячейки рядом с данными.
1.  Нажмите**Вставлять** на ленте, а затем выберите**столбец** в**Спарклайны** группа.

![дело:изображение_альтернативный_текст](chart-formatting_13.png)

1. Выберите или введите диапазон ячеек на листе, содержащих исходные данные.
 Появляются диаграммы.

Например, спарклайны помогают увидеть тенденции или отчет о победах или поражениях в лиге софтбола. Спарклайны могут даже подводить итоги всего сезона каждой команды в лиге.

![дело:изображение_альтернативный_текст](chart-formatting_14.png)

### **Спарклайны с использованием Aspose.Cells**

Разработчики могут создавать, удалять или читать спарклайны (в файле шаблона), используя API, предоставленный Aspose.Cells. Добавляя пользовательскую графику для заданного диапазона данных, разработчики могут свободно добавлять различные типы крошечных диаграмм в выбранные области ячеек.

Пример ниже демонстрирует функцию Sparklines. В примере показано, как:

1. Откройте простой файл шаблона.
1. Чтение информации о спарклайнах для рабочего листа.
1. Добавьте новые спарклайны для заданного диапазона данных в область ячеек.
1. Сохраняет файл Excel на диск.

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-UsingSparklines-UsingSparklines.java" >}}

## **Применение 3D-формата к диаграмме**

Вам могут понадобиться стили трехмерных диаграмм, чтобы вы могли получить результаты только для своего сценария. Aspose.Cells API-интерфейсы предоставляют соответствующий API для применения Microsoft трехмерного форматирования Excel 2007, как показано в этой статье.

### **Настройка формата 3D для диаграммы**

Полный пример приведен ниже, чтобы продемонстрировать, как создать диаграмму и применить Microsoft Excel 2007 3D-форматирование. После выполнения приведенного выше примера кода на рабочий лист будет добавлена столбчатая диаграмма (с 3D-эффектами), как показано ниже.

**Столбчатая диаграмма с трехмерным форматированием**

![дело:изображение_альтернативный_текст](chart-formatting_15.png)

{{< gist "aspose-cells-gists" "5876dc77e47649b66bdb5deefb4b5639" "Examples-src-main-java-com-aspose-cells-examples-charts-Applying3DFormat-Applying3DFormat.java" >}}

{{% alert color="primary" %}}

 Полный список поддерживаемых двухмерных и трехмерных диаграмм см.[Поддерживаемые типы диаграмм для визуализации](/cells/ru/java/chart-rendering/#supported-chart-types-for-rendering).

{{% /alert %}}

## **Предварительные темы**
- [Установить изображение в качестве фона Заполнить диаграмму](/cells/ru/java/set-picture-as-background-fill-in-the-chart/)
