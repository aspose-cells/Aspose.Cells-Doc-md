---
title: Часто задаваемые вопросы
type: docs
weight: 100
url: /ru/net/faq/
---
## **Как исправить исключение System.StackOverFlowException в Workbook.CalculateFormula?**
Иногда пользователи сталкиваются с System.StackOverFlowException в методе Workbook.CalculateFormula. Это исключение обычно возникает из-за того, что размер стека IIS по умолчанию слишком мал (только 265 КБ). Вы можете исправить эту ошибку, создав еще один поток с увеличенным размером стека, а затем переместив в него код, связанный с Workbook.CalculateFormula.



{{< gist "aspose-cells-gists" "7c644a93d33d24299a618c1dda1a2385" "Examples.GridWeb-CSharp-Controllers-GridWebFAQController-FixStackOverflowException.cs" >}}
## **Проблема с толщиной линий при рендеринге Excel в PDF**
Иногда, когда файл Excel конвертируется в PDF, толщина линий в выходном PDF отличается. Эта проблема не вызвана Aspose.Cells. Она вызвана**Adobe Reader** когда его настройки**«Гладкая линия искусства»** а также**«Усиление тонких линий»** проверяются. При снятии флажка с этих параметров PDF будет отображаться нормально.

 Если проверить**«Гладкая линия искусства»** а также**«Усиление тонких линий»**, толщина линий разная. См. следующие шаги, как это делается:

-  Перейти к**Редактировать**
-  Выбирать**Настройки**
-  в**Отображение страницы** Категория Проверить**«Гладкая линия искусства»** а также**«Усиление тонких линий»**

 Если снять флажок**«Гладкая линия искусства»** а также**«Усиление тонких линий»**, толщина линий одинакова. Для этого просто выполните следующие шаги:

-  Перейти к**Редактировать**
-  Выбирать**Настройки**
-  в**Отображение страницы** Категория Снимите флажок**«Гладкая линия искусства»** а также**«Усиление тонких линий»**
## **Как исправить исключение System.OutOfMemoryException при загрузке больших электронных таблиц?**
Есть большая вероятность, что конструктор Workbook может вызвать исключение System.OutOfMemoryException при загрузке больших электронных таблиц. Это исключение говорит о том, что доступной памяти недостаточно для полной загрузки электронной таблицы в память, поэтому электронную таблицу необходимо загрузить, включив[Настройки памяти](/cells/ru/net/optimizing-memory-usage-while-working-with-big-files-having-large-datasets/).

Aspose.Cells API-интерфейсы предоставляют настройки памяти для оптимизации потребления памяти при загрузке и обработке электронных таблиц. Эти параметры также полезны для эффективной загрузки больших электронных таблиц, содержащих огромные наборы данных, в объект Workbook, как показано ниже.



{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-KnowledgeBase-FAQs-FixOutOfMemoryException-1.cs" >}}

## **Определите, какой размер стека необходим для определенной книги**
Несмотря на то, что мы улучшили механизм вычисления формул Aspose.Cells, и в большинстве случаев вы сможете успешно вычислить все формулы для данного файла шаблона, не указывая меньший размер стека. Но, тем не менее, иногда StackOverFlowException для метода Workbook.CalculateFormula может быть неизбежным. Мы предоставляем пользователям новые API для отслеживания расчетов по формуле. Мы добавили класс с именем «AbstractCalculationMonitor» и предоставили свойство, т. е.*CalculationOptions.CalculationMonitor*чтобы справиться/отследить проблему.

Пользователи могут самостоятельно отслеживать размер стека с помощью API. Обратите внимание, что проверка стека для каждой ячейки, безусловно, приведет к еще большему снижению производительности. См. пример сегмента кода для справки:

`     `общедоступный класс MyCalculationMonitor: AbstractCalculationMonitor
`     `{  ``public override void BeforeCalculate(int sheetIndex, int rowIndex, int colIndex)  ` `{  ` `if(new StackTrace(false).FrameCount > 2000)  ` `{  ` `выбросить новое исключение( Остановить вычисление формулы из-за риска StackOverflowException");  ` `}  ` `}  ` `} 



{{% alert color="primary" %}} 

Нет лучшего способа получить размер стека, используемый во время выполнения. Приведенный выше код приведен только для примера. Производительность будет значительно снижена наверняка. Итак, мы считаем, что код может быть оптимизирован пользователями (которые действительно хотят его использовать) в соответствии с их различными сценариями и требованиями. Например, проверка стека, когда количество рекурсивных ячеек достигает определенного числа, сбор средней скорости увеличения стека для одной рекурсивной ячейки и определение частоты проверки стека и т. д.

{{% /alert %}}

