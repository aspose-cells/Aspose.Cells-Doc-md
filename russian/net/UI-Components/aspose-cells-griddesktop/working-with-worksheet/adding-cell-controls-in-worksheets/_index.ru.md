---
title: Добавление элементов управления ячейками в листах
type: docs
weight: 120
url: /ru/net/aspose-cells-griddesktop/add-cell-controls-in-worksheets/
keywords: GridDesktop,add,control,button,checkbox,combobox
description: В этой статье представлен способ добавления элемента управления в листе в GridDesktop.
---

{{% alert color="primary" %}} 

Элементы управления ячейками на самом деле являются элементами управления, которые можно добавить в листы. Мы называем их **Элементы управления ячейками**, потому что эти элементы управления отображаются в ячейках. В этой теме мы рассмотрим добавление и обработку событий этих элементов управления ячейками.

{{% /alert %}} 
## **Введение**
В настоящее время Aspose.Cells.GridDesktop поддерживает добавление трех типов элементов управления ячейками, включая следующее:

- **Кнопка**
- **Флажок**
- **Комбобокс**

Все эти элементы управления происходят от абстрактного класса **CellControl**. Каждый лист содержит коллекцию **Controls**. Новые элементы управления ячейками могут быть добавлены, а существующие могут быть обращены к этой коллекции **Controls** легко.

**ВАЖНО:** Если вы хотите добавить элементы управления ячейками для всех ячеек столбца, а не по одному, то вы можете обратиться к [Управление элементами управления ячейками в столбцах.](/cells/ru/net/aspose-cells-griddesktop/adding-cell-controls-in-worksheets/)
### **Добавление кнопки**
Чтобы добавить кнопку на лист с помощью Aspose.Cells.GridDesktop, выполните следующие шаги:

- Добавьте элемент управления Aspose.Cells.GridDesktop на вашу **форму**
- Обратитесь к любому желаемому **листу**
- Добавьте **Кнопку** в коллекцию **Элементы управления** данного **Листа**



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-AddingCellControls-AddingButton.cs" >}}


При добавлении **Кнопки** мы можем указать местоположение ячейки (где отображать), ширину и высоту, а также подпись кнопки.
#### **Обработка событий кнопки**
Мы говорили о добавлении элемента управления **Кнопка** на **Листе**, но какова польза от наличия кнопки на листе, если мы не можем ее использовать. Поэтому возникает необходимость обработки событий кнопки.

Для обработки события **Нажатие** элемента управления **Кнопка**, Aspose.Cells.GridDesktop предоставляет событие **НажатиеЯчейкиКнопки**, которое должно быть реализовано разработчиками в соответствии с их потребностями. Например, мы только выводим сообщение, когда кнопка нажата, как показано ниже:



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-AddingCellControls-HandlingButton.cs" >}}
#### **Указание Фонового Изображения для Элемента управления Кнопка**
Мы можем установить фоновое изображение/картинку для элемента управления кнопкой с ее меткой/текстом, как показано в коде ниже:



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-AddingCellControls-SetBackground.cs" >}}


**ВАЖНО:** Все события элементов управления ячейками содержат аргументы **СобытиеЭлементаУправленияЯчейкой** которые предоставляют номера строки и столбца ячейки, в которой содержится элемент управления ячейкой (событие которого было вызвано).
### **Добавление Флажка**
Чтобы добавить флажок на лист с помощью Aspose.Cells.GridDesktop, выполните следующие шаги:

- Добавьте элемент управления Aspose.Cells.GridDesktop на вашу **форму**
- Обратитесь к любому желаемому **листу**
- Добавьте **Флажок** в коллекцию **Элементы управления** данного **Листа**



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-AddingCellControls-AddingCheckbox.cs" >}}


При добавлении **Флажка** мы можем указать местоположение ячейки (где отображать) и состояние флажка.
#### **Обработка событий флажка**
Aspose.Cells.GridDesktop предоставляет событие **ИзменениеПроверкиЯчейки** которое срабатывает, когда состояние проверки флажка изменяется. Разработчики могут обрабатывать это событие в соответствии со своими требованиями. Например, мы только выводим сообщение, чтобы показать состояние проверки флажка в коде ниже:



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-AddingCellControls-HandlingCheckbox.cs" >}}
### **Добавление Полей Выбора**
Чтобы добавить комбобокс в таблицу с использованием Aspose.Cells.GridDesktop, выполните следующие шаги:

- Добавьте элемент управления Aspose.Cells.GridDesktop на вашу **форму**
- Обратитесь к любому желаемому **листу**
- Создайте массив элементов (или значений), которые будут добавлены в **комбобокс**
- Добавьте **комбобокс** в коллекцию **элементов управления** **листа**, указав местоположение ячейки (где будет отображаться комбобокс) и элементы/значения, которые будут отображаться при нажатии на комбобокс



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-AddingCellControls-AddingCombobox.cs" >}}
#### **Обработка событий комбобокса**
Aspose.Cells.GridDesktop предоставляет событие **CellSelectedIndexChanged**, которое срабатывает, когда **выбранный индекс** комбобокса изменяется. Разработчики могут обрабатывать это событие по своему усмотрению. Например, можно отобразить сообщение, чтобы показать **выбранный элемент** комбобокса:



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-AddingCellControls-HandlingCombobox.cs" >}}
