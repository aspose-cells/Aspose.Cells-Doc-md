---
title: Работа с Валидацией в Рабочих Листах
type: docs
weight: 70
url: /ru/net/aspose-cells-griddesktop/work-with-validations-in-worksheets/
keywords: GridDesktop, валидации, валидация
description: Эта статья рассказывает о работе с валидацией в GridDesktop.
---

{{% alert color="primary" %}} 

Aspose.Cells.GridDesktop также поддерживает добавление валидаций (или правил валидации) в ячейки рабочего листа. Применяя правила валидации к ячейкам, разработчики могут ограничить пользователей вводить данные в Grid в конкретном формате. Aspose.Cells.GridDesktop поддерживает различные режимы валидации. В этой теме мы не только обсудим эти режимы валидации, но и объясним манипуляции с ними.

{{% /alert %}} 
## **Режимы Валидации**
Aspose.Cells.GridDesktop поддерживает три режима валидации, как показано ниже:

- Режим Валидации Обязательного Заполнения
- Режим Валидации по Регулярным Выражениям
- Пользовательский Режим Валидации
### **Режим Валидации Обязательного Заполнения**
В этом режиме валидации пользователи ограничены вводить значения в определенные ячейки. После применения **Режима Валидации Обязательного Заполнения** к ячейке рабочего листа, пользователю необходимо ввести значение в эту ячейку.
### **Режим Валидации по Регулярным Выражениям**
В этом режиме на ячейки рабочего листа накладываются ограничения на пользователей для ввода данных в определенном формате. Шаблон формата данных предоставляется в виде **Регулярного Выражения**.
### **Пользовательский Режим Валидации**
Для использования **Пользовательской Валидации** разработчики должны реализовать интерфейс Aspose.Cells.GridDesktop.ICustomValidation. Интерфейс предоставляет метод **Validate**. Этот метод возвращает true, если данные допустимы, в противном случае возвращает false.
## **Работа с Валидацией в Aspose.Cells.GridDesktop**
### **Добавление Валидации**
Чтобы добавить любую валидацию к ячейке рабочего листа, выполните следующие действия:

- Добавьте элемент управления Aspose.Cells.GridDesktop на ваш **Форм**
- Получить доступ к любому желаемому **Рабочему листу**
- Добавить желаемую проверку в коллекцию **Проверок** для **Рабочего листа**, чтобы указать, какая проверка будет применяться к какой ячейке.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-ValidationInWorksheets-AddingValidation.cs" >}}

{{% alert color="primary" %}} 

На приведенной выше фигуре мы также упомянули правила проверки напротив ячеек, где эти правила проверки применяются. Если введено недопустимое значение (которое не является допустимым согласно определенному правилу проверки для этой ячейки), будет отображаться окно с сообщением **MessageBox**, чтобы уведомить пользователя о недопустимом вводе.

{{% /alert %}} 
### **Реализация ICustomValidation**
В приведенном выше отрывке кода мы добавили пользовательскую проверку в ячейке **A8**, но еще не реализовали эту пользовательскую проверку. Как мы объяснили в начале этой темы, для применения пользовательской проверки необходимо реализовать интерфейс **ICustomValidation**. Так что давайте попробуем создать класс для реализации интерфейса **ICustomValidation**.

В приведенном ниже отрывке кода мы реализовали пользовательскую проверку для выполнения следующих проверок:

- Проверить правильность адреса ячейки, в которой добавлена проверка
- Проверить, является ли тип данных значения ячейки двойным
- Проверить, является ли значение ячейки большим, чем 100



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-ValidationInWorksheets-ImplementingICustomInterface.cs" >}}
### **Доступ к проверке**
Как только проверка добавлена к конкретной ячейке рабочего листа, разработчикам может потребоваться получить доступ и изменить атрибуты конкретной проверки во время выполнения. Таким образом, Aspose.Cells.GridDesktop упростил разработчикам выполнение этой задачи.

Чтобы получить доступ к конкретной проверке, следуйте указанным ниже шагам:

- Получите доступ к желаемому **Рабочему листу**
- Получите доступ к конкретной **Проверке** на рабочем листе, указав имя ячейки, на которой была применена проверка
- Измените атрибуты **Проверки**, если необходимо



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-ValidationInWorksheets-AccessingValidation.cs" >}}

{{% alert color="primary" %}} 

Коллекция **Проверок** имеет два индексатора. Один индексатор (который используется в приведенном ниже примере) позволяет получать доступ к объекту **Проверки**, указав имя ячейки как его индекс, в то время как другой индексатор принимает два параметра (то есть номер строки и столбца), чтобы выполнить ту же задачу.

{{% /alert %}} 
### **Удаление проверки**
Чтобы удалить конкретную проверку с рабочего листа, следуйте указанным ниже шагам:

- Получите доступ к желаемому **Рабочему листу**
- Удалите конкретную **Проверку** с **Рабочего листа**, указав имя ячейки, на которой была применена проверка



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-ValidationInWorksheets-RemoveValidation.cs" >}}
