---
title: Сортировка данных листа
type: docs
weight: 80
url: /ru/net/aspose-cells-griddesktop/sorting-worksheet-data/
keywords: GridDesktop,сортировка,сортировка данных,сортировка данных,сортировка данных
description: В этой статье рассматривается способ сортировки данных на листе в GridDesktop.
---

{{% alert color="primary" %}} 

Сортировка - это важная рутинная задача, которую мы часто используем при обработке данных. В этой теме мы обсудим на примере, как можно отсортировать данные на листе.

{{% /alert %}} 
## **Сортировка данных в таблице**
Для сортировки данных в таблице с использованием API Aspose.Cells.GridDesktop, следуйте приведенным ниже шагам:

- Прежде всего создайте глобальный объект **CellRange**, чтобы его можно было получить в любом месте вашего класса
- Создайте обработчик события для события **SelectedCellRangeChanged** объекта **GridDesktop**. Событие **SelectedCellRangeChanged** вызывается каждый раз, когда выбранный пользователем диапазон ячеек изменяется. Например, если пользователь выбирает ячейки (с данными, которые нужно отсортировать), то каждый раз, когда его диапазон выбора изменяется, это событие вызывается.
- Обработчик события предоставляет аргумент **CellRangeEventArgs**, который далее предоставляет обновленный диапазон ячеек (выбранный пользователем) в виде объекта **CellRange**. Таким образом, в этом обработчике событий мы присвоим этот объект **CellRange** (с обновленным диапазоном ячеек) глобальному объекту **CellRange**, чтобы его можно было использовать в другой части кода. Чтобы убедиться, что мы не потеряем диапазон ячеек, мы напишем код обработчика событий внутри условия
- Теперь мы можем написать некоторый код для сортировки данных в таблице. Прежде всего получим доступ к нужной таблице
- Создайте объект **SortRange**, который будет хранить диапазон ячеек, данные которых нужно отсортировать. В конструкторе **SortRange** мы можем указать таблицу, индексы начальной строки и столбца, количество строк и столбцов для сортировки, ориентацию сортировки (например, сверху вниз или слева направо) и т.д.
- Теперь мы можем вызвать метод **Sort** объекта **SortRange** для выполнения сортировки данных. В методе **Sort** мы можем указать индекс столбца или строки для сортировки и порядок сортировки (который может быть **По возрастанию** или **По убыванию** в соответствии с вашими требованиями)
- Наконец, мы можем вызвать метод **Invalidate** объекта **GridDesktop** для перерисовки ячеек.

В приведенном ниже примере показано, как сортировать данные в столбце.

Создайте глобальный объект CellRange и событие **SelectedCellRangeChanged** объекта GridDesktop. Теперь напишите код, как показано ниже:



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-SortData-CheckingCellRange.cs" >}}


Теперь напишем метод для **Сортировки по возрастанию**. Вы можете создать кнопку для **Сортировки по возрастанию** и написать нижеуказанный код в ее событии **Click**.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-SortData-AscendingSort.cs" >}}


Наконец, напишем некоторый код для реализации функциональности **Сортировки по убыванию**. Создайте кнопку **Сортировка по убыванию** и напишите нижеуказанный код в ее событии **Click**.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithWorksheet-SortData-DescendingSort.cs" >}}
