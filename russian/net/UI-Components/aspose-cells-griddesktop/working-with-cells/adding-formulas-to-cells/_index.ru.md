---
title: Добавление формулы в ячейку
type: docs
weight: 30
url: /ru/net/aspose-cells-griddesktop/adding-formula-to-cell/
keywords: GridDesktop,formula
description: В этой статье рассматривается способ получения или установки формулы в ячейке в Рабочем листе в GridDesktop.
---

{{% alert color="primary" %}} 

Ячейка может содержать не только простое значение, такое как числовая фигура или некоторый текст, но и формулу как свое значение. Формула используется в ячейке, когда значение ячейки должно быть определено после некоторых вычислений. В этой теме мы обсудим, как получить доступ к формуле, примененной к ячейке, и изменить ее.

{{% /alert %}} 
## **Добавление формулы в ячейку**
Добавление формулы в ячейку подобно установке значения ячейки, о котором мы уже говорили в предыдущей теме: [Доступ и изменение значения ячейки](/cells/ru/net/accessing-and-modifying-the-value-of-a-cell/), за исключением того, что в этом случае мы добавляем простые значения в ячейки. Теперь мы будем добавлять формулы. Разработчики могут использовать свойство Value ячейки для доступа и изменения формулы, или же метод **SetCellValue** ячейки также может быть использован для добавления или изменения формулы в ячейке.

**ВАЖНО:** Основное различие между использованием свойства Value или метода **SetCellValue** ячейки заключается в том, что свойство Value автоматически вызывает метод **RunAllFormulas** Grid для пересчета значений всех формул, в то время как в случае метода **SetCellValue** разработчики должны явным образом вызывать метод **RunAllFormulas** после того, как формулы добавлены в ячейки. Фактически, при использовании метода **SetCellValue** ячейки этот метод устанавливает значение ячейки только для **FormulaType** и не вычисляет формулу. Более того, вызывать метод **RunAllFormulas** каждый раз не обязательно. Если вы хотите добавить много формул в ячейки рабочего листа, то вы можете вызвать метод **RunAllFormulas** всего один раз в конце.

Формула добавляется в ячейку как строковое значение. Кроме того, структура формулы должна быть совместима со структурой формул MS Excel. Все формулы должны начинаться с **Знака равенства (=)**.

В приведенном ниже примере мы добавили формулу для умножения значений двух ячеек рабочего листа и сохранения результата в другой ячейке. Метод **RunAllFormulas** также вызывается в конце.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithCells-AddingCellFormulas-1.cs" >}}



Теперь запустите приложение. Если вы дважды щелкните на ячейке, куда была добавлена формула, то вы заметите, что значение будет заменено формулой, которая фактически вычисляет значение на заднем плане.

{{% alert color="primary" %}} 

Aspose.Cells.GridDesktop поддерживает большинство распространенных функций MS Excel. Для получения более подробной информации о списке поддерживаемых функций, пожалуйста, [нажмите здесь.](/cells/ru/net/list-of-supported-functions/)

{{% /alert %}}
