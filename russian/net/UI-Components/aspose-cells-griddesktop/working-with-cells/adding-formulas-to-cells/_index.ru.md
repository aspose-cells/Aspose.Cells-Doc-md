---
title: Добавление формул в Cells
type: docs
weight: 30
url: /ru/net/adding-formulas-to-cells/
---
{{% alert color="primary" %}} 

Ячейка не может содержать только простое значение, например числовое число или какой-либо текст, но мы также можем вставить формулу в ячейку в качестве ее значения. Формула используется в ячейке, когда значение ячейки необходимо определить после некоторых вычислений. В этом разделе мы обсудим, как мы можем получить доступ и изменить формулу, примененную к ячейке.

{{% /alert %}} 
## **Добавление формулы к Cell**
 Добавление формулы в ячейку аналогично установке значения ячейки, как мы обсуждали в предыдущем разделе:[Доступ и изменение значения Cell](/cells/ru/net/accessing-and-modifying-the-value-of-a-cell/) за исключением того, что в этом случае мы просто добавили в ячейки простые значения. Теперь добавим формулы. Разработчики могут использовать свойство Value ячейки для доступа и изменения формулы или иным образом.**Сетцеллвалуе** Метод ячейки также можно использовать для добавления или изменения формулы в ячейке.

**ВАЖНЫЙ:** Основное различие между использованием свойства Value или**Сетцеллвалуе** метод ячейки заключается в том, что свойство Value вызывает**Выполнить все формулы** метод сетки автоматически пересчитывает значения всех формул, где, как и в случае с**Сетцеллвалуе** разработчики методов должны вызывать**Выполнить все формулы** метод явно после добавления формул в ячейки. На самом деле, когда мы используем**Сетцеллвалуе** метод ячейки, то этот метод устанавливает значение ячейки равным**Тип Формулы** только и не вычисляйте формулу. Более того, вызывая**Выполнить все формулы**Метод каждый раз не нужен. Если вы хотите добавить много формул в ячейки рабочего листа, вы можете вызвать**Выполнить все формулы** метод только один раз в конце.

 Формула добавляется в ячейку как строковое значение. Кроме того, структура формулы должна быть совместима со структурой формулы MS Excel. Все формулы должны начинаться с**Знак равенства (=)**.

 В приведенном ниже примере мы добавили формулу для умножения значений двух ячеек рабочего листа и сохранения результата в другой ячейке.**Выполнить все формулы** метод также вызывается в конце.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithCells-AddingCellFormulas-1.cs" >}}



Теперь запустите приложение. Если вы дважды щелкните ячейку, в которую была добавлена формула, вы заметите, что значение будет заменено формулой, которая фактически вычисляет значение на бэкэнде.

{{% alert color="primary" %}} 

 Aspose.Cells.GridDesktop поддерживает большинство часто используемых функций MS Excel. Подробнее о списке поддерживаемых функций см.[кликните сюда.](/cells/ru/net/list-of-supported-functions/)

{{% /alert %}}
