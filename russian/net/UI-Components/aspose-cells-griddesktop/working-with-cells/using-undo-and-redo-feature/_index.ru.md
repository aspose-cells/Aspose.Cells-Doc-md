---
title: Использование функции отмены и повтора
type: docs
weight: 120
url: /ru/net/using-undo-and-redo-feature/
---
{{% alert color="primary" %}} 

Функция Undo/Redo в GridDesktop очень полезна. Название объясняет саму его функциональность, оно позволяет вам отменить/повторить последние действия на листе. Например, если формула случайно удалена или вы редактируете данные в ячейке, которые на самом деле вам не нужны, эти действия можно исправить с помощью операций отмены и повтора, предоставляемых элементом управления.

{{% /alert %}} 
## **Выполнение операций отмены и повтора**
Для задачи доступны следующие API. Описание дается с каждым API, пожалуйста, проверьте их.

- **GridDesktop.EnableUndo** - атрибут: указывает, включена ли функция отмены, значение по умолчанию — «ложь».
- **UndoManager** – класс: используется для управления операцией отмены/повтора.
- **GridDesktop.UndoManager** - атрибут: он получает экземпляр**UndoManager** объект.
- **UndoManager.Отменить** – метод: выполняет операцию отмены.
- **UndoManager.Повторить -** метод: он выполняет операцию повтора.
- **UndoManager.ClearStack** – метод: очищает стек отмены/возврата.
- **UndoManager.UndoStepsCount** - атрибут: получает количество текущих доступных шагов отмены.
- **UndoManager.RedoStepsCount** - атрибут: получает количество текущих доступных повторных шагов.
- **UndoManager.UndoStackSize** - атрибут: получает/устанавливает размер стека отмены.
### **Отменить**
В следующем примере кода показано, как реализовать операцию отмены с помощью GridDesktop API.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithCells-UndoRedoFeature-Undo.cs" >}}
### **Повторить**
В следующем примере кода показано, как реализовать операцию повтора с помощью GridDesktop API.



{{< gist "aspose-cells-gists" "e204d6243cc67d7d255d51c9b85b2c64" "Examples.GridDesktop-CSharp-GridDesktop.Examples-WorkingWithCells-UndoRedoFeature-Redo.cs" >}}

{{% alert color="primary" %}} 

В настоящее время операция отмены/повтора относится к изменению значения ячейки.

{{% /alert %}}
