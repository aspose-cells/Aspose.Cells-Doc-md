---
title: Написать скрипт на стороне клиента GridWeb
type: docs
weight: 10
url: /ru/net/write-gridweb-client-side-script/
---
{{% alert color="primary" %}} 

Разработчики могут писать сценарии на стороне клиента для элемента управления Aspose.Cells.GridWeb. Это означает, что можно вызвать функцию JavaScript на стороне клиента для выполнения конкретной задачи, связанной с элементом управления GridWeb. Например, разработчики могут писать функции JavaScript для отправки данных GridWeb на сервер или отображения предупреждающего сообщения при возникновении ошибки проверки и т. д.

В этом разделе эта функция объясняется с помощью примеров.

{{% /alert %}} 
## **Написание сценариев на стороне клиента для Aspose.Cells.GridWeb**
### **Основная информация**
Aspose.Cells.GridWeb предоставляет два свойства, созданные специально для поддержки сценариев на стороне клиента:

- OnSubmitClientFunction
- OnValidationErrorClientFunction

Создайте функции JavaScript на странице ASPX и назначьте имена этих функций свойствам OnSubmitClientFunction и OnValidationErrorClientFunction.

{{% alert color="primary" %}} 

Функция JavaScript, которая будет назначена свойству OnSubmitClientFunction, должна быть правильно определена, как показано ниже:

**JavaScript**

{{< highlight "csharp" >}}

 function function_name(arg, cancelEdit)

 {

   //Add javascript code here

 }



{{< /highlight >}}

где параметр [arg] представляет команду, сгенерированную элементом управления. Команда может быть «Сохранить», «Отправить», «Отменить» и т. д., а параметр [cancelEdit] является логическим значением, которое указывает, отменен ли ввод пользователя или нет.

Любая функция JavaScript, назначенная свойству OnSubmitClientFunction, каждый раз вызывается элементом управления GridWeb перед отправкой данных GridWeb на сервер. Точно так же, если функция назначена свойству OnValidationErrorClientFunction, эта функция будет вызываться каждый раз при возникновении ошибки проверки.

{{% /alert %}} 
### **Функции для сценариев на стороне клиента**
Aspose.Cells.GridWeb также предоставляет функции, особенно для сценариев на стороне клиента. Эти функции можно использовать в функциях JavaScript, чтобы лучше контролировать Aspose.Cells.GridWeb. Эти клиентские функции включают следующее:

|**Функции**|**Описание**|
|:- |:- |
|updateData(bool отменаEdit)|Обновляет все клиентские данные Aspose.Cells.GridWeb перед их отправкой на сервер. Если параметр cancelEdit имеет значение true, то GridWeb отбрасывает все вводимые пользователем данные.|
|проверить все()|Используется для проверки наличия ошибок проверки вводимых пользователем данных. В случае ошибки функция возвращает false, в противном случае — true.|
|submit(string arg, bool cancelEdit)|Вызовите эту функцию для обратной передачи или отправки данных на сервер. Эта функция выполняет обе задачи по обновлению данных и проверке ввода пользователя. Эта функция также может запускать командное событие на стороне сервера. Используйте параметр arg для передачи вашей команды. Например: команда СОХРАНИТЬ используется для нажатия кнопки**Сохранять** на панели команд элемента управления GridWeb, а команда CCMD:MYCOMMAND запускает событие CustomCommand.|
|setActiveCell (целая строка, целая колонка)|Используется для активации определенной ячейки.|
|setCellValue (строка int, столбец int, строковое значение)|Используется для помещения значения в любую ячейку, указанную с помощью номеров строк и столбцов.|
|getCellValue (целая строка, целочисленный столбец)|Возвращает значение любой указанной ячейки.|
|получить активную строку ()|Используется в сочетании с функцией getActiveColumn() для определения позиции активной ячейки.|
|получитьактивеколонн()|Используется в сочетании с функцией getActiveRow() для определения позиции активной ячейки.|
|получитьвыбордиапазона()|Возвращает последний выбранный диапазон.|
|установитьдиапазон выбора()|Выбирает заданный диапазон.|
|очистить выборки ()|Очищает все выделение, кроме текущей активной ячейки.|
|получить массив ячеек ()| Он используется с другими связанными функциями, такими как getCellName(), getCellValueByCell(), getCellRow() и getCellColumn(). Пожалуйста, прочитайте эту статью для получения дополнительной информации об использовании этой функции:[Чтение значений ячеек GridWeb на стороне клиента](/cells/ru/net/read-the-values-of-the-gridweb-cells-on-client-side/)|
Чтобы создать тестовое приложение, содержащее клиентские сценарии, работающие с Aspose.Cells.GridWeb, выполните следующие действия:

1. Создайте функции JavaScript, которые будут вызываться GridWeb.
 Эти функции будут добавлены на страницу ASP.NET.<script></script>ярлык.
1. Назначьте имена функций свойствам OnSubmitClientFunction и OnValidationErrorClientFunction.

Вывод примера кода показан ниже:

**Проверка добавлена в ячейку C1** 

![дело:изображение_альтернативный_текст](write-gridweb-client-side-script_1.png)

 Добавьте недопустимое значение и нажмите**Сохранять**. Возникает ошибка проверки, и выполняется функция ValidationErrorFunction.

**ValidationErrorFunction вызывается при ошибке проверки** 

![дело:изображение_альтернативный_текст](write-gridweb-client-side-script_2.png)

 Пока вы не введете допустимое значение, никакие данные не будут отправлены на сервер. Введите допустимое значение и нажмите**Сохранять**. ConfirmFunction выполняется.

**ConfirmFunction вызывается перед отправкой данных GridWeb на сервер** 

![дело:изображение_альтернативный_текст](write-gridweb-client-side-script_3.png)



{{< gist "aspose-cells-gists" "7c644a93d33d24299a618c1dda1a2385" "Examples.GridWeb-CSharp-GridWebBasics-WriteClientSideScript-WriteClientSideScript.aspx" >}}

{{< gist "aspose-cells-gists" "7c644a93d33d24299a618c1dda1a2385" "Examples.GridWeb-CSharp-GridWebBasics-WriteClientSideScript.aspx-WriteClientSideScript.cs" >}}
