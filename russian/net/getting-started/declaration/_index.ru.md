---
title: Декларация
type: docs
weight: 30
url: /ru/net/declaration/
---
{{% alert color="primary" %}} 

Как правило, для всех компонентов Aspose .NET требуется набор разрешений Full Trust. Причина в том, что компоненты Aspose for .NET нуждаются в доступе к настройкам реестра, системным файлам, отличным от виртуального каталога, для определенных операций, таких как синтаксический анализ шрифтов и т. д. Более того, компоненты Aspose for .NET (включая Aspose.Cells for .NET) основаны на основных системных классах .NET, для которых также требуются разрешения Full Trust. устанавливается во многих случаях.

{{% /alert %}} 
## **Испытание на частичное доверие / среднее доверие**
Интернет-провайдеры, размещающие несколько приложений от разных компаний, в основном применяют уровень безопасности Medium Trust. Кроме того, иногда вам нужно разместить несколько приложений на общем сервере, например, у интернет-провайдера или в других сценариях, вы должны использовать средний уровень доверия для ограничения приложений. Средний уровень доверия ASP.NET обеспечивает ограниченную среду выполнения, подходящую для изоляции нескольких приложений, размещенных на серверах ISP. В случае .NET 2.0 такой уровень безопасности может устанавливать следующие ограничения, которые могут повлиять на способность Aspose.Cells for .NET работать должным образом, например:

- **Разрешение реестра недоступно**. Это означает, что вы не можете получить доступ к реестру, который требуется для перечисления установленных шрифтов при отображении электронных таблиц или других документов.
- **FileIOPermission ограничен**Это означает, что вы можете получить доступ только к файлам в иерархии виртуальных каталогов вашего приложения. Это потенциально означает, что шрифты не могут быть прочитаны во время экспорта.
## **Используйте Aspose.Cells for .NET для набора разрешений со средним доверием**
Вы можете следовать некоторым рекомендациям по запуску Aspose.Cells for .NET на среднем уровне доверия или в среде общего сервера:

- Чтобы установить файл лицензии в свой код, лучше вместо этого вызвать метод License.SetLicense(Stream) после получения файла лицензии в потоки.
- Каталог шрифтов (к которому можно получить доступ с разрешения) должен быть установлен. Если нет возможности получить доступ к файлу на сервере, добавьте необходимые файлы шрифтов в свое приложение.
- В режиме частичного доверия преобразование Shape-to-EMF не поддерживается, поэтому установите тип экспортируемого изображения (для фигур) в другой формат изображения.

См. следующий пример, демонстрирующий использование/запуск Aspose.Cells for .NET в режиме среднего доверия.

{{< highlight "csharp" >}}

 // Instantiate the License object

Aspose.Cells.License lic = new Aspose.Cells.License();

// Get the license file into stream

System.IO.Stream stream = System.IO.File.OpenRead(MapPath("~") + @"\Aspose.Cells.lic");

// Set the License stream

lic.SetLicense(stream);

// Close the stream

stream.Close();

// Set the fonts directory

CellsHelper.FontDir = MapPath("~") + @"\Fonts";

//Open the template file

Workbook workbook = new Workbook(MapPath("~") + @"\test.xlsx");

PdfSaveOptions pdfSaveOptions = new PdfSaveOptions();

// Set the image type to other format instead of using the default image type, that is, EMF

pdfSaveOptions.ImageType = System.Drawing.Imaging.ImageFormat.Png;

// Save the PDF file

workbook.Save(MapPath("~") + @"\dest.pdf", pdfSaveOptions);

// Save the XLSX file

workbook.Save(MapPath("~") + @"\dest.xlsx");



{{< /highlight >}}





