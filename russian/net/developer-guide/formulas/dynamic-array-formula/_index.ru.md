---
title: Установка формул динамического массива
description: Как использовать библиотеку Aspose.Cells для расчета формул динамических массивов в Microsoft Excel. Загрузив существующий файл Excel или создав новый файл Excel, мы можем использовать метод, предоставленный Aspose.Cells, для расчета формулы динамического массива и получения результата. Наконец, мы сохраняем измененный файл Excel на диск.
keywords: Dynamic Array Formulas, Dynamic Array Formulas in Excel, Set dynamic array formulas, Calculation of dynamic array formulas, operate dynamic array formulas of Excel.
type: docs
weight: 70
url: /ru/net/calculation-of-dynamic-array-formulas/
---
##  **Что такое формула массива Excel**
В Excel формула массива — это особый тип формулы, который позволяет выполнять вычисления с массивами данных, а не с отдельными ячейками. Формулы массива можно использовать для выполнения сложных вычислений, манипулирования данными и эффективного решения конкретных задач. Они вводятся иначе, чем обычные формулы, и часто требуют использования Ctrl+Shift+Enter.

Вот некоторые ключевые моменты, касающиеся формул массива в Excel:
1. Синтаксис:
<br>
Формулы массивов записываются как обычные формулы, но включают операции с массивами значений. Они заключены в фигурные скобки { }, чтобы указать, что они являются формулами массива. Однако вы не вводите эти фигурные скобки самостоятельно; Excel добавит их автоматически, если вы правильно введете формулу.
1. Ввод формул массива:
<br>
Чтобы ввести формулу массива, введите формулу в строку формул. Вместо нажатия Enter для завершения нажмите Ctrl + Shift + Enter. Это сообщает Excel, что это формула массива. При правильном вводе Excel отображает формулу в фигурных скобках в строке формул, указывая, что это формула массива.
1. Случаи использования:
<br>
Формулы массива полезны для одновременного выполнения вычислений в нескольких ячейках или диапазонах. Их можно использовать для сложных математических вычислений, условных операций, фильтрации данных и многого другого.
1. Преимущества:
<br>
Формулы массива позволяют выполнять сложные вычисления с помощью одной формулы, что может повысить эффективность и упростить рабочие таблицы. Они могут обрабатывать большие наборы данных и выполнять вычисления, которые в противном случае потребовали бы нескольких промежуточных шагов.
1. Ограничения:
<br>
Формулы массива могут быть более трудными для понимания и устранения неполадок, чем обычные формулы. Они могут снизить производительность листа, особенно при интенсивном использовании или с большими наборами данных.
1. Примеры:
<br>
 Суммирование значений в диапазоне:**{=СУММ(A1:A5*B1:B5)}**
<br>
 Нахождение максимального значения в диапазоне:**{=МАКС(A1:A5+B1:B5)}**
<br>
<image src="1.png" width="70%" />
<br>

Помните, что формулы массива следует использовать разумно, и важно понимать, как они работают, прежде чем применять их на своих листах. Они могут быть мощными инструментами для анализа и обработки данных в Excel.

##  **Что такое формула динамического массива Excel**
Формулы динамических массивов — это новая функция, представленная в Excel 365 и Excel 2021. Они позволяют работать с массивами данных более плавно и эффективно по сравнению с традиционными формулами массивов. Формулы динамических массивов автоматически распределяют результаты в соседние ячейки, устраняя необходимость в использовании Ctrl + Shift + Enter и упрощая манипулирование данными.

Ключевые моменты о формулах динамических массивов в Excel:
1. Автоматический разлив:
<br>
Формулы динамических массивов автоматически распределяют результаты по соседним ячейкам в зависимости от размера выходных данных. Это означает, что вам не нужно выделять диапазон ячеек перед вводом формулы или использовать Ctrl + Shift + Enter для подтверждения формулы.
1. Single-Cell Запись:
<br>
Формулы динамического массива вводятся в одну ячейку, и Excel автоматически заполняет соседние ячейки результатами. Это упрощает управление формулами и их понимание, поскольку вам нужно ввести формулу только один раз.
1. Новые функции:
<br>
В формулах динамических массивов представлены новые функции, которые могут обрабатывать массивы собственными средствами, например *FILTER**, *SORT**, *UNIQUE**, *SEQUENCE**, *SORTBY** и *RANDARRAY**. Эти функции могут возвращать несколько значений или напрямую манипулировать массивами, упрощая сложные вычисления.
1. Гибкая обработка диапазона:
<br>
Формулы динамического массива динамически корректируют размер расширенного диапазона в зависимости от размера входных данных или выполненных вычислений. Такая гибкость позволяет более эффективно использовать пространство рабочего листа и упрощает создание формул.
1. Улучшенная производительность:
<br>
Формулы динамических массивов могут повысить производительность по сравнению с традиционными формулами массивов, особенно при работе с большими наборами данных или сложными вычислениями.
1. Совместимость:
<br>
Формулы динамических массивов доступны в Excel 365 и Excel 2021. Они могут не поддерживаться в более старых версиях Excel.
1. Примеры формул динамических массивов:
<br>
*ФИЛЬТР**: возвращает массив значений, соответствующих указанным критериям.
<br>
*СОРТИРОВКА**: сортирует значения в диапазоне или массиве.
<br>
*UNIQUE**: возвращает уникальные значения из списка или диапазона.
<br>
*SEQUENCE**: генерирует последовательность чисел или дат.
<br>
*RANDARRAY**: генерирует массив случайных чисел.
<br>
<image src="2.png" width="70%" />
<br>

Формулы динамических массивов предлагают мощные возможности для манипулирования и анализа данных в Excel, упрощая работу с массивами данных и эффективно выполняя сложные вычисления.

##  **В чем разница формул массива и формул динамического массива в Excel**
В Excel и формулы массива, и формулы динамического массива используются для одновременного выполнения вычислений над несколькими значениями, но они имеют некоторые различия с точки зрения функциональности и способа их реализации.

###  **Возможности формул массива**
1. Формулы массивов — это традиционные формулы Excel, которые позволяют выполнять вычисления с массивами данных.
1. Они вводятся нажатием Ctrl + Shift + Enter после ввода формулы, что сообщает Excel, что это формула массива.
1. Формулы массива имеют ограничения с точки зрения способности распределять результаты по соседним ячейкам. Обычно они возвращают одиночный результат 1., хотя этот результат может быть массивом ячеек.
1. Они существуют уже давно и поддерживаются во всех версиях Excel.

###  **Возможности формул динамических массивов**
1. Формулы динамических массивов — это новая функция, представленная в Excel 365 (подписка на Office 365) и Excel 2021.
1. Они автоматически распределяют результаты по соседним ячейкам в зависимости от размера входных данных или расчета формулы.
1. Формулы динамических массивов не требуют нажатия Ctrl + Shift + Enter; вы просто вводите формулу в одну ячейку, и Excel автоматически заполняет соседние ячейки результатами.
1. Эти формулы имеют возможность возвращать несколько результатов (диапазон ячеек) напрямую без необходимости использования формулы массива или сочетания клавиш Ctrl + Shift + Enter.
1. У них есть новые функции, такие как *FILTER**, *SORT**, *UNIQUE** и т. д., которые могут обрабатывать массивы естественным образом и возвращать результаты в формате динамического массива.
Подводя итог, формулы динамических массивов — это более современный и удобный способ работы с массивами в Excel, обеспечивающий автоматическое распределение результатов и упрощающий процесс работы с массивами по сравнению с традиционными формулами массивов. Однако они доступны только в новых версиях Excel, поддерживающих динамические массивы.

##  **Как задать и вычислить формулы динамических массивов в Excel**
 Настройка формул динамических массивов в Excel предполагает использование специальных функций, которые предназначены для работы с массивами данных и позволяют автоматически переносить результаты в соседние ячейки.

Вот пошаговое руководство по настройке формул динамического массива:
1. Выберите Cell:
<br>
Выберите ячейку, в которой вы хотите, чтобы отображались результаты формулы динамического массива. Формулы динамических массивов распределяют результаты по соседним ячейкам, поэтому убедитесь, что для разделенных выходных данных достаточно места.
1. Введите формулу:
<br>
Введите формулу динамического массива в строку формул выбранной ячейки. Используйте одну из функций динамических массивов, доступных в Excel 365 и Excel 2021, например *FILTER**, *SORT**, *UNIQUE**, *SEQUENCE**, *SORTBY** или *RANDARRAY**.
<br>
Например, вы можете использовать функцию ФИЛЬТР для фильтрации списка данных по определенным критериям: *=ФИЛЬТР(A2:C15,(A2:A15=F4)*(C2:C15=G4),"")**.
<br>
<image src="3.png" width="70%" />
<br>
1. Нажмите Ввод:
<br>
После ввода формулы просто нажмите Enter на клавиатуре. В отличие от традиционных формул массива, вам не нужно нажимать Ctrl + Shift + Enter.
1. Наблюдайте за разлитым диапазоном:
<br>
Excel автоматически распределяет результаты формулы в соседние ячейки. Распространенный диапазон динамически корректируется в зависимости от размера выходных данных или вычислений, выполняемых по формуле. Excel выделяет потерянный диапазон рамкой и значком диагональной стрелки, чтобы указать, что он содержит потерянные данные.
1. Взаимодействуйте с Разлитым диапазоном:
<br>
Вы можете взаимодействовать с расширенным диапазоном так же, как и с любым другим диапазоном ячеек в Excel. Используйте расширенный диапазон в других формулах, выполняйте над ним вычисления, форматируйте его или ссылайтесь на него в диаграммах или таблицах.
1. Обновите формулу:
<br>
Если вам нужно изменить формулу динамического массива, просто отредактируйте формулу в исходной ячейке, в которую она была введена.
После редактирования снова нажмите Enter, чтобы подтвердить изменения. При необходимости Excel автоматически обновит расширенный диапазон.
1. Очистка разлитого диапазона:
<br>
Если вы хотите очистить потерянные данные, вы можете удалить формулу из исходной ячейки. Excel также очистит потерянный диапазон. Кроме того, вы можете удалить разлитый диапазон напрямую, выделив его и нажав клавишу «Удалить».
<br>

Выполнив эти шаги, вы сможете настроить формулы динамических массивов в Excel для эффективного анализа массивов данных и управления ими, что упростит задачи анализа данных и составления отчетов.

##  **Как установить и обновить формулы динамического массива с помощью Aspose.Cells**
 См. следующий пример кода, который загружает[образец файла Excel](dynamicArrayFormula.xlsx)который содержит некоторые фиктивные данные. После загрузки файла вызовите[Cell.SetDynamicArrayFormula](https://reference.aspose.com/cells/net/aspose.cells/cell/setdynamicarrayformula/#setdynamicarrayformula)функция для установки формулы динамического массива и[Workbook.RefreshDynamicArrayFormulas](https://reference.aspose.com/cells/net/aspose.cells/workbook/refreshdynamicarrayformulas/#refreshdynamicarrayformulas) функция обновления формул динамического массива перед вызовом вычисления формулы и, наконец, сохранение книги как[выходной файл Excel](out.xlsx). 

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Formulas-dynamic-array-formulas.cs" >}}

Выходной снимок:
<br>
<image src="4.png" width="70%" />