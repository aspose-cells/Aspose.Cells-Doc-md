---
title: Умное импортирование и размещение данных с помощью умных маркеров
linktitle: Умные маркеры
type: docs
weight: 190
url: /ru/net/using-smart-markers/
description: Умный импорт и размещение данных согласно шаблонам файлов Excel с помощью библиотеки Aspose.Cells.
---

## **Почему импортировать данные в Excel с помощью умных маркеров**
Использование умных маркеров для импорта данных в Excel упрощает интеграцию данных, объединяя дизайн на основе шаблонов с динамической привязкой данных. Этот подход особенно ценен в таких инструментах, как Aspose.Cells, где маркеры выступают в роли заполнителей в шаблонах для автоматического заполнения данными из различных источников. Ниже приведены ключевые причины для применения этого метода:

1. Эффективность в повторяющихся отчетах: Повторное использование шаблонов, предварительно разработанные Excel-шаблоны с встроенными маркерами (например, &=$VariableName, &=DataSource.Field) могут использоваться для нескольких наборов данных, исключая ручное перепроектирование. Например, финансовые отчеты или листы запасов требуют только обновления источника данных, а не пересоздания макета. Автоматическая привязка данных, умные маркеры напрямую связываются с источниками данных (например, базами данных, JavaBeans, массивами). Изменения в исходных данных автоматически отражаются в итоговом файле Excel после обработки, что уменьшает риски ошибок при копировании и вставке.

2. Поддержка сложных структур данных: Интеграция из нескольких источников, один шаблон может объединять данные из различных источников (например, переменных, массивов, ResultSets). Обработка иерархий данных, вложенные данные (например, сгруппированные записи) могут обрабатываться с помощью маркеров вроде &=subtotal9:Person.id для автоматической генерации сводных таблиц (сумм, средних) по группам прямо в Excel.

3. Сохранение функциональности Excel: Умные маркеры сосуществуют с функциями Excel, такими как формулы, условное форматирование и диаграммы. Например: динамические вычисления с использованием &==C{r}*D{r} применяются для формул с учетом строки во время вставки данных. Шаблоны сохраняют предустановленные стили (например, заголовки, цвета ячеек), обеспечивая последовательность без необходимости дополнительных корректировок после импорта.

4. Расширенные возможности автоматизации: Интеграция собственных источников данных, разработчики могут реализовать интерфейсы вроде ICellsDataTable (.NET) для отображения собственных структур данных в маркерах. Эта гибкость поддерживает работу с реальными данными из API или датчиков. Массовая обработка, такие инструменты, как WorkbookDesigner в Aspose.Cells, позволяют выполнять пакетные операции (например, генерировать более 1000 счетов-фактур за один запуск), пересекаясь по наборам данных.

5. Снижение затрат на разработку и поддержание: Разделение логики и дизайна, дизайнеры управляют шаблонами в Excel (без кодирования), а разработчики — логикой данных. Эта разделенность ускоряет итерации. Снижение ошибок, автоматическая картаикация данных минимизирует риски manual entry. Например, данные сенсоров, анализируемые в VC++, могут быть автоматически заполнены в шаблоны Excel через интерфейсы объектов, что предотвращает ошибки транскрипции.

## **Пример кода для импорта DataTable с помощью умных маркеров**
Следующий пример кода содержит источник данных из 6 записей. Нам нужно показать только 3 записи на одном листе, остальные автоматически переместятся на второй лист. Обратите внимание, что второй лист должен также содержать тот же тег умных маркеров, и вы должны вызвать метод [WorkbookDesigner.Process(sheetIndex, isPreserved)](https://reference.aspose.com/cells/net/aspose.cells.workbookdesigner/process/methods/2) для обоих листов. Посмотрите сгенерированный кодом пример итогового файла Excel ([SmartMarkerDataTableToExcel.xlsx](SmartMarkerDataTableToExcel.xlsx)) для ориентира.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "SmartMarkers-ImportDataTableToExcel.cs" >}}

## **Пример кода для импорта данных JSON с умными маркерами**
Aspose.Cells for .NET поддерживает json-данные в умных маркерах. Пример загружает шаблон таблицы, умно импортирует JSON-данные для заполнения и затем рассчитывает данные таблицы. Пожалуйста, проверьте [шаблон файла](table.xlsx), [json-файл](table.json) и скриншот сгенерированного файла excel с помощью этого кода.

|**Первый лист файла table.xlsx с отображением умных маркеров.**|
| :- |
|![todo:image_alt_text](tabletemplate.png)|

|**Скриншот выходного файла Excel.**|
| :- |
|![todo:image_alt_text](tableresult.png)|

Следующие данные JSON:
```json data
{
	"Items" : [
		{
			"ItemName" : "A123",
			"Description" : "Peonies",
			"Qty" : "55",
			"UnitPrice" : "3.05"			
		},
		{
			"ItemName" : "B456",
			"Description" : "Tulips",
			"Qty" : "45",
			"UnitPrice" : "2.66",
		},
		{
			"ItemName" : "K789",
			"Description" : "Buttercup",
			"Qty" : "68",
			"UnitPrice" : "8.35",
		}
	]
}
```
Приведенный ниже пример показывает, как это работает.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "SmartMarkers-ImportJsonToTable.cs" >}}

## **Пример кода для импорта вложенных объектов с умными маркерами**
Aspose.Cells поддерживает вложенные объекты в умных маркерах, вложенные объекты должны быть простыми. Мы используем простой файл шаблона. Смотрите дизайнерскую электронную таблицу, содержащую некоторые вложенные умные маркеры.

|**Первый лист файла SM_NestedObjects.xlsx, показывающий вложенные умные маркеры.**|
| :- |
|![todo:image_alt_text](using-smart-markers_7.png)|
Приведенный ниже пример показывает, как это работает.


{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-SmartMarkers-UsingNestedObjects-1.cs" >}}


## **Продвинутые темы**
- [Параметры умных маркеров](/cells/ru/net/smart-marker-parameters/)
- [Добавление анонимного или пользовательского объекта в умные маркеры.](/cells/ru/net/adding-anonymous-or-custom-object-into-smartmarkers/)
- [Автоматическое заполнение данных умного маркера в другие листы, если данные слишком большие](/cells/ru/net/auto-populate-smart-marker-data-to-other-worksheets-if-data-is-too-large/)
- [Форматирование умных маркеров.](/cells/ru/net/formatting-smart-markers/)
- [Получение уведомлений во время слияния данных с умными маркерами](/cells/ru/net/getting-notifications-while-merging-data-with-smart-markers/)
- [Установить пользовательский источник данных для WorkbookDesigner.](/cells/ru/net/set-custom-datasource-for-workbookdesigner/)
- [Показывать ведущую апостроф в ячейках.](/cells/ru/net/show-leading-apostrophe-in-cells/)
- [Использование параметра Formula в умном маркере](/cells/ru/net/using-formula-parameter-in-smart-marker-field/)
- [Умный импорт элементов массива по индексу в Excel с помощью умных маркеров](/cells/ru/net/how-to-import-array-element-by-index-with-smart-markers/)
- [Умный импорт элементов массива с помощью среза в Excel с помощью умных маркеров](/cells/ru/net/how-to-import-array-element-by-slicer-with-smart-markers/)
- [Умный импорт JSON в Excel с помощью умных маркеров](/cells/ru/net/how-to-import-json-into-excel-with-smart-markers/)
- [Умный импорт вложенных объектов в Excel с помощью умных маркеров](/cells/ru/net/how-to-import-nested-objects-with-smart-markers/)
- [Умный импорт переменных массивов в Excel с помощью умных маркеров](/cells/ru/net/how-to-import-variable-arrays-with-smart-markers/)
- [Как использовать маркеры изображений в умных маркерах](/cells/ru/net/how-to-use-image-markers-in-smart-markers/)
- [Как группировать данные в умных маркерах](/cells/ru/net/how-to-group-data-in-smart-markers/)

{{< app/cells/assistant language="csharp" >}}
