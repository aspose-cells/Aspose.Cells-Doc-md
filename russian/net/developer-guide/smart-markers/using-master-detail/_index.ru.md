---
title: Умное импортирование данных мастера и деталей в Excel с помощью умных маркеров
type: docs
weight: 30
url: /ru/net/how-to-use-master-and-details-with-smart-markers/
---

## **Возможные сценарии использования**
Иногда необходимо генерировать динамические отчеты в Excel, которые включают комплексную основную панель и несколько детальных листов. Среди них один основной таблицей дает обзор, показывая различные варианты продуктов, а каждый соответствующий детальный лист содержит конкретные и углубленные данные для одного варианта. Aspose.Cells идеально подходит для выполнения этой задачи через мастер и детали с помощью умных маркеров.


## **Параметры умных маркеров для мастера и деталей**
Чтобы импортировать данные мастера и деталей в Excel, используйте следующие параметры умных маркеров:

| Параметр | Описание | Допустимые значения(синтаксис) | Ограничения | Необязательно | Поведение по умолчанию | Ограничения Excel |
| --- | --- | --- | --- | --- | --- | --- |
| `DetailSheet` | Укажите имя листа деталей, хранящегося в шаблонном файле. | Строка | Значение должно быть либо null, либо имя листа. Если null, это лист для деталей. Он должен быть обычной строкой. Поддержка переменных отсутствует. | Если пропущено, не мастер и не лист деталей. | Обычный лист, не мастер и не лист деталей. | |
| `DetailTable` | Укажите имя таблицы листа деталей в шаблонном файле. | Строка | | Если пропущено, умный маркер в листе деталей должен быть похож на мастер-лист, иначе источник данных определить нельзя. | Если пропущено, умный маркер в листе деталей должен быть похож на мастер-лист, иначе источник данных определить нельзя. | |
| `DetailSheetNewName` | Укажите имя нового созданного листа деталей. | Формула Excel, похожая на выражение | Должна быть действительной формулой Excel, если заменить переменную ({a.bc}) на простое значение. | Если пропущено, новые листы будут называться Sheet1, Sheet2... | Если пропущено, новые листы будут называться Sheet1, Sheet2... | Имя должно быть действительным именем листа. |
| `DetailLink` | Указать, добавлять ли гиперссылки на местоположение импортированных данных. | | |Если пропущено, гиперссылки не добавляются. | Если пропущено, гиперссылки не добавляются. | |

## **Как использовать мастер и детали, когда мастер и детали в одном листе**
Иногда необходимо импортировать данные мастера и деталей в excel в SmartMarkers. Aspose.Cells позволяет использовать параметры мастер и детали в умных маркерах. Пожалуйста, ознакомьтесь с [шаблонным файлом](MasterDetailInOneSheet.xlsx), [json файлом](MasterDetailData.json) и скриншотом выходного файла Excel, созданного с помощью следующего кода.

|**Первый рабочий лист template.xlsx.**|
| :- |
|![todo:image_alt_text](1.png)|

|**Первый рабочий лист выходного файла Excel.**|
| :- |
|![todo:image_alt_text](2.png)|

|**Второй рабочий лист выходного файла Excel.**|
| :- |
|![todo:image_alt_text](3.png)|

Следующие данные JSON:
```json data
{
	"node": {
		"Styles1": [
			{
				"StyleID": "1style001",
				"StyleName": "StyleName1",
				"Quantity": 6,
				"UnitPrice": 18.45,
				"MaterialType":"Cotton"
			}
		],
		"Styles2": [
			{
				"StyleID": "2style001",
				"StyleName": "Cotton StyleName2",
				"Quantity": 6,
				"UnitPrice": 18.45,
				"MaterialType":"Cotton"
			},
			{
				"StyleID": "2style002",
				"StyleName": "Denim StyleName2",
				"Quantity": 8,
				"UnitPrice": 58.8,
				"MaterialType":"Denim"
			}
		]
	}
}
```
Приведенный ниже пример показывает, как это работает.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "SmartMarkers-Using-Master-Details-InOneSheet.cs" >}}

## **Как использовать мастер и детали, когда мастер и детали в разных листах**
Иногда необходимо импортировать данные мастера и деталей в excel в SmartMarkers. Aspose.Cells позволяет использовать параметры мастер и детали в умных маркерах. Пожалуйста, ознакомьтесь с [шаблонным файлом](MasterDetailInTwoSheets.xlsx), [json файлом](MasterDetailData.json) и скриншотом выходного файла Excel, созданного с помощью следующего кода.

|**Первая мастер-таблица шаблона.xlsx.**|
| :- |
|![todo:image_alt_text](4.png)|

|**Вторая мастер-таблица шаблона.xlsx.**|
| :- |
|![todo:image_alt_text](5.png)|

|**Детальная таблица шаблона.xlsx.**|
| :- |
|![todo:image_alt_text](6.png)|

|**Первая мастер-таблица файла результата excel.**|
| :- |
|![todo:image_alt_text](7.png)|

|**Вторая мастер-таблица файла результата excel.**|
| :- |
|![todo:image_alt_text](8.png)|

|**Детальная таблица первой мастер-таблицы в файле результата excel.**|
| :- |
|![todo:image_alt_text](9.png)|

|**Первая детальная таблица второй мастер-таблицы в файле результата excel.**|
| :- |
|![todo:image_alt_text](10.png)|

|**Вторая детальная таблица второй мастер-таблицы в файле результата excel.**|
| :- |
|![todo:image_alt_text](11.png)|

Следующие данные JSON:
```json data
{
	"node": {
		"Styles1": [
			{
				"StyleID": "1style001",
				"StyleName": "StyleName1",
				"Quantity": 6,
				"UnitPrice": 18.45,
				"MaterialType":"Cotton"
			}
		],
		"Styles2": [
			{
				"StyleID": "2style001",
				"StyleName": "Cotton StyleName2",
				"Quantity": 6,
				"UnitPrice": 18.45,
				"MaterialType":"Cotton"
			},
			{
				"StyleID": "2style002",
				"StyleName": "Denim StyleName2",
				"Quantity": 8,
				"UnitPrice": 58.8,
				"MaterialType":"Denim"
			}
		]
	}
}
```
Приведенный ниже пример показывает, как это работает.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "SmartMarkers-Using-Master-Details-InDifferentSheets.cs" >}}
