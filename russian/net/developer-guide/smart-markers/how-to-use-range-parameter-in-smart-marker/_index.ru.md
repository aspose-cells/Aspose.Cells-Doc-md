---
title: Как использовать параметр диапазона в SmartMarkers
type: docs
weight: 10
url: /ru/net/how-to-use-range-parameter-in-smart-markers/
---

## **Почему использовать параметр диапазона в Smart Markers**
Параметр диапазона в SmartMarkers используется для точного контроля за тем, где и как размещать данные в шаблоне Excel при заполнении его данными из источника (например, JSON, баз данных). Он помогает управлять динамическим выводом данных, особенно при работе с переменными по длине массивов или сложными группировками.

1. Контроль размещения данных и предотвращение перекрытия: Когда источники данных содержат динамические массивы (например, разное число элементов в каждой записи), параметр диапазона обеспечивает заполнение данных в пределах определенного диапазона Excel, предотвращая переполнение в соседние ячейки или разделы.

2. Обработка динамических формул массивов: Для операций, таких как транспонирование динамических массивов (например, &=TRANSPOSE(DataArray)), параметр диапазона гарантирует, что вывод адаптируется к фактическому размеру данных без оставления остаточных значений (например, нулей в пустых полях) от предыдущих операций.

3. Поддержка группировки и иерархических данных: Когда требуется группировка данных (например, вложенные структуры JSON), параметр диапазона помогает определить иерархические области вывода. Например, группировка записей по родительской категории без ручной настройки строк. Без определенного диапазона SmartMarkers может неправильно отображать вложенные связи, особенно если источники данных не имеют явных иерархий.

4. Улучшение дизайна шаблона и его согласованности: Указывая диапазоны, пользователи гарантируют применение единых форматов, формул и границ к области вывода. Это предотвращает такие проблемы, как несоответствие стилей ячеек или поломка формул в сгенерированных отчетах.

5. Оптимизация производительности и сортировки данных: Параметр диапазона позволяет инструментам предварительно отсортировать источники данных перед заполнением шаблонов, обеспечивая правильный порядок группированных данных.

## **Как использовать параметр диапазона в SmartMarkers**
Иногда необходимо сортировать и выполнять другие операции с диапазоном в SmartMarkers. Aspose.Cells позволяет использовать параметр диапазона в SmartMarkers. Пожалуйста, ознакомьтесь с [шаблонным файлом](range.xlsx), [json файлом](range.json) и скриншотом сгенерированного выходного файла Excel с помощью следующего кода.

|**Первый лист файла range.xlsx, показывающий smart markers.**|
| :- |
|![todo:image_alt_text](range_template.png)|

|**Скриншот выходного файла Excel.**|
| :- |
|![todo:image_alt_text](range_result.png)|

Следующие данные JSON:
```json data
{
  "Groups": [
    {
      "Materials": [
        { 
	        "Name": "BBB", 
	        "DSSection": { "Name": "Item B" } 
	      },
        {
          "Name": "CCC",
          "DSSection": { "Name": "Item C" }
        },
        {
          "Name": "AAA",
          "DSSection": { "Name": "Item A" }
        },        
        {
          "Name": "BBB",
          "DSSection": { "Name": "Item A" }
        },
        {
          "Name": "CCC",
          "DSSection": { "Name": "Item A" }
        },
        {
          "Name": "BBB",
          "DSSection": { "Name": "Item A" }
        },
        { 
	        "Name": "AAA", 
	        "DSSection": { "Name": "Item C" } 
        }
      ]
    }
  ]
}
```
Приведенный ниже пример показывает, как это работает.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "SmartMarkers-Using-Range-Parameter.cs" >}}
{{< app/cells/assistant language="csharp" >}}
