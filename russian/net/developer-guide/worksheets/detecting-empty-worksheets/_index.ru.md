---
title: Обнаружение пустых рабочих листов
type: docs
weight: 410
url: /ru/net/detecting-empty-worksheets/
description: Эта статья показывает вам код, объясняющий, как программно обнаружить пустые листы рабочих книг Excel с использованием C# API с библиотекой .NET.
keywords: обнаружить пустой лист c#, найти пустой лист Excel c#
---

## **Проверка заполненных ячеек**

На листах могут быть одна или несколько ячеек, заполненных значениями: простыми (текст, числовыми, датой/временем) или формулой или значением, основанным на формуле. В таком случае легко определить, пуст ли данный лист или нет. Все, что нам нужно проверить, это свойства [**Cells.MaxDataRow**](https://reference.aspose.com/cells/net/aspose.cells/cells/properties/maxdatarow) или [**Cells.MaxDataColumn**](https://reference.aspose.com/cells/net/aspose.cells/cells/properties/maxdatacolumn). Если вышеупомянутые свойства возвращают ноль или положительные значения, это означает, что одна или несколько ячеек заполнены, однако если какое-либо из этих свойств возвращает -1, это указывает на то, что ни одна из ячеек не заполнена на указанном листе.

{{% alert color="primary" %}}

Коллекции строк и столбцов имеют индексацию с нуля, поэтому ячейка в строке 0 и столбце 0 означает, что это первая ячейка на листе, то есть А1.

{{% /alert %}}

## **Проверка пустых инициализированных ячеек**

Все ячейки, которые имеют значения, автоматически инициализированы, однако есть возможность того, что на листе есть ячейки только с примененным форматированием. В этом случае свойства [**Cells.MaxDataRow**](https://reference.aspose.com/cells/net/aspose.cells/cells/properties/maxdatarow) или [**Cells.MaxDataColumn**](https://reference.aspose.com/cells/net/aspose.cells/cells/properties/maxdatacolumn) вернут -1, указывая на отсутствие каких-либо заполненных значений, но инициализированные ячейки из-за форматирования ячеек не могут быть обнаружены с использованием этого подхода. Чтобы проверить, есть ли на листе пустые инициализированные ячейки, рекомендуется использовать метод IEnumerator.MoveNext на перечислителе, полученном из коллекции [**Cells**](https://reference.aspose.com/cells/net/aspose.cells/cells). Если метод IEnumerator.MoveNext вернет **true**, это означает, что на указанном листе есть одна или несколько инициализированных ячеек.

## **Проверка фигур**

Возможно, что на данном листе нет заполненных ячеек, однако он может содержать фигуры и объекты, такие как элементы управления, диаграммы, изображения и т. д. Если нам нужно проверить, содержит ли лист какую-либо фигуру, мы можем сделать это, исследуя свойство [**ShapeCollection.Count**](https://reference.aspose.com/cells/net/aspose.cells.drawing/shapecollection). Любое положительное значение указывает на наличие фигур в листе.

## **Пример программирования**

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Articles-ManagingWorkbooksWorksheets-DetectEmptyWorksheets-DetectEmptyWorksheets.cs" >}}
