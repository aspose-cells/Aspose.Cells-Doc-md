---
title: Настройка верхних и нижних колонтитулов
type: docs
weight: 30
url: /ru/net/setting-headers-and-footers/
---
{{% alert color="primary" %}}

Верхние и нижние колонтитулы — это строки текста, отображаемые ниже верхнего поля или над нижним полем соответственно. На рабочие листы также можно добавлять верхние и нижние колонтитулы. Верхние и нижние колонтитулы можно использовать для отображения полезной информации, такой как номер страницы, имя автора, название темы или дата и время. Верхние и нижние колонтитулы управляются с помощью параметров настройки страницы.

{{% /alert %}}

## **Настройка верхних и нижних колонтитулов**

Aspose.Cells позволяет добавлять верхние и нижние колонтитулы к рабочим листам во время выполнения, но мы рекомендуем настраивать верхние и нижние колонтитулы вручную в предварительно созданном файле для печати. Вы можете использовать Microsoft Excel в качестве инструмента с графическим интерфейсом для установки верхних и нижних колонтитулов, чтобы сэкономить усилия и время разработки. Aspose.Cells может импортировать файл и сохранить настройки.

Чтобы добавить верхние и нижние колонтитулы во время выполнения, Aspose.Cells предоставляет специальные вызовы API и команды сценария для форматирования верхних и нижних колонтитулов.

### **Команды сценария**

Команды сценария — это специальные команды, которые позволяют задавать форматирование верхнего и нижнего колонтитула.

|**Команды сценария**|**Описание**|
|:- |:- |
|&П|Текущий номер страницы|
|&ГРАММ|Картинка|
|&N|Общее количество страниц|
|&D|Текущая дата|
|&Т|Текущее время|
|&А|Имя рабочего листа|
|&F|Имя файла без пути|
|&"\<FontName>"|Представляет имя шрифта. Например: &"Ариал"|
|&"\<FontName>, \<FontStyle>"|Представляет имя шрифта со стилем. Например: &"Arial,Жирный"|
|&\<FontSize>|Представляет размер шрифта. Например: «&14abc». Но если за этой командой следует простое число, которое будет напечатано в заголовке, оно должно быть отделено пробелом от размера шрифта. Например: «&14 123».|

### **Установить верхние и нижние колонтитулы**

[**Настройка страницы**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup) класс предоставляет два метода,[**SetHeader**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setheader) а также[**SetFooter**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setfooter), используемый для добавления верхнего и нижнего колонтитула на лист. Эти методы принимают только два параметра:

- **Раздел** – раздел, в котором должен быть размещен верхний или нижний колонтитул. Есть три секции: левая, центральная и правая, обозначенные цифрами 0, 1 и 2 соответственно.
- **Скрипт** – сценарий, который будет использоваться для верхнего или нижнего колонтитула. Этот сценарий содержит команды сценария для форматирования верхних или нижних колонтитулов.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-PageSetupFeatures-SetHeadersAndFooters-1.cs" >}}

### **Вставьте изображение в верхний или нижний колонтитул**

[**Настройка страницы**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup) класс имеет два дополнительных метода,[**SetHeaderPicture**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setheaderpicture) а также[**SetFooterPicture**](https://reference.aspose.com/cells/net/aspose.cells/pagesetup/methods/setfooterpicture), используемый для добавления изображений в верхний и нижний колонтитулы. Эти методы принимают параметры:

- **Раздел**– раздел верхнего или нижнего колонтитула, где будет размещено изображение. Есть три секции, левая, центральная и правая, представленные значениями 0, 1 и 2 соответственно.
- **Байтовый массив** – графические данные (двоичные данные должны быть записаны в буфер байтового массива).

После выполнения приведенного ниже кода и открытия файла проверьте заголовок рабочего листа:

1.  На**Файл** меню, выберите**Настройка страницы**. Отобразится диалоговое окно.
1.  Выберите**Верхний/нижний колонтитул** вкладка

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-PageSetupFeatures-InsertImageInHeaderFooter-1.cs" >}}
