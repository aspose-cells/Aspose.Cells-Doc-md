---
title: Копирование и перемещение рабочих листов
type: docs
weight: 10
url: /ru/net/copying-and-moving-worksheets/
description: Эта статья включает образец кода и описывает, как програмно копировать и перемещать листы как внутри книги Excel, так и между книгами Excel, используя C# API или .NET Library.
keywords: копировать лист c#, переместить лист c#
---

{{% alert color="primary" %}}

Иногда вам действительно нужно несколько рабочих листов с общим форматированием и данными. Например, если вы работаете с квартальными бюджетами, вам может потребоваться создать книгу с листами, содержащими одинаковые заголовки столбцов, заголовки строк и формулы. Есть способ сделать это: создав один лист, а затем скопировав его.

Aspose.Cells поддерживает копирование и перемещение рабочих листов внутри или между книгами Excel. Лист с данными, форматированием, таблицами, матрицами, диаграммами, изображениями и другими объектами копируется с высочайшей точностью.

{{% /alert %}}

## **Перемещение или копирование листов с использованием Microsoft Excel**

Ниже приведены шаги для копирования и перемещения листов внутри или между книгами в Microsoft Excel.

1. Чтобы переместить или скопировать листы в другую рабочую книгу, откройте рабочую книгу, которая будет получать листы.
1. Переключитесь на рабочую книгу, которая содержит листы, которые вы хотите переместить или скопировать, а затем выберите листы.
1. На меню **Правка** щелкните **Переместить или скопировать лист**.
1. В диалоговом окне **В книгу** щелкните книгу, которая получит листы.
1. Чтобы переместить или скопировать выбранные листы в новую книгу, щелкните **Новая книга**.
1. В поле **Перед листом** щелкните лист, перед которым вы хотите вставить перемещенные или скопированные листы.
1. Чтобы скопировать листы вместо их перемещения, выберите флажок **Создать копию**.

### **Копирование листов внутри книги с помощью Aspose.Cells**

Aspose.Cells предоставляет перегруженный метод [**Aspose.Cells.WorksheetCollection.AddCopy()**](https://reference.aspose.com/cells/net/aspose.cells/worksheetcollection/methods/addcopy/index), который используется для добавления листа в коллекцию и копирования данных с существующего листа. Одна версия метода принимает индекс исходного листа в качестве параметра. Другая версия принимает имя исходного листа.

В следующем примере показано, как скопировать существующий лист в рамках рабочей книги.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Value-CopyWithinWorkbook-1.cs" >}}

### **Копировать листы между рабочими книгами**

Aspose.Cells предоставляет метод [**Aspose.Cells.Worksheet.Copy()**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/methods/copy/index), используемый для копирования данных и форматирования с исходного листа на другой лист внутри или между книгами. Метод принимает объект исходного листа в качестве параметра.

В следующем примере показано, как скопировать лист из одной рабочей книги в другую рабочую книгу.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Value-CopyWorksheetsBetweenWorkbooks-1.cs" >}}

В следующем примере показано, как скопировать лист из одной рабочей книги в другую рабочую книгу.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Value-CopyWorksheetFromWorkbookToOther-1.cs" >}}

### **Перемещение листов в рамках рабочей книги**

Aspose.Cells предоставляет метод [**Aspose.Cells.Worksheet.MoveTo()**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/methods/moveto), который используется для перемещения листа в другое место в той же книге. Метод принимает индекс целевого листа в качестве параметра.

В следующем примере показано, как переместить лист в другое место внутри рабочей книги.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Value-MoveWorksheet-1.cs" >}}
