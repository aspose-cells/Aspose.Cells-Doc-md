---
title: Применение условного форматирования на листах
type: docs
weight: 130
url: /ru/net/apply-conditional-formatting-in-worksheets/
---
{{% alert color="primary" %}}

Эта статья предназначена для подробного понимания того, как добавить условное форматирование к диапазону ячеек на листе.

Условное форматирование — это расширенная функция в Microsoft Excel, которая позволяет применять форматы к диапазону ячеек и изменять это форматирование в зависимости от значения ячейки или значения формулы. Например, фон ячейки может быть красным, чтобы выделить отрицательное значение, или цвет текста может быть зеленым, если положительное значение. Когда значение ячейки соответствует условию формата, формат применяется. Если значение ячейки не соответствует условию формата, используется форматирование ячейки по умолчанию.

Можно применить условное форматирование с помощью Microsoft Office Automation, но это имеет свои недостатки. Есть несколько причин и проблем: например, безопасность, стабильность, масштабируемость и скорость. Основная причина поиска другого решения заключается в том, что сами сотрудники Microsoft настоятельно рекомендуют использовать Office Automation для программных решений.

В этой статье показано, как создать консольное приложение, добавить условное форматирование к ячейкам с помощью нескольких простейших строк кода, используя файл Aspose.Cells API.

{{% /alert %}}

## **Использование Aspose.Cells для применения условного форматирования на основе значения Cell**

1. **Загрузите и установите Aspose.Cells**.
 1. Скачать Aspose.Cells for .NET.
1. Установите его на свой компьютер разработки.
Все компоненты Aspose после установки работают в ознакомительном режиме. Режим оценки не имеет ограничения по времени и только вставляет водяные знаки в создаваемые документы.
1. **Создать проект**.
 Запустите Visual Studio.NET и создайте новое консольное приложение. В этом примере создается консольное приложение C#, но вы также можете использовать VB.NET.
1. **Добавить ссылки**.
 Добавьте ссылку на Aspose.Cells в свой проект, например добавьте ссылку на ….\Program Files\Aspose\Aspose.Cells\Bin\Net1.0\Aspose.Cells.dll
1. * Применять условное форматирование на основе значения ячейки.
 Ниже приведен код, используемый для выполнения задачи. Я применяю условное форматирование к ячейке.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Articles-ApplyConditionalFormatting-ApplyConditionalFormattingCellValue-1.cs" >}}

Когда приведенный выше код выполняется, условное форматирование применяется к ячейке «A1» на первом рабочем листе выходного файла (output.xls). Условное форматирование, применяемое к A1, зависит от значения ячейки. Если значение ячейки A1 находится в диапазоне от 50 до 100, цвет фона будет красным из-за примененного условного форматирования.

## **Использование Aspose.Cells для применения условного форматирования на основе формулы**

1. Применение условного форматирования в зависимости от формулы (фрагмент кода)
 Ниже приведен код для выполнения задачи. Он применяет условное форматирование к B3.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Articles-ApplyConditionalFormatting-ApplyConditionalFormattingFormula-1.cs" >}}

Когда приведенный выше код выполняется, условное форматирование применяется к ячейке «B3» на первом рабочем листе выходного файла (output.xls). Применяемое условное форматирование зависит от формулы, которая вычисляет значение «B3» как сумму B1 и B2.
