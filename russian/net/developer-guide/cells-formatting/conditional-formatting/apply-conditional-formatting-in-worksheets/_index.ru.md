---
title: Применение условного форматирования на листах
description: Как использовать библиотеку Aspose.Cells в C# для применения условного форматирования на листах. Настраивая эти критерии, вы получаете больше контроля над тем, как выглядят ячейки.
keywords: Aspose.Cells, Conditional Formatting, C#, Worksheet, Formatting
type: docs
weight: 130
url: /ru/net/apply-conditional-formatting-in-worksheets/
---
{{% alert color="primary" %}}

Цель этой статьи — дать подробное представление о том, как добавить условное форматирование к диапазону ячеек на листе.

Условное форматирование — это расширенная функция Excel Microsoft, которая позволяет применять форматы к диапазону ячеек и изменять форматирование в зависимости от значения ячейки или значения формулы. Например, фон ячейки может быть красным, чтобы выделить отрицательное значение, или цвет текста может быть зеленым для положительного значения. Когда значение ячейки соответствует условию формата, формат применяется. Если значение ячейки не соответствует условию формата, используется форматирование ячейки по умолчанию.

Можно применить условное форматирование с помощью Office Automation Microsoft, но это имеет свои недостатки. Это связано с несколькими причинами и проблемами: например, безопасность, стабильность, масштабируемость и скорость. Основная причина поиска другого решения заключается в том, что Microsoft сами настоятельно не рекомендуют использовать Office Automation для программных решений.

В этой статье показано, как создать консольное приложение и добавить условное форматирование к ячейкам с помощью нескольких простейших строк кода, используя код Aspose.Cells API.

{{% /alert %}}

##  **Использование Aspose.Cells для применения условного форматирования на основе значения Cell**

1. *Загрузите и установите Aspose.Cells**.
 1. Скачать Aspose.Cells for .NET.
1. Установите его на свой компьютер для разработки.
 Все компоненты Aspose при установке работают в ознакомительном режиме. Режим оценки не имеет ограничений по времени и в создаваемые документы только вставляет водяные знаки.
1. *Создать проект**.
 Запустите Visual Studio.NET и создайте новое консольное приложение. В этом примере создается консольное приложение C#, но вы также можете использовать VB.NET.
1. *Добавить ссылки**.
 Добавьте ссылку на Aspose.Cells в свой проект, например добавьте ссылку на ….\Program Files\Aspose\Aspose.Cells\Bin\Net1.0\Aspose.Cells.dll.
1. *Применить условное форматирование на основе значения ячейки.
Ниже приведен код, используемый для выполнения задачи. Я применяю условное форматирование к ячейке.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Articles-ApplyConditionalFormatting-ApplyConditionalFormattingCellValue-1.cs" >}}

Когда приведенный выше код выполняется, к ячейке «A1» на первом листе выходного файла (output.xls) применяется условное форматирование. Условное форматирование, применяемое к A1, зависит от значения ячейки. Если значение ячейки A1 находится между 50 и 100, цвет фона будет красным из-за примененного условного форматирования.

##  **Использование Aspose.Cells для применения условного форматирования на основе формулы**

1. Применение условного форматирования в зависимости от формулы (фрагмент кода)
 Ниже приведен код для выполнения задачи. Он применяет условное форматирование к B3.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Articles-ApplyConditionalFormatting-ApplyConditionalFormattingFormula-1.cs" >}}

Когда приведенный выше код выполняется, к ячейке «B3» на первом листе выходного файла (output.xls) применяется условное форматирование. Применяемое условное форматирование зависит от формулы, которая вычисляет значение «B3» как сумму B1 и B2.
