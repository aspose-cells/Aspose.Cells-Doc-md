---
title: Автоподбор строк и столбцов
type: docs
weight: 20
url: /ru/net/autofit-rows-and-columns/
description: В этой статье показано, как автоматически подогнать строки, столбцы, строки объединенных ячеек и строку в диапазоне ячеек с помощью API Aspose.Cells for .NET.
keywords: Автоподбор строк, автоподбор столбцов, автоподбор строки в диапазоне ячеек, автоподбор строк объединенных ячеек
---

{{% alert color="primary" %}}

Microsoft Excel позволяет пользователям автоматически изменять размеры ячеек в соответствии с ее содержимым. Эта функция также доступна через Aspose.Cells, чтобы разработчики могли автоматически изменять размеры ячейки во время выполнения.

{{% /alert %}}

## **Автоматическая подгонка размера**

Aspose.Cells предоставляет класс, который представляет файл Microsoft Excel. Класс содержит коллекцию, которая позволяет получить доступ к каждому листу в файле Excel. Лист представлен классом. Класс предоставляет широкий спектр свойств и методов для управления листом. В этой статье рассматривается использование класса для автонастройки строк или столбцов.

### **Автоматическая подгонка строки - простой**

Наиболее простой способ автоматического изменения ширины и высоты строки - вызвать метод класса. Метод принимает индекс строки (строки, которую нужно изменить в размере) в качестве параметра.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-RowsColumns-AutofitRowsandColumns-1.cs" >}}

### **Как автоматически подогнать строку в диапазоне ячеек**

Строка состоит из многих столбцов. Aspose.Cells позволяет разработчикам автоматически подгонять строку на основе содержимого диапазона ячеек в строке путем вызова перегруженной версии метода. Он принимает следующие параметры:

- Индекс строки, индекс строки, которую нужно автоматически подогнать.
- Индекс первого столбца, индекс первого столбца строки.
- Индекс последнего столбца, индекс последнего столбца строки.

Метод проверяет содержимое всех столбцов в строке, а затем автоматически подгоняет строку.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-RowsColumns-AutofitRowinSpecificRange-1.cs" >}}

### **Как автоматически подогнать столбец в диапазоне ячеек**

Столбец состоит из многих строк. Возможно автоматически подогнать столбец на основе содержимого диапазона ячеек в столбце, вызвав перегруженную версию метода, который принимает следующие параметры:

- Индекс столбца, индекс столбца, который нужно автоматически подогнать.
- Индекс первой строки, индекс первой строки столбца.
- Индекс последней строки, индекс последней строки столбца.

Метод проверяет содержимое всех строк в столбце, а затем автоматически подгоняет столбец.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-RowsColumns-AutofitColumninSpecificRange-1.cs" >}}

### **Как автоматически подогнать строки для объединенных ячеек**

С помощью Aspose.Cells можно автоматически подгонять строки даже для ячеек, которые были объединены с использованием API. Класс предоставляет свойство, которое может быть использовано для автоматической подгонки строк для объединенных ячеек. принимает перечисление, которое имеет следующие члены.

- Никакой: Игнорировать объединенные ячейки.
- ПерваяСтрока: Только увеличивает высоту первой строки.
- ПоследняяСтрока: Только увеличивает высоту последней строки.
- КаждаяСтрока: Только увеличивает высоту каждой строки.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-RowsColumns-AutofitRowsforMergedCells-1.cs" >}}

{{% alert color="primary" %}}

Вы также можете попробовать использовать перегруженные версии методов [**AutoFitRows**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/methods/autofitrows) и [**AutoFitColumns**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/methods/autofitcolumns), принимающие диапазон строк/столбцов и экземпляр [**AutoFitterOptions**](https://reference.aspose.com/cells/net/aspose.cells/autofitteroptions) для автоматической подгонки выбранных строк/столбцов в соответствии с вашими желаемыми [**AutoFitterOptions**](https://reference.aspose.com/cells/net/aspose.cells/autofitteroptions).

Сигнатуры вышеперечисленных методов выглядят следующим образом:

1. AutoFitRows(int startRow, int endRow, [**AutoFitterOptions**](https://reference.aspose.com/cells/net/aspose.cells/autofitteroptions) опции)
1. AutoFitColumns(int firstColumn, int lastColumn, [**AutoFitterOptions**](https://reference.aspose.com/cells/net/aspose.cells/autofitteroptions) опции)

{{% /alert %}}

## **Важно знать**

{{% alert color="primary" %}}

Если ячейка объединена, то методы AutoFit не будут применены, что соответствует тому же поведению, что и в Microsoft Excel. Вы можете обойти это, используя API автофильтра. Более того, если текст в ячейке перенесен, метод [**AutoFitColumn**](https://reference.aspose.com/cells/net/aspose.cells.worksheet/autofitcolumn/methods/1) также не будет применен. Еще одна вещь, которую нужно знать, заключается в том, что методы AutoFit занимают много времени. Поэтому вы должны вызывать эти методы как можно реже, чтобы обеспечить эффективность вашего приложения.

{{% /alert %}}

## **Продвинутые темы**
- [AutoFit строк для объединенных ячеек](/cells/ru/net/autofit-rows-for-merged-cells/)
{{< app/cells/assistant language="csharp" >}}
