---
title: Запереть или разблокировать формы
linktitle: Запереть или разблокировать формы
type: docs
weight: 200
url: /ru/net/lock-or-unlock-shapes/
description: В этой статье показан код, объясняющий, как блокировать или разблокировать фигуры для их защиты с помощью библиотеки Aspose.Cells.
keywords: C# Блокировка фигур для их защиты, Как блокировать или разблокировать фигуры с помощью C#, Блокировать или разблокировать фигуры для их защиты в C#.
---

## **Возможные сценарии использования**

Иногда вам нужно защитить все формы в определенных листах, чтобы предотвратить их уничтожение нежелательными ситуациями. В этом случае вам нужно запереть все формы на указанном листе. 

Блокировка фигур в таблице или документе может быть полезной по нескольким причинам:
1. Предотвращение случайных изменений: Блокировка фигур гарантирует, что они не будут случайно перемещены, изменены в размерах или удалены пользователями. Это особенно важно в сложных документах, где фигуры могут использоваться для аннотаций, иллюстраций или как часть дизайна документа.
1. Поддерживайте макет и дизайн: Фигуры часто играют важную роль в макете и визуальном дизайне документа. Их блокировка сохраняет задуманный внешний вид, обеспечивая профессиональность и визуальную привлекательность документа.
1. Целостность данных: В электронных таблицах фигуры могут использоваться для выделения важных данных, добавления комментариев или предоставления визуальных объяснений. Блокировка этих фигур гарантирует, что контекстная информация, которую они предоставляют, останется точной и неизменной.
1. Согласованность в совместных документах: При совместной работе над документами пользователи могут иметь различный уровень опыта. Блокировка фигур помогает поддерживать согласованность в документе, предотвращая непреднамеренные изменения.
1. Безопасность: В конфиденциальных документах блокировка фигур может быть частью более широкой стратегии защиты информации. Например, в финансовых отчетах или юридических документах заблокированные фигуры могут использоваться для защиты конкретных аннотаций или выделений, предоставляющих критически важный контекст.

Иногда вам необходимо иметь возможность изменять определенные фигуры на защищенных листах, и в таком случае вам нужно разблокировать эти фигуры. В этой статье подробно объясняется, как заблокировать и разблокировать указанные фигуры.

## **Как заблокировать фигуры для их защиты в Excel**

Вот как можно заблокировать ячейки в Microsoft Excel:

1. Откройте файл Excel: Откройте файл Excel, содержащий фигуры, которые вы хотите заблокировать.

1. Выберите фигуру: Щелкните по фигуре, которую хотите заблокировать. Вы также можете выбрать несколько фигур, удерживая нажатой клавишу Ctrl и щелкая по каждой фигуре.

1. Откройте панель Формат Фигуры: Щелкните правой кнопкой мыши по выбранной(ым) фигуре(ам) и выберите "Размер и Свойства." Альтернативно, вы можете перейти на вкладку "Формат" на Ленте и в группе "Размер" нажать на пиктограмму запуска диалогового окна (небольшая стрелка), чтобы открыть панель "Формат Фигуры".
1. Заблокируйте фигуру: В панели "Формат Фигуры" перейдите на вкладку "Размер и Свойства" (пиктограмма выглядит как квадрат со стрелками). В разделе "Свойства" установите флажок "Заблокировано".
<br>
<img src="1.png" width=60% />
1. Защитите лист: Перейдите на вкладку "Рецензирование" на Ленте. Нажмите "Защитить лист." Установите пароль (по желанию) и выберите разрешения, которые хотите предоставить (например, выбор заблокированных ячеек, форматирование ячеек и т.д.). Нажмите "OK."
<br>
<img src="2.png" width=60% />

## **Как заблокировать все фигуры на указанном листе**

Чтобы защитить все формы на указанном листе, используйте метод [Worksheet.Protect( ProtectionType.Objects)](https://reference.aspose.com/cells/net/aspose.cells/worksheet/protect/#protect), как показано в следующем примере кода.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Lock-Or-Unlock-Shapes-1.cs" >}}

## **Как разблокировать указанные фигуры на защищенном листе**

Чтобы разблокировать указанную форму в защищенном листе, используйте [shape.IsLocked](https://reference.aspose.com/cells/net/aspose.cells.drawing/shape/islocked/), как показано в следующем примере кода.

Примечание: [shape.IsLocked](https://reference.aspose.com/cells/net/aspose.cells.drawing/shape/islocked/) имеет смысл только при защищенном листе.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Lock-Or-Unlock-Shapes-2.cs" >}}

