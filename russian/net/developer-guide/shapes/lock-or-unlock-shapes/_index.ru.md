---
title: Запереть или разблокировать формы
linktitle: Запереть или разблокировать формы
type: docs
weight: 200
url: /ru/net/lock-or-unlock-shapes/
description: Эта статья показывает код, объясняющий, как блокировать или разблокировать формы для их защиты с помощью библиотеки Aspose.Cells.
keywords: C# блокировка форм для защиты, как блокировать или разблокировать формы с помощью C#, защита форм в C#.
---

## **Возможные сценарии использования**

Иногда вам нужно защитить все формы в определенных листах, чтобы предотвратить их уничтожение нежелательными ситуациями. В этом случае вам нужно запереть все формы на указанном листе. 

Блокировка фигур в таблице или документе может быть полезна по нескольким причинам:
1. Предотвращение случайных изменений: блокировка фигур гарантирует, что их случайно не переместят, не изменят размер или не удалят пользователи. Особенно важно в сложных документах, где фигуры используются для аннотаций, иллюстраций или как часть дизайна документа.
1. Поддержание макета и дизайна: фигуры часто играют важную роль в раскладке и внешнем виде документа. Блокировка сохраняет задуманный внешний вид, делая документ профессиональным и визуально привлекательным.
1. Целостность данных: в таблицах фигуры могут использоваться для выделения важных данных, добавления комментариев или предоставления визуальных объяснений. Блокировка этих фигур обеспечивает сохранение точности и целостности предоставляемой ими контекстной информации.
1. Последовательность в совместных документах: при совместной работе над документами разные пользователи могут обладать разным уровнем опыта. Блокировка фигур помогает поддерживать согласованность документа, предотвращая непреднамеренные изменения.
1. Безопасность: в чувствительных документах блокировка фигур может быть частью общей стратегии защиты информации. Например, в финансовых отчетах или юридических документах заблокированные фигуры используются для защиты конкретных аннотаций или выделений, предоставляющих важный контекст.

Иногда необходимо иметь возможность изменять определенные формы в защищенных листах, в таком случае нужно разблокировать эти формы. Эта статья подробно расскажет, как блокировать и разблокировать указанные формы.

## **Как заблокировать фигуры для их защиты в Excel**

Вот как можно заблокировать ячейки в Microsoft Excel:

1. Откройте файл Excel: Откройте файл Excel, содержащий фигуры, которые вы хотите заблокировать.

1. Выберите фигуру: Щелкните по фигуре, которую хотите заблокировать. Также можно выбрать несколько фигур, зажав клавишу Ctrl и щелкая по каждой фигуре.

1. Откройте панель форматирования фигуры: Щелкните правой кнопкой по выбранной фигуре(ям) и выберите "Размер и свойства". Или перейдите на вкладку "Формат" на ленте и в группе "Размер" нажмите на значок диалогового окна (маленькая стрелка) для открытия панели "Формат фигуры".
1. Заблокируйте фигуру: В панели "Формат фигуры" перейдите на вкладку "Размер и свойства" (значок, похожий на квадрат со стрелками). В разделе "Свойства" установите галочку возле "Заблокировано".
<br>
<img src="1.png" width=60% />
1. Защитите лист: Перейдите на вкладку "Рецензирование" на ленте. Нажмите "Защитить лист." Установите пароль (по желанию) и выберите разрешения, которые хотите разрешить (например, выбор заблокированных ячеек, форматирование ячеек и т.д.). Нажмите "ОК."
<br>
<img src="2.png" width=60% />

## **Как заблокировать все фигуры в определенном листе**

Чтобы защитить все формы на указанном листе, используйте метод [Worksheet.Protect( ProtectionType.Objects)](https://reference.aspose.com/cells/net/aspose.cells/worksheet/protect/#protect), как показано в следующем примере кода.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Lock-Or-Unlock-Shapes-1.cs" >}}

## **Как разблокировать указанные фигуры в защищённом листе**

Чтобы разблокировать указанную форму в защищенном листе, используйте [shape.IsLocked](https://reference.aspose.com/cells/net/aspose.cells.drawing/shape/islocked/), как показано в следующем примере кода.

Примечание: [shape.IsLocked](https://reference.aspose.com/cells/net/aspose.cells.drawing/shape/islocked/) имеет смысл только при защищенном листе.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Lock-Or-Unlock-Shapes-2.cs" >}}

{{< app/cells/assistant language="csharp" >}}
