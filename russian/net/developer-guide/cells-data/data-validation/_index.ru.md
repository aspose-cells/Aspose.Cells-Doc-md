---
title: Валидация данных
type: docs
weight: 90
url: /ru/net/data-validation/
---
{{% alert color="primary" %}}

Microsoft Excel предоставляет несколько полезных функций для автоматической фильтрации или проверки данных рабочего листа. Aspose.Cells полностью поддерживает функции проверки данных и автофильтра Excel. В этой статье объясняется, как использовать функции в Microsoft Excel и как кодировать их с помощью Aspose.Cells.

{{% /alert %}}

## **Типы проверки данных и выполнение**

Проверка данных — это возможность устанавливать правила, относящиеся к данным, введенным на листе. Например, используйте проверку, чтобы убедиться, что столбец с надписью ДАТА содержит только даты или что другой столбец содержит только числа. Вы даже можете убедиться, что столбец с надписью DATE содержит только даты в определенном диапазоне. С проверкой данных вы можете контролировать, что вводится в ячейки на листе.

Microsoft Excel поддерживает ряд различных типов проверки данных. Каждый тип используется для контроля того, какой тип данных вводится в ячейку или диапазон ячеек. Ниже фрагменты кода иллюстрируют, как это проверить:

- Numbers целые, то есть не имеют десятичной части.
- Десятичные числа следуют правильной структуре. В примере кода определяется, что диапазон ячеек должен содержать два десятичных пробела.
- Значения ограничены списком значений. Проверка списка определяет отдельный список значений, которые можно применить к ячейке или диапазону ячеек.
- Даты попадают в определенный диапазон.
- Время находится в определенном диапазоне.
- Текст находится в пределах заданной длины символа.

### **Проверка данных с помощью Microsoft Excel**

Чтобы создать проверки с помощью Microsoft Excel:

1. На листе выберите ячейки, к которым вы хотите применить проверку.
1.  От**Данные** меню, выберите**Проверка**. Отобразится диалоговое окно проверки.
1.  Нажмите на**Настройки** вкладку и введите настройки.

### **Проверка данных с Aspose.Cells**

Проверка данных — мощная функция для проверки информации, введенной в рабочие листы. Благодаря проверке данных разработчики могут предоставить пользователям список вариантов, ограничить ввод данных определенным типом или размером и т. д.
 В Aspose.Cells каждый[**Рабочий лист**](https://reference.aspose.com/cells/net/aspose.cells/worksheet) класс имеет[**Валидации**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/properties/validations)имущество, которое представляет собой совокупность[**Проверка**](https://reference.aspose.com/cells/net/aspose.cells/validation) объекты. Чтобы настроить проверку, установите некоторые[**Проверка**](https://reference.aspose.com/cells/net/aspose.cells/validation)свойства класса следующим образом:

- Тип — представляет тип проверки, который может быть указан с использованием одного из предопределенных значений в[**Тип Валидации**](https://reference.aspose.com/cells/net/aspose.cells/validationtype)перечисление.
-  Оператор — представляет оператор, который будет использоваться при проверке, который можно указать, используя одно из предопределенных значений в[**Тип оператора**](https://reference.aspose.com/cells/net/aspose.cells/operatortype)перечисление.
- Formula1 — представляет значение или выражение, связанное с первой частью проверки данных.
- Formula2 — представляет значение или выражение, связанное со второй частью проверки данных.

 Когда[**Проверка**](https://reference.aspose.com/cells/net/aspose.cells/validation) свойства объекта настроены, разработчики могут использовать[**CellArea**](https://reference.aspose.com/cells/net/aspose.cells/cellarea)структура для хранения информации о диапазоне ячеек, который будет проверяться с помощью созданной проверки.

#### **Типы проверки данных**

[**Тип Валидации**](https://reference.aspose.com/cells/net/aspose.cells/validationtype)перечисление имеет следующие члены:

|**Имя участника**|**Описание**|
|:- |:- |
|любое значение|Обозначает значение любого типа.|
|Целое число|Обозначает тип проверки для целых чисел.|
|Десятичный|Обозначает тип проверки для десятичных чисел.|
|Список|Обозначает тип проверки для раскрывающегося списка.|
|Датировать|Обозначает тип проверки для дат.|
|Время|Обозначает тип проверки для времени.|
|Длина текста|Обозначает тип проверки длины текста.|
|Обычай|Обозначает настраиваемый тип проверки.|

##### **Проверка данных целого числа**

При этом типе проверки пользователи могут вводить в проверенные ячейки только целые числа из указанного диапазона. В следующих примерах кода показано, как реализовать тип проверки WholeNumber. В примере создается та же проверка данных с использованием Aspose.Cells, которую мы создали с помощью Microsoft Excel выше.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Data-Processing-FilteringAndValidation-WholeNumberDataValidation-1.cs" >}}

##### **Проверка данных списка**

Этот тип проверки позволяет пользователю вводить значения из раскрывающегося списка. Он предоставляет список: ряд строк, содержащих данные. В этом примере добавляется второй рабочий лист для хранения источника списка. Пользователи могут выбирать значения только из списка. Областью проверки является диапазон ячеек A1:A5 на первом листе.

 Здесь важно, чтобы вы установили[**Validation.InCellDropDown**](https://reference.aspose.com/cells/net/aspose.cells/validation/properties/incelldropdown) собственность на**истинный**.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Data-Processing-FilteringAndValidation-ListDataValidation-1.cs" >}}

##### **Дата проверки данных**

При этом типе проверки пользователи вводят значения дат в указанном диапазоне или соответствующие определенным критериям в проверенные ячейки. В этом примере пользователю разрешено вводить даты с 1970 по 1999 год. Здесь областью проверки является ячейка B1.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Data-Processing-FilteringAndValidation-DateDataValidation-1.cs" >}}

##### **Проверка данных времени**

При этом типе проверки пользователи могут вводить время в пределах указанного диапазона или в соответствии с некоторыми критериями в проверенные ячейки. В примере пользователю разрешено вводить время с 09:00 до 11:30. Здесь областью проверки является ячейка B1.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Data-Processing-FilteringAndValidation-TimeDataValidation-1.cs" >}}

##### **Проверка данных о длине текста**

При этом типе проверки пользователи могут вводить текстовые значения заданной длины в проверенные ячейки. В примере пользователю разрешено вводить строковые значения, содержащие не более 5 символов. Область проверки — ячейка B1.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Data-Processing-FilteringAndValidation-TextLengthDataValidation-1.cs" >}}

### **Правила проверки данных**

Когда реализованы проверки данных, проверку можно проверить, назначив разные значения в ячейках.[**Cell.GetValidationValue**](https://reference.aspose.com/cells/net/aspose.cells/cell/methods/getvalidationvalue) можно использовать для получения результата проверки. В следующем примере эта функция демонстрируется с разными значениями. Образец файла можно загрузить по следующей ссылке для тестирования:

[SampleDataValidationRules.xlsx](77496339.xlsx)

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Articles-DataValidationRules-1.cs" >}}

## **Проверьте, является ли проверка в ячейке раскрывающимся списком**

 Как мы видели, существует множество типов проверок, которые можно реализовать в ячейке. Если вы хотите проверить, является ли проверка раскрывающимся списком или нет,[**Validation.InCellDropDown**](https://reference.aspose.com/cells/net/aspose.cells/validation/properties/incelldropdown) свойство можно использовать для проверки этого. Следующий пример кода демонстрирует использование этого свойства. Образец файла для тестирования можно скачать по следующей ссылке:

[образецВалидатион.xlsx](79527947.xlsx)

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Articles-CheckIfValidationInCellDropDown-1.cs" >}}

## **Добавить CellArea к существующей проверке**

 Могут быть случаи, когда вы можете захотеть добавить[**CellArea**](https://reference.aspose.com/cells/net/aspose.cells/cellarea)к существующим[**Проверка**](https://reference.aspose.com/cells/net/aspose.cells/validation). Когда вы добавляете[**CellArea**](https://reference.aspose.com/cells/net/aspose.cells/cellarea) с использованием[**Validation.AddArea(CellAreacellArea)**](https://reference.aspose.com/cells/net/aspose.cells/validation/methods/addarea), Aspose.Cells проверяет все существующие области, чтобы убедиться, что новая область уже существует. Если файл имеет большое количество проверок, это снижает производительность. Чтобы преодолеть это, API предоставляет[**Validation.AddAreaCellArea (cellArea, bool checkIntersection, bool checkEdge)**](https://reference.aspose.com/cells/net/aspose.cells.validation/addarea/methods/1) метод.*проверитьПерекресток* Параметр указывает, следует ли проверять пересечение данной области с существующими областями проверки. Установка его на**ЛОЖЬ** отключит проверку других областей.*checkEdge* Параметр указывает, следует ли проверять обрабатываемые области. Если новая область становится верхней левой областью, внутренние настройки перестраиваются. Если вы уверены, что новая область не является верхней левой областью, вы можете установить этот параметр как**ЛОЖЬ**.

Следующий фрагмент кода демонстрирует использование[**Validation.AddAreaCellArea (cellArea, bool checkIntersection, bool checkEdge)**](https://reference.aspose.com/cells/net/aspose.cells.validation/addarea/methods/1) метод добавления нового[**CellArea**](https://reference.aspose.com/cells/net/aspose.cells/cellarea)к существующим[**Проверка**](https://reference.aspose.com/cells/net/aspose.cells/validation).

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Data-AddValidationArea-1.cs" >}}

Исходный и выходной файлы Excel прилагаются для ознакомления.

[Исходный файл](96928093.xlsx)

[Выходной файл](96928220.xlsx)


## **Предварительные темы**
- [Получить проверку Cell в файлах ODS](/cells/ru/net/get-cell-validation-in-ods-files/)
- [Применить проверку к номеру Cell](/cells/ru/net/get-validation-applied-on-a-cell/)
- [Убедитесь, что значение Cell удовлетворяет правилам проверки данных.](/cells/ru/net/verify-that-cell-value-satisfies-data-validation-rules/)
