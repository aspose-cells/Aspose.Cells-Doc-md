---
title: Как подогнать изображение по ширине и высоте ячейки
type: docs
weight: 130
url: /ru/net/how-to-fit-image-to-cell-width-height/
description: Узнайте, как подогнать изображение по ширине ячейки с помощью Aspose.Cells.
keywords: Как подогнать изображение по ширине ячейки, подогнать изображение по ширине ячейки, как подогнать изображение по ширине и высоте ячейки, как подогнать изображение по высоте ячейки.
---


## **Почему важно подогнать изображение по ширине и высоте ячейки**
Подгонка изображения к определенной ширине и высоте ячейки — это не только эстетика. Это в основном о точности, автоматизации и организации данных.

1. Для профессиональной презентации и читаемости: При создании панели мониторинга часто нужны иконки, флаги или изображения продуктов, которые должны идеально совпадать с точками данных. Несовпадающее изображение выглядит неаккуратно и непрофессионально.Если вы разрабатываете шаблон для использования другими (например, каталог продуктов, справочник сотрудников), вы хотите, чтобы изображения автоматически вписывались в предназначенные для них места, обеспечивая единообразие при каждом использовании шаблона. Изображения, выходящие за пределы ячеек, могут вызывать неожиданные разрывы страниц и проблемы с форматированием при печати. Подогнанное изображение ведет себя предсказуемо на печатной странице.

2. Для организации и структуры данных: Это самый важный функциональный аспект. Excel — это сетка для данных. Когда изображение "размещается" на сетке, а не "подгоняется" к ячейке, возникают проблемы. Проблема с плавающими изображениями: Они не следуют за ячейками: Если вы сортируете, фильтруете или вставляете/удаляете строки, изображение остается в своем абсолютном положении на листе, полностью отключаясь от данных, которые оно должно представлять. Они не изменяются с размером ячейки: Если вы меняете высоту строки или ширину столбца, плавающее изображение остается того же размера, нарушая макет. Преимущество подгонки под ячейку: Ячейка становится "контейнером" для изображения: Когда изображение подгоняется под ячейку, его положение и размер определяются координатами сетки ячейки. Если вы перемещаете данные (например, сортировка таблицы), изображение перемещается вместе с соответствующей строкой. Это создает истинную пару изображение-данные: Это позволяет рассматривать изображение как визуальный атрибут данных в этой строке, что важно для автоматизации.

3. Для автоматизации и расширенного функционала: Здесь подгонка изображений под ячейки становится суперсилой. Динамическое связывание изображений: Вы можете использовать формулу для вытягивания пути изображения из ячейки, а затем с помощью макроса (VBA) автоматически задавать размер и вставлять изображение в соседнюю ячейку. Так создается динамический каталог продуктов, в котором изменение ID продукта автоматически обновляет название, цену и изображение.Интеграция с базой данных: При экспорте данных или связывании Excel с базой данных наличие изображений внутри конкретных ячеек делает весь набор данных, включая его визуальные элементы, более структурированным и переносимым.

## **Как подогнать изображение по ширине и высоте ячейки с помощью Excel**
Вы можете подогнать изображение по ширине и высоте ячейки в Excel двумя способами.

### **Подгонка изображения по ширине и высоте ячейки с помощью "Поместить в ячейку"**
 Как вставить изображение в ячейку в Excel, выполните следующие действия:

1. Перейдите на вкладку Вставка и нажмите на опцию изображения.
2. Выберите **Разместить в ячейке**. Выберите один из следующих источников из выпадающего меню Вставить изображение из (**Это устройство**, **Готовые изображения** и **Изображения из Интернета**). Это устройство для вставки изображения с вашего устройства. Готовые изображения для вставки изображения из готовых изображений. Изображения из Интернета для вставки изображения из Интернета.
<br>
<img src="1.png" width=60% />
3. Выберите изображение и вставьте его в ячейку.
<br>
<img src="8.png" width=60% />

### **Подгонка изображения по ширине и высоте ячейки с помощью "Поместить поверх ячеек"**
О том, как вставить изображение над ячейками в Excel, следуйте этим шагам:

1. Перейдите на вкладку Вставка и нажмите на опцию изображения.
2. Выберите **Разместить над ячейками**. Выберите один из следующих источников из раскрывающегося меню Вставить изображение: (**Это устройство**, **Готовые изображения** и **Изображения из Интернета**). Это устройство для вставки изображения с вашего устройства. Готовые изображения для вставки изображения из готовых изображений. Изображения из Интернета для вставки изображения из Интернета.
<br>
<img src="2.png" width=60% />
3. Выберите изображение и вставьте его над ячейками.
<br>
<img src="3.png" width=60% />
4. Вручную отрегулируйте ширину и высоту изображения, чтобы они соответствовали ширине и высоте ячеек.
<br>
<img src="6.png" width=60% />

## **Как подогнать изображение по ширине и высоте ячейки с помощью Aspose.Cells**
Из-за изменений в ширине и высоте строк и столбцов в зависимости от языка и соотношения отображения, регулировка ширины и высоты изображения может давать небольшие отличия, а иногда вообще не совпадать полностью с размерами ячеек. Вы можете подогнать изображение по ширине и высоте ячейки в Aspose.Cells двумя способами.

### **Как подогнать изображение по ширине и высоте ячейки с помощью "Поместить в ячейку"**
Вставьте изображение в ячейку с помощью Aspose.Cells. Пожалуйста, ознакомьтесь со следующим примером кода. После выполнения образца кода изображение будет вставлено в ячейку.
1. Создать объект Workbook. 
2. Получить ячейку, в которую хотите вставить изображение.
3. Установить свойство Cell.EmbeddedImage. 
4. Наконец, сохраните книгу в формате [output XLSX](out.xlsx). 

### **Пример кода для "Поместить в ячейку"**

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Cells-place-image-in-cell.cs" >}}
{{< app/cells/assistant language="csharp" >}}

### **Как подогнать изображение по ширине и высоте ячейки с помощью "Поместить поверх ячеек"**
Добавление изображений в электронную таблицу очень просто. Нужно лишь несколько строк кода:
Достаточно вызвать метод [**Add**](https://reference.aspose.com/cells/net/aspose.cells.drawing/picturecollection/methods/add/index) коллекции [**Pictures**](https://reference.aspose.com/cells/net/aspose.cells.drawing/picturecollection) (обернутый в объект [**Worksheet**](https://reference.aspose.com/cells/net/aspose.cells/worksheet)). Затем отрегулируйте ширину и высоту изображения на основе ширины и высоты ячеек. В конце сохраните файл в формате [output XLSX](out_net.xlsx). Метод [**Add**](https://reference.aspose.com/cells/net/aspose.cells.drawing/picturecollection/methods/add/index) принимает следующие параметры:

- **Индекс верхнего левого ряда**, индекс верхнего левого ряда.
- **Индекс верхнего левого столбца**, индекс верхнего левого столбца.
- **Имя файла изображения**, имя файла изображения с полным путем.


### **Пример кода для "Поместить поверх ячеек"**

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Cells-place-image-over-cells-fit-cell-width-height.cs" >}}
{{< app/cells/assistant language="csharp" >}}
