---
title: Добавить вычисляемое поле в сводную таблицу
type: docs
weight: 130
url: /ru/net/add-calculated-field-in-pivot-table/
description: Как добавить вычисляемое поле в сводную таблицу с Aspose.Cells.
keywords: Adding a calculated field in pivot table.
---
##  **Возможные сценарии использования**
 Когда вы создаете сводную таблицу на основе известных данных, вы обнаруживаете, что данные в ней не те, которые вам нужны. Данные, которые вам нужны, представляют собой комбинацию этих исходных данных. Например, вам нужно сложить, вычесть, умножить и разделить исходные данные, прежде чем вы захотите получить данные. В это время нужно построить вычисляемое поле и задать соответствующую формулу для расчета. Затем выполните некоторые статистические и другие операции над вычисляемым полем.

##  **Добавить вычисляемое поле в сводную таблицу в Excel**
Вставьте вычисляемое поле в сводную таблицу в Excel, выполните следующие действия:

1.  Выберите сводную таблицу, в которую вы хотите добавить вычисляемое поле.
2. Перейдите на вкладку Анализ сводной таблицы на ленте.
3. Нажмите «Поля, элементы и наборы», а затем выберите «Вычисляемое поле» в раскрывающемся меню.
4. В поле «Имя» введите имя вычисляемого поля.
 5. В поле «Формула» введите формулу для вычисления, которое вы хотите выполнить, используя соответствующие имена полей сводной таблицы и математические операторы.
<br>
<img src="1.png" width=80% />
6. Нажмите «ОК», чтобы создать вычисляемое поле.
7. Новое вычисляемое поле появится в списке полей сводной таблицы в разделе «Значения».
8. Перетащите вычисляемое поле в раздел «Значения» сводной таблицы, чтобы отобразить рассчитанные значения.
<br>
<img src="2.png" width=80% />

##  **Добавить вычисляемое поле в сводную таблицу, используя C#**
Добавьте вычисляемое поле в файл Excel, используя Aspose.Cells. См. следующий пример кода. После выполнения примера кода на рабочий лист добавляется сводная таблица с вычисляемым полем.
1.  Установите исходные данные и создайте сводную таблицу.
2. Создайте вычисляемое поле в соответствии с существующим PivotField в сводной таблице.
 3. Добавьте вычисляемое поле в область данных.
 4. Наконец, он сохраняет книгу в[вывод XLSX](out.xlsx) формат.

##  **Образец кода**
{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "PivotTables-Add-calculated-field-in-PivotTable.cs" >}}
