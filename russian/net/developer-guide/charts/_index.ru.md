---
title: Создание диаграммы и управление ею
linktitle: Графики
type: docs
weight: 130
url: /ru/net/creating-charts/
description: Создайте диаграмму в CSharp для файлов Excel и ODS.
keywords: create a chart, make a graph 
---
{{% alert color="primary" %}}

С помощью Aspose.Cells можно добавлять различные диаграммы в электронные таблицы. Aspose.Cells предоставляет множество гибких объектов диаграмм. В этом разделе обсуждаются объекты диаграммы Aspose.Cells'.

{{% /alert %}}

## **Создание диаграмм**

### **Простое создание диаграммы**
Создать диаграмму с номером Aspose.Cells очень просто, используя следующие примеры кодов:
{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Charts-ManipulateChart-HowToCreateColumnChart-1.cs" >}}

### **Что нужно знать для создания диаграммы**

Перед созданием диаграмм важно понять некоторые основные понятия, которые будут полезны при создании диаграмм с помощью Aspose.Cells.

#### **Объекты диаграммы**

Aspose.Cells предоставляет специальный набор классов в[**Aspose.Cells.Charts**](https://reference.aspose.com/cells/net/aspose.cells.charts) пространство имен, используемое для создания диаграмм, поддерживаемых Aspose.Cells. Эти классы используются для создания**графические объекты**, которые действуют как строительные блоки диаграммы. Объекты диаграммы перечислены ниже:

- Серии, отдельные ряды данных на диаграмме.
- Ось, ось диаграммы.
- Диаграмма, одна диаграмма Excel.
- ChartArea, область диаграммы на листе.
- ChartDataTable, таблица данных диаграммы.
- ChartFrame, объект рамки в диаграмме.
- ChartPoint, отдельная точка в ряду на диаграмме.
- ChartPointCollection — коллекция, содержащая все точки одной серии.
- Charts — коллекция объектов Chart.
- DataLabels — коллекция всех объектов DataLabel для указанной серии.
- FillFormat, формат заливки фигуры.
- Этаж, пол 3D графика.
- Легенда, легенда диаграммы.
- Линия, линия графика.
- SeriesCollection, коллекция объектов Series.
- TickLabels — метки делений, связанные с делениями на оси диаграммы.
- Название, название диаграммы или оси.
- Trendline, линия тренда на графике.
- TrendlineCollection — коллекция всех объектов Trendline для указанного ряда данных.
- Стены, стены 3D графика.

#### **Использование объектов диаграммы**

Как упоминалось выше, все объекты диаграммы являются экземплярами соответствующих классов и предоставляют определенные свойства и методы для выполнения определенных задач. Используйте объекты диаграммы для создания диаграмм.

Добавьте любой тип диаграммы на рабочий лист, используя[**Графики**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/properties/charts) коллекция. Каждый элемент в[**Графики**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/properties/charts) коллекция представляет собой[**Диаграмма**](https://reference.aspose.com/cells/net/aspose.cells.charts/chart) объект. А[**Диаграмма**](https://reference.aspose.com/cells/net/aspose.cells.charts/chart)Объект инкапсулирует все другие объекты диаграммы, необходимые для настройки внешнего вида диаграммы. В следующем разделе показано, как использовать несколько основных объектов диаграммы для создания простой диаграммы.

### **Создайте диаграмму, используя Aspose.Cells**

**Шаги:**

1.  Добавьте некоторые данные в ячейки листа с помощью[**Cell**](https://reference.aspose.com/cells/net/aspose.cells/cell) объекты[**путвалуе**](https://reference.aspose.com/cells/net/aspose.cells/cell/methods/putvalue/index)метод.
 Это будет использоваться в качестве источника данных для диаграммы.
1.  Добавьте диаграмму на лист, вызвав метод[**Графики**](https://reference.aspose.com/cells/net/aspose.cells.charts/chartcollection) коллекция[**Добавлять**](https://reference.aspose.com/cells/net/aspose.cells.charts/chartcollection/methods/add) метод, заключенный в[**Рабочий лист**](https://reference.aspose.com/cells/net/aspose.cells/worksheet)объект.
1.  Укажите тип диаграммы с помощью[**Тип диаграммы**](https://reference.aspose.com/cells/net/aspose.cells.charts/charttype)перечисление.
 Например, в приведенном ниже примере используется[**ChartType.Pyramid**](https://reference.aspose.com/cells/net/aspose.cells.charts/charttype)значение в качестве типа диаграммы.
1.  Доступ к новым[**Диаграмма**](https://reference.aspose.com/cells/net/aspose.cells.charts/chart) объект из[**Графики**](https://reference.aspose.com/cells/net/aspose.cells.charts/chartcollection)коллекции, передав ее индекс.
1.  Используйте любой из объектов диаграммы, инкапсулированных в[**Диаграмма**](https://reference.aspose.com/cells/net/aspose.cells.charts/chart)объект для управления диаграммой.
 В приведенном ниже примере используется[**СерияКоллекция**](https://reference.aspose.com/cells/net/aspose.cells.charts/seriescollection)объект диаграммы, чтобы указать источник данных диаграммы.

При добавлении исходных данных на диаграмму источником данных может быть диапазон ячеек (например, «A1:C3»), последовательность несмежных ячеек (например, «A1, A3, A5») или последовательность ячеек. значения (например, "1,2,3").

Эти общие шаги позволяют создавать диаграммы любого типа. Используйте разные объекты диаграмм для создания разных диаграмм.

 С помощью Aspose.Cells можно создать множество различных типов диаграмм. Все стандартные диаграммы, поддерживаемые Aspose.Cells, предварительно определены в перечислении с именем[**Aspose.Cells.Charts.ChartType**](https://reference.aspose.com/cells/net/aspose.cells.charts/charttype).

Предустановленные типы диаграмм:

|**Типы диаграмм**|**Описание**|
|:- |:- |
|Столбец|Представляет кластеризованную гистограмму|
|КолонкаС накоплением|Представляет столбчатую диаграмму с накоплением|
|Столбец100PercentStacked|Представляет столбчатую диаграмму с накоплением на 100 %|
|Column3DClustered|Представляет 3D кластеризованную столбчатую диаграмму|
|Столбец3DStacked|Представляет трехмерную столбчатую диаграмму с накоплением|
|Столбец3D100PercentStacked|Представляет трехмерную столбчатую диаграмму со 100% накоплением|
|Колонка3D|Представляет трехмерную столбчатую диаграмму|
|Бар|Представляет кластеризованную гистограмму|
|БарСложенный|Представляет столбчатую диаграмму с накоплением|
|Bar100PercentStacked|Представляет гистограмму со 100% накоплением|
|Bar3DCкластеризованный|Представляет трехмерную кластеризованную гистограмму|
|Bar3DStacked|Представляет трехмерную линейчатую диаграмму с накоплением|
|Bar3D100PercentStacked|Представляет трехмерную линейчатую диаграмму со 100% накоплением|
|Линия|Представляет линейную диаграмму|
|LineStacked|Представляет составную линейную диаграмму|
|Line100PercentStacked|Представляет 100% линейную диаграмму с накоплением|
|LineWithDataMarkers|Представляет линейную диаграмму с маркерами данных|
|LineStackedWithDataMarkers|Представляет составную линейную диаграмму с маркерами данных|
|Line100PercentStackedWithDataMarkers|Представляет линейную диаграмму с накоплением 100% с маркерами данных|
|Линия3D|Представляет трехмерную линейную диаграмму|
|пирог|Представляет круговую диаграмму|
|Пирог3D|Представляет трехмерную круговую диаграмму|
|пирог пирог|Представляет круговую диаграмму|
|ПирогВзорван|Представляет развернутую круговую диаграмму|
|Pie3DВзорван|Представляет трехмерную развернутую круговую диаграмму|
|Пиг-Бар|Представляет гистограмму круговой диаграммы|
|Разброс|Представляет точечную диаграмму|
|ScatterConnectedByCurvesWithDataMarker|Представляет точечную диаграмму, соединенную кривыми, с маркерами данных|
|ScatterConnectedByCurvesWithoutDataMarker|Представляет точечную диаграмму, соединенную кривыми, без маркеров данных|
|ScatterConnectedByLinesWithDataMarker|Представляет точечную диаграмму, соединенную линиями, с маркерами данных.|
|ScatterConnectedByLinesWithoutDataMarker|Представляет точечную диаграмму, соединенную линиями, без маркеров данных.|
|Площадь|Представляет диаграмму областей|
|ПлощадьСложенный|Представляет составную диаграмму с областями|
|Area100PercentStacked|Представляет 100% диаграмму областей с накоплением|
|Площадь3D|Представляет трехмерную диаграмму с областями|
|Площадь3DС накоплением|Представляет трехмерную диаграмму с накоплением областей|
|Area3D100PercentStacked|Представляет трехмерную диаграмму с областями со 100% накоплением|
|Пончик|Представляет кольцевую диаграмму|
|ПончикВзорван|Представляет развернутую кольцевую диаграмму|
|Радар|Представляет радиолокационную диаграмму|
|Радарвисдатамаркерс|Представляет радарную диаграмму с маркерами данных|
|Радар заполнен|Представляет заполненную радиолокационную диаграмму|
|Поверхность3D|Представляет трехмерную поверхностную диаграмму|
|ПоверхностьКаркас3D|Представляет каркасную трехмерную поверхностную диаграмму|
|ПоверхностьКонтур|Представляет контурную диаграмму|
|ПоверхностьКонтурКаркас|Представляет контурную диаграмму каркаса|
|Пузырь|Представляет пузырьковую диаграмму|
|Пузырь3D|Представляет трехмерную пузырьковую диаграмму|
|Цилиндр|Представляет цилиндрическую диаграмму|
|ЦилиндрСложенный|Представляет составную цилиндрическую диаграмму|
|Цилиндр100PercentStacked|Представляет 100%-ную цилиндрическую диаграмму с накоплением|
|ЦилиндрическийБар|Представляет собой цилиндрическую гистограмму.|
|ЦилиндрическийБарС накоплением|Представляет цилиндрическую гистограмму с накоплением|
|ЦилиндрическийBar100PercentStacked|Представляет цилиндрическую гистограмму со 100% накоплением|
|ЦилиндрическийКолонна3D|Представляет трехмерную цилиндрическую столбчатую диаграмму|
|Конус|Представляет конусную диаграмму|
|КонусСложенный|Представляет составную конусную диаграмму|
|конус100процентов|Представляет конусную диаграмму со 100% накоплением|
|КоническийБар|Представляет коническую гистограмму|
|КоническийБарС накоплением|Представляет составную коническую гистограмму|
|ConicalBar100PercentStacked|Представляет 100%-ную коническую гистограмму с накоплением|
|КоническаяКолонна3D|Представляет трехмерную коническую столбчатую диаграмму|
|Пирамида|Представляет пирамидальную диаграмму|
|ПирамидаСложенный|Представляет пирамидальную диаграмму с накоплением|
|Пирамида100PercentStacked|Представляет 100% пирамидальную диаграмму с накоплением|
|ПирамидаБар|Представляет пирамидальную гистограмму|
|ПирамидаБарС накоплением|Представляет гистограмму с накоплением пирамиды|
|PyramidBar100PercentStacked|Представляет гистограмму пирамидальной гистограммы со 100% накоплением|
|ПирамидаКолонка3D|Представляет гистограмму трехмерной пирамиды|
{{% alert color="primary" %}}

Когда вы назначаете диапазон ячеек в качестве источника данных, вы можете установить только диапазон от верхнего левого угла до нижнего правого. Например, «A1:C3» является допустимым, а «C3:A1» — недопустимым.

{{% /alert %}}

#### **Пирамидальная диаграмма**

При выполнении примера кода на рабочий лист добавляется пирамидальная диаграмма.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Charts-ManipulateChart-HowToCreatePyramidChart-1.cs" >}}

#### **Линейный график**

 В приведенном выше примере простое изменение[**Тип диаграммы**](https://reference.aspose.com/cells/net/aspose.cells.charts/charttype) к*Линия*создает линейную диаграмму. Полный источник приведен ниже. когда код выполняется, на лист добавляется линейная диаграмма.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Charts-ManipulateChart-HowToCreateLineChart-1.cs" >}}

#### **Пузырьковая диаграмма**

 Чтобы создать пузырьковую диаграмму,[**Тип диаграммы**](https://reference.aspose.com/cells/net/aspose.cells.charts/charttype) должен быть установлен на[**ChartType.Bubble**](https://reference.aspose.com/cells/net/aspose.cells.charts/charttype)и несколько дополнительных свойств, таких как BubbleSizes, Values и XValues, должны быть установлены соответствующим образом. После выполнения следующего кода на рабочий лист добавляется пузырьковая диаграмма.

#### **Линия с диаграммой маркеров данных**

 Чтобы создать линию с диаграммой маркера данных,[**Тип диаграммы**](https://reference.aspose.com/cells/net/aspose.cells.charts/charttype)должен быть установлен на*ChartType.LineWithDataMarkers*и несколько дополнительных свойств, таких как фоновая область, маркеры серии, значения и XValues, должны быть установлены соответствующим образом. После выполнения следующего кода на лист добавляется строка с диаграммой маркеров данных.

{{< gist "aspose-cells-gists" "88c9872508ec3150c552eb5155edf06e" "Examples-CSharp-Charts-CreateLineWithDataMarkerChart-1.cs" >}}

## **Предварительные темы**
- [Чтение и обработка диаграмм Excel 2016](/cells/ru/net/read-and-manipulate-excel-2016-charts/)
- [Управление осями диаграмм Excel](/cells/ru/net/chart-axes/)
- [Настройка внешнего вида диаграммы](/cells/ru/net/setting-chart-appearance/)
- [Типы диаграмм](/cells/ru/net/chart-types/)
- [Настройка диаграмм](/cells/ru/net/customizing-charts/)
- [Установить источник данных для диаграммы](/cells/ru/net/data-formatting-in-charts/)
- [Управление метками данных диаграмм Excel](/cells/ru/net/insert-datalabels-to-chart/)
- [Сгенерируйте диаграмму, обработав интеллектуальные маркеры](/cells/ru/net/generate-chart-by-processing-smart-markers/)
- [Получить рабочий лист диаграммы](/cells/ru/net/get-worksheet-of-the-chart/)
- [Управление легендой диаграмм Excel](/cells/ru/net/chart-legend/)
- [Управление размером позиции и графиком дизайнера](/cells/ru/net/manipulate-position-size-and-designer-chart/)
- [Создание круговой диаграммы с линиями выноски](/cells/ru/net/creating-pie-chart-with-leader-lines/)
- [Фигуры в диаграммах](/cells/ru/net/controls-in-charts/)
- [Управление заголовками диаграмм Excel](/cells/ru/net/chart-and-axis-titles/)
- [Отображение диаграммы](/cells/ru/net/chart-rendering/)
- [Получить текст уравнения линии тренда диаграммы](/cells/ru/net/get-equation-text-of-chart-trendline/)
