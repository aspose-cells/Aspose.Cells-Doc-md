---
title: Три метода фильтрации данных диаграммы
description: Узнайте, как фильтровать диаграммы в Excel с помощью Aspose.Cells for .NET. Наше подробное руководство покажет, как применять фильтры к диаграммам, настраивать элементы диаграммы и использовать инструменты анализа данных для лучшего понимания и принятия обоснованных решений.
keywords: Aspose.Cells for .NET, Filtering Charts in Excel, Data Analysis, Decision Making, Visualization.
type: docs
weight: 2210
url: /ru/net/filtering-charts-in-excel/
---
{{% alert color="primary" %}}

##  **1. Фильтрация рядов для отображения диаграммы**

###  **Действия по фильтрации рядов из диаграммы в Excel**
 В Excel мы можем отфильтровать определенные серии из диаграммы, в результате чего эти отфильтрованные серии не будут отображаться на диаграмме. Исходная диаграмма представлена на**Рисунок 1**. Однако, когда мы отфильтровываем **Testseries2** и *Testseries4**, диаграмма будет выглядеть так, как показано на *Рис. 2**.

 По номеру Aspose.Cells мы можем выполнить аналогичную операцию. Для[образец](seriesFiltered.xlsx) такой файл, если мы хотим отфильтровать**Тестсерия2** и *Testseries4**, мы можем выполнить следующий код. Кроме того, мы будем поддерживать два списка: один ([NСерия](https://reference.aspose.com/cells/net/aspose.cells.charts/chart/nseries/)) список для хранения всех выбранных серий и еще ([Отфильтрованная серия](https://reference.aspose.com/cells/net/aspose.cells.charts/chart/filteredSeries/)) для сохранения отфильтрованной серии.

Пожалуйста**примечание** это в коде, когда мы устанавливаем**chart.NSeries[0].IsFiltered = true;** первая серия в [NSeries](https://reference.aspose.com/cells/net/aspose.cells.charts/chart/nseries/) будет удалена и помещен в соответствующую позицию в [FilteredNSeries](https://reference.aspose.com/cells/net/aspose.cells.charts/chart/filteredSeries/). Впоследствии предыдущая **NSeries[1]** станет новым первым элементом в списке, а все последующие серии сместятся на одну позицию вперед. Это означает, что если мы затем запустим *chart.NSeries[1].IsFiltered = true;**, мы фактически удалим исходную третью серию. Иногда это может привести к путанице, поэтому рекомендуем проследить за операцией в коде, удаляющей серии с конца в начало.

![задача: image_alt_text](Figure1.png)

![задача: image_alt_text](Figure2.png)

###  **Образец кода**
 Следующий пример кода загружает[образец файла Excel](seriesFiltered.xlsx).

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "seriesFiltered.cs" >}}

##  **2. Отфильтруйте данные и позвольте диаграмме измениться.**

Фильтрация данных — отличный способ обработки фильтров диаграмм с большим количеством данных. Когда вы отфильтруете данные, диаграмма изменится. Одна из проблем, которую нам предстоит решить, — это обеспечить, чтобы диаграмма оставалась на экране. При фильтрации вы получаете скрытые строки, и иногда в этих скрытых строках оказывается диаграмма.

![задача: image_alt_text](Figure3.png)

###  **Действия по использованию фильтров данных для изменения диаграммы в Excel**

1. Щелкните внутри диапазона данных.
 2. Нажмите кнопку**Данные** и включите «Фильтры», нажав «Фильтры». В строке заголовка будут стрелки раскрывающегося списка.
 3. Создайте диаграмму, перейдя в**Вставлять** вкладку и выберите столбчатую диаграмму.
4. Теперь отфильтруйте данные, используя стрелки раскрывающегося списка в данных. Не используйте фильтры диаграмм.

###  **Образец кода**
В следующем примере кода показана та же самая функция с использованием Aspsoe.Cells.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "DataFilters.cs" >}}

##  **3. Отфильтруйте данные с помощью таблицы и позвольте диаграмме измениться.**

Использование таблицы аналогично методу 2 с использованием диапазона, но таблицы имеют преимущества перед диапазонами. Когда вы меняете диапазон на таблицу и добавляете данные, диаграмма автоматически обновляется. При наличии диапазона вам придется сменить источник данных.

###  **Форматировать как таблицу в Excel**

 Щелкните внутри своих данных и используйте**CTRL + Т** или воспользуйтесь вкладкой «Главная»,**Форматировать как таблицу**

![задача: image_alt_text](Figure4.png)

###  **Образец кода**
 Следующий пример кода загружает[образец файла Excel](TableFilters.xlsx) показывает то же самое, используя Aspsoe.Cells.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "TableFilters.cs" >}}