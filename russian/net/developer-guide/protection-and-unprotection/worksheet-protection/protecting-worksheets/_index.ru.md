---
title: Защита рабочих листов
type: docs
weight: 10
url: /ru/net/protecting-worksheets/
---
{{% alert color="primary" %}}

Когда рабочий лист защищен, действия, которые может выполнять пользователь, ограничены. Например, они не могут вводить данные, вставлять или удалять строки или столбцы и т. д.

{{% /alert %}}

## **Защитить рабочие листы**

### **Введение**

Общие параметры защиты в Microsoft Excel:

- Содержание
- Объекты
- Сценарии

Защищенные рабочие листы не скрывают и не защищают конфиденциальные данные, поэтому они отличаются от шифрования файлов. Как правило, защита рабочего листа подходит для презентационных целей. Он не позволяет конечному пользователю изменять данные, содержимое и форматирование на листе.

### **Защитить рабочий лист**

 Aspose.Cells предоставляет класс,[**Рабочая тетрадь**](https://reference.aspose.com/cells/net/aspose.cells/workbook) который представляет собой файл Excel Microsoft.[**Рабочая тетрадь**](https://reference.aspose.com/cells/net/aspose.cells/workbook) класс содержит[**Рабочие листы**](https://reference.aspose.com/cells/net/aspose.cells/workbook/properties/worksheets) коллекция, которая обеспечивает доступ к каждому рабочему листу в файле Excel. Рабочий лист представлен[**Рабочий лист**](https://reference.aspose.com/cells/net/aspose.cells/worksheet)учебный класс.

[**Рабочий лист**](https://reference.aspose.com/cells/net/aspose.cells/worksheet)класс обеспечивает[**Защищать**](https://reference.aspose.com/cells/net/aspose.cells/worksheet/methods/protect/index) метод, который используется для применения защиты на рабочем листе.[**Защищать**](https://reference.aspose.com/cells/net/aspose.cells.worksheet/protect/methods/1) метод принимает следующие параметры:

-  Тип защиты — тип защиты, применяемый к рабочему листу. Тип защиты применяется с помощью[**Тип защиты**](https://reference.aspose.com/cells/net/aspose.cells/protectiontype)перечисление.
- Новый пароль, новый пароль, используемый для защиты рабочего листа.
- Старый пароль, старый пароль, если рабочий лист уже защищен паролем. Если рабочий лист еще не защищен, просто передайте null.

[**Тип защиты**](https://reference.aspose.com/cells/net/aspose.cells/protectiontype)перечисление содержит следующие предопределенные типы защит:

|**Типы защиты**|**Описание**|
|:- |:- |
|Все|Пользователь не может ничего изменить на этом листе|
|Содержание|Пользователь не может вводить данные в этот рабочий лист|
|Объекты|Пользователь не может изменять объекты чертежа|
|Сценарии|Пользователь не может изменять сохраненные сценарии|
|Структура|Пользователь не может изменить структуру|
|Windows|Защита применяется к окнам|
|Никто|Защита не применяется|

В приведенном ниже примере показано, как защитить рабочий лист паролем.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Security-Protecting-ProtectingWorksheet-1.cs" >}}

После того, как приведенный выше код используется для защиты рабочего листа, вы можете проверить защиту рабочего листа, открыв его. Как только вы откроете файл и попытаетесь добавить некоторые данные на лист, вы увидите следующий диалог:

|**Диалоговое окно с предупреждением о том, что пользователь не может изменить рабочий лист**|
|:- |
|![дело:изображение_альтернативный_текст](protecting-worksheets_1.png)|

Чтобы работать с рабочим листом, снимите с него защиту, выбрав**Защита** , тогда**Снять защиту с листа** от**Инструменты** пункт меню.

После того, как вы выберете пункт меню «Снять защиту листа», откроется диалоговое окно, в котором вам будет предложено ввести пароль, чтобы вы могли работать с рабочим листом, как показано ниже:

|![дело:изображение_альтернативный_текст](protecting-worksheets_2.png)|

### **Защитите несколько Cells на рабочем листе с помощью Microsoft Excel**

 Могут быть определенные сценарии, в которых вам нужно заблокировать только несколько ячеек на листе. Если вы хотите заблокировать некоторые определенные ячейки на листе, вы должны разблокировать все остальные ячейки на листе. Все ячейки на рабочем листе уже инициализированы для блокировки, вы можете проверить это, открыв любой файл Excel в MS Excel и щелкнув значок**Формат | Cells...** показывать**Формат Cells**диалоговое окно, а затем нажмите кнопку**Защита** вкладку и увидите, что флажок «Заблокировано» установлен по умолчанию.

Следующие пункты описывают, как заблокировать несколько ячеек с помощью MS Excel. Этот метод применяется к Microsoft Office Excel 97, 2000, 2002, 2003 и более поздним версиям.

1.  Выделите весь рабочий лист, нажав кнопку**Выбрать все** кнопка (серый прямоугольник непосредственно над номером строки для строки 1 и слева от буквы столбца A).
1.  Нажмите**Cells** на**Формат** меню, нажмите на**Защита** вкладку, а затем снимите флажок**Заблокировано** флажок.
 Это разблокирует все ячейки на листе.
 Если**Cells** команда недоступна, возможно, части рабочего листа уже заблокированы. На**Инструменты** меню, указать**Защита** , а затем щелкните**Снять защиту с листа**.
1.  Выберите только ячейки, которые вы хотите заблокировать, и повторите шаг 2, но на этот раз выберите**Заблокировано** флажок.
1.  На**Инструменты** меню, указать**Защита** , нажмите**Защитить лист** а затем нажмите**ХОРОШО**.
1.  в**Защитить лист** диалоговое окно, у вас есть возможность указать пароль и выбрать элементы, которые вы хотите, чтобы пользователи могли изменять.

### **Защитите несколько Cells на рабочем листе, используя Aspose Cells**

В этом методе мы используем Aspose.Cells API только для выполнения задачи.

 Пример: В следующем примере показано, как защитить несколько ячеек на листе. Сначала он разблокирует все ячейки на листе, а затем заблокирует в нем 3 ячейки (A1, B1, C1). Наконец, он защищает рабочий лист.[**Стиль**](https://reference.aspose.com/cells/net/aspose.cells/style)объект содержит логическое свойство,[**Заблокировано**](https://reference.aspose.com/cells/net/aspose.cells/style/properties/islocked) . Вы можете установить[**Заблокировано**](https://reference.aspose.com/cells/net/aspose.cells/style/properties/islocked) свойство в true или false и применить*Столбец/Строка.ApplyStyle()* метод, чтобы заблокировать или разблокировать строку/столбец с нужными атрибутами.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Security-Protecting-ProtectingSpecificCellsinaWorksheet-1.cs" >}}

### **Защитить строку на листе**

 Aspose.Cells позволяет легко заблокировать любую строку на листе. Здесь мы можем использовать[**ПрименитьСтиль()**](https://reference.aspose.com/cells/net/aspose.cells/row/methods/applystyle) метод[**Aspose.Cells.Row**](https://reference.aspose.com/cells/net/aspose.cells/row) класс для применения[**Стиль**](https://reference.aspose.com/cells/net/aspose.cells/style) к определенной строке рабочего листа. Этот метод принимает два аргумента:[**Стиль**](https://reference.aspose.com/cells/net/aspose.cells/style) объект и[**СтильФлаг**](https://reference.aspose.com/cells/net/aspose.cells/styleflag) объект, у которого есть все элементы, связанные с примененным форматированием.

 В следующем примере показано, как защитить строку на листе. Он сначала разблокирует все ячейки на листе, а затем заблокирует первую строку в нем. Наконец, он защищает рабочий лист.[**Стиль**](https://reference.aspose.com/cells/net/aspose.cells/style) объект содержит логическое свойство,[**Заблокировано**](https://reference.aspose.com/cells/net/aspose.cells/style/properties/islocked) . Вы можете установить[**Заблокировано**](https://reference.aspose.com/cells/net/aspose.cells/style/properties/islocked) значение true или false, чтобы заблокировать или разблокировать строку/столбец с помощью[**СтильФлаг**](https://reference.aspose.com/cells/net/aspose.cells/styleflag)объект.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Security-Protecting-ProtectingSpecificRowInWorksheet-1.cs" >}}

### **Защитить столбец на листе**

 Aspose.Cells позволяет легко заблокировать любой столбец на листе. Здесь мы можем использовать[**ПрименитьСтиль()**](https://reference.aspose.com/cells/net/aspose.cells/column/methods/applystyle) метод[**Aspose.Cells.Column**](https://reference.aspose.com/cells/net/aspose.cells/column) класс для применения[**Стиль**](https://reference.aspose.com/cells/net/aspose.cells/style) к определенному столбцу на листе. Этот метод принимает два аргумента:[**Стиль**](https://reference.aspose.com/cells/net/aspose.cells/style) объект и[**СтильФлаг**](https://reference.aspose.com/cells/net/aspose.cells/styleflag)объект, у которого есть все элементы, связанные с примененным форматированием.

В следующем примере показано, как защитить столбец на листе. Сначала он разблокирует все ячейки на листе, а затем заблокирует первый столбец в нем. Наконец, он защищает рабочий лист.[**Стиль**](https://reference.aspose.com/cells/net/aspose.cells/style) объект содержит логическое свойство,[**Заблокировано**](https://reference.aspose.com/cells/net/aspose.cells/style/properties/islocked) . Вы можете установить[**Заблокировано**](https://reference.aspose.com/cells/net/aspose.cells/style/properties/islocked) значение true или false, чтобы заблокировать или разблокировать строку/столбец с помощью[**СтильФлаг**](https://reference.aspose.com/cells/net/aspose.cells/styleflag)объект.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Security-Protecting-ProtectColumnWorksheet-1.cs" >}}

### **Разрешить пользователям редактировать диапазоны**

В следующем примере показано, как разрешить пользователям редактировать диапазон на защищенном листе.

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "Examples-CSharp-Worksheets-Security-Protecting-EditRangesWorksheet-1.cs" >}}
