---
title: Как предотвратить пользователей от печати файлов Excel
type: docs
weight: 600
url: /ru/net/how-to-prevent-printing-excel/
description: Узнайте, как предотвратить печать Excel через API Aspose.Cells for .NET.
keywords: печать excel, предотвращение печати excel, как предотвратить пользователей от печати excel, excel предотвращение печати, предотвращение печати рабочей книги, Предотвращение печати всей книги с помощью VBA. 
---

## **Возможные сценарии использования**
В нашей повседневной работе в файле Excel может содержаться важная информация, и чтобы защитить внутренние данные от разглашения, компания не позволит нам их печатать. Этот документ расскажет вам, как предотвратить других от печати файлов Excel.

## **Как предотвратить пользователей от печати файла в MS-Excel**
Вы можете применить следующий VBA-код для защиты вашего определенного файла от печати.
1. Откройте свою книгу, которую вы не разрешаете печатать.
1. Выберите вкладку "Разработчик" на ленте Excel и нажмите кнопку "Просмотр кода" в разделе "Элементы управления". В противном случае вы можете удерживать клавиши ALT + F11, чтобы открыть окно Microsoft Visual Basic for Applications.
<br>
<img src="1.png" width=70% />
1. Затем в левом окне Обозреватель проектов дважды щелкните ThisWorkbook, чтобы открыть модуль, и добавьте некоторые vba-коды.
<br>
<img src="2.png" width=70% />
1. Затем сохраните и закройте этот код, вернитесь к книге и сейчас, когда вы печатаете образцовый файл, их не разрешат печатать, и вы получите следующее предупреждающее окно:
<br>
<img src="3.png" width=70% />

## **Как предотвратить пользователей от печати файла Excel с использованием Aspose.Cells for .NET**

Следующий образец кода иллюстрирует, как предотвратить пользователя от печати файла Excel:

1. Загрузите [образец файла](sample.xlsx).
1. Получите объект VbaModuleCollection из свойства VbaProject объекта Workbook.
1. Получите объект VbaModule с помощью имени "ThisWorkbook".
1. Установите свойство codes объекта VbaModule.
1. Сохраните образец файла в формате [xlsm](out.xlsm).

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "VBA-Prevent-printing-excel.cs" >}}
