---
title: Как запретить пользователям печатать файл Excel
type: docs
weight: 600
url: /ru/net/how-to-prevent-printing-excel/
description: Узнайте, как запретить пользователям печатать Excel с помощью номера Aspose.Cells for .NET API.
keywords: excel printing, prevent printing excel, how to prevent users from printing excel, excel prevent printing, prevent printing workbook, Prevent users from printing the whole workbook with VBA. 
---
##  **Возможные сценарии использования**
В нашей повседневной работе в файле Excel может содержаться некоторая важная информация, поэтому в целях защиты внутренних данных компания не разрешает нам их распечатывать. В этом документе рассказывается, как запретить другим пользователям печатать файлы Excel.

##  **Как запретить пользователям печатать файл в MS-Excel**
Вы можете применить следующий код VBA, чтобы защитить конкретный файл для печати.
1. Откройте книгу, которую вы не разрешаете другим печатать.
1. Выберите вкладку «Разработчик» на ленте Excel и нажмите кнопку «Просмотреть код» в разделе «Элементы управления». Альтернативно вы можете удерживать клавиши ALT + F11, чтобы открыть окно Microsoft Visual Basic для приложений.
<br>
<img src="1.png" width=70% />
1. Затем в левом обозревателе проектов дважды щелкните ThisWorkbook, чтобы открыть модуль, и добавьте несколько кодов VBA.
<br>
<img src="2.png" width=70% />
1. Затем сохраните и закройте этот код и вернитесь к книге, и теперь, когда вы распечатаете файл образца, его нельзя будет распечатать, и вы увидите следующее окно с предупреждением:
<br>
<img src="3.png" width=70% />

##  **Как запретить пользователям печатать файл Excel с помощью Aspose.Cells for .NET**

В следующем примере кода показано, как запретить пользователям печатать файл Excel:

1.  Загрузите[образец файла](sample.xlsx).
1. Получите объект VbaModuleCollection из свойства VbaProject книги.
1. Получите объект VbaModule через имя «ThisWorkbook».
1. Установите свойство кодов VbaModule.
1.  Сохраните файл примера в[формат xlsm](out.xlsm).

{{< gist "aspose-cells-gists" "59a1901d62ea9ceb08456a818431a898" "VBA-Prevent-printing-excel.cs" >}}