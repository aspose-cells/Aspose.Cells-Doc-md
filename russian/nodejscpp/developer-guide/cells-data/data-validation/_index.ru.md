---  
title: Валидация данных
type: docs  
weight: 90  
url: /ru/nodejs-cpp/data-validation/  
description: Узнайте, как добавлять проверку данных через API Aspose.Cells for Node.js via C++.  
keywords: Добавить проверку данных Node.js через C++, получить значение проверки Node.js через C++, добавить проверку на целое число Node.js через C++, добавить список данных для проверки Node.js через C++, добавить проверку даты Node.js через C++, добавить проверку времени Node.js через C++, добавить длину текста в ячейке Node.js через C++, добавить CellArea в существующую проверку Node.js через C++, проверить, является ли проверка в ячейке списком выбора Node.js через C++, добавить пользовательскую проверку Node.js через C++  
---  

{{% alert color="primary" %}}  
Microsoft Excel предоставляет отличные функции для автоматической фильтрации или проверки данных листа. Aspose.Cells полностью поддерживает возможности проверки данных и автофильтрации в Microsoft Excel. В этой статье объясняется, как использовать эти функции в Microsoft Excel и как их программировать с помощью Aspose.Cells for Node.js via C++.  
{{% /alert %}}  

## **Типы проверки данных и выполнение**  

Проверка данных - это возможность устанавливать правила, касающиеся ввода данных на листе таблицы. Например, использовать проверку для обеспечения того, что столбец с подписью DATE содержит только даты, или что другой столбец содержит только числа. Вы даже можете обеспечить, что столбец с подписью DATE содержит только даты в определенном диапазоне. С помощью проверки данных вы можете контролировать то, что вводится в ячейки на листе таблицы.  

Microsoft Excel поддерживает ряд различных типов проверки данных. Каждый тип используется для контроля типа данных, вводимого в ячейку или диапазон ячеек. Ниже приведены фрагменты кода, иллюстрирующие проверку, что:  

- Числа являются целыми, то есть у них нет десятичной части.  
- Десятичные числа соответствуют правильной структуре. Приведенный пример кода определяет, что диапазон ячеек должен иметь два десятичных знака.  
- Значения ограничены списком значений. Проверка списка определяет отдельный список значений, которые можно применить к ячейке или диапазону ячеек.  
- Даты находятся в определенном диапазоне.  
- Время находится в определенном диапазоне.  
- Текст имеет определенную длину.  

### **Проверка данных в Microsoft Excel**  

Для создания проверок с помощью Microsoft Excel:  

1. В листе выберите ячейки, к которым вы хотите применить проверку.  
1. Из меню **Данные** выберите **Проверку**. Диалоговое окно проверки будет отображено.  
1. Нажмите вкладку **Настройки** и введите настройки.  

### **Проверка данных с помощью Aspose.Cells for Node.js via C++**  

Проверка данных - мощная функция для проверки введенной информации в таблицы. С помощью проверки данных разработчики могут предоставлять пользователям список выбора, ограничивать ввод данных определенного типа или размера и т. д.  
В Aspose.Cells for Node.js via C++ каждый класс [**Worksheet**](https://reference.aspose.com/cells/nodejs-cpp/worksheet) имеет метод [**getValidations()**](https://reference.aspose.com/cells/nodejs-cpp/worksheet/#getValidations--), который представляет собой коллекцию объектов [**Validation**](https://reference.aspose.com/cells/nodejs-cpp/validation). Для настройки проверки установите некоторые свойства класса [**Validation**](https://reference.aspose.com/cells/nodejs-cpp/validation) следующим образом:  

- Тип – представляет тип проверки, который можно задать, используя один из предопределённых значений перечисления [**ValidationType**](https://reference.aspose.com/cells/nodejs-cpp/validationtype).  
- Оператор – представляет оператор, используемый при проверке, который можно задать с помощью одного из предопределённых значений перечисления [**OperatorType**](https://reference.aspose.com/cells/nodejs-cpp/operatortype).  
- Формула1 – представляет значение или выражение, связанное с первой частью валидации данных.  
- Формула2 – представляет значение или выражение, связанное со второй частью валидации данных.  

Когда свойства объекта [**Validation**](https://reference.aspose.com/cells/nodejs-cpp/validation) настроены, разработчики могут использовать структуру [**CellArea**](https://reference.aspose.com/cells/nodejs-cpp/cellarea) для хранения информации о диапазоне ячеек, которые будут проверены с помощью созданной проверки.  

#### **Типы проверки данных**  

Перечисление [**ValidationType**](https://reference.aspose.com/cells/nodejs-cpp/validationtype) содержит следующие члены:  

|**Название элемента**|**Описание**|  
| :- | :- |  
|AnyValue|Обозначает значение любого типа.|  
|WholeNumber|Обозначает тип проверки для целых чисел.|  
|Decimal|Обозначает тип проверки для десятичных чисел.|  
|List|Обозначает тип проверки для выпадающего списка.|  
|Date|Обозначает тип проверки для дат.|  
|Time|Обозначает тип проверки для времени.|  
|TextLength|Обозначает тип проверки для длины текста.|  
|Custom|Обозначает настраиваемый тип проверки.|  

##### **Проверка данных на целые числа**  

С этим типом проверки пользователи могут вводить только целые числа в указанный диапазон в проверяемых ячейках. Следующие примеры показывают, как реализовать тип проверки WholeNumber. В примерах создается такая же проверка данных с помощью Aspose.Cells for Node.js via C++, как и выше в Microsoft Excel.  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-WholeNumber.js" >}}


##### **Проверка данных на список**  

Этот тип проверки позволяет пользователю вводить значения из выпадающего списка. Он предоставляет список: серию строк, содержащих данные. В примере во втором рабочем листе добавляется список источников. Пользователи могут выбирать значения только из списка. Область проверки - это диапазон ячеек A1:A5 на первом рабочем листе.  

Важно отметить, что необходимо установить свойство [**Validation.setInCellDropDown(boolean)**](https://reference.aspose.com/cells/nodejs-cpp/validation/#setInCellDropDown-boolean-) в значение **true**.  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-ListData.js" >}}


##### **Проверка данных на дату**  

С этим типом проверки пользователи вводят значения дат в указанном диапазоне или отвечающие определенным критериям в проверяемые ячейки. В примере пользователь ограничен вводом дат с 1970 по 1999 год. Здесь область проверки – ячейка B1.  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-DateData.js" >}}

##### **Проверка данных на время**  

С этим типом проверки пользователи могут вводить время в указанном диапазоне, или соответствующее некоторым критериям, в проверяемые ячейки. В примере пользователь ограничен вводом времени с 09:00 по 11:30 утра. Здесь область проверки – ячейка B1.  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-TimeData.js" >}}


##### **Проверка данных на длину текста**  

С помощью этого типа проверки пользователи могут вводить текстовые значения заданной длины в проверяемые ячейки. В примере пользователь ограничен вводом строковых значений не более 5 символов. Область проверки - это ячейка B1.  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-TextLengthData.js" >}}


### **Правила проверки данных**  

При реализации проверок данных можно проверить их, присваивая ячейкам разные значения. [**Cell.getValidationValue()**](https://reference.aspose.com/cells/nodejs-cpp/cell/#getValidationValue--) можно использовать для получения результата проверки. Следующий пример демонстрирует эту возможность с разными значениями. Тестовый файл можно скачать по следующей ссылке для проверки:  

[sampleDataValidationRules.xlsx](77496339.xlsx)  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-DataValidationRules.js" >}}


## **Проверить, если проверка в ячейке выпадающая**  

Как мы увидели, существует много видов проверок, которые можно реализовать внутри ячейки. Если вы хотите проверить, является ли проверка списком выбора или нет, для этого можно использовать метод [**Validation.getInCellDropDown()**](https://reference.aspose.com/cells/nodejs-cpp/validation/#getInCellDropDown--). Следующий пример показывает, как применяется эта функция. Тестовый файл для проверки можно скачать по следующей ссылке:  

[sampleValidation.xlsx](79527947.xlsx)  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-CheckValidationIsDropDown.js" >}}


## **Добавить CellArea к существующей Validation**  

Могут быть ситуации, когда вы захотите добавить [**CellArea**](https://reference.aspose.com/cells/nodejs-cpp/cellarea) к существующему [**Validation**](https://reference.aspose.com/cells/nodejs-cpp/validation). При добавлении [**CellArea**](https://reference.aspose.com/cells/nodejs-cpp/cellarea) с помощью [**Validation.addArea(CellArea)**](https://reference.aspose.com/cells/nodejs-cpp/validation/#addArea-cellarea-) Aspose.Cells проверяет все существующие области, чтобы убедиться, что новая область уже не существует. Если файл содержит много проверок, это может повлиять на производительность. Чтобы этого избежать, API предоставляет метод [**Validation.addArea(CellArea, boolean, boolean)**](https://reference.aspose.com/cells/nodejs-cpp/validation/#addArea-cellarea-boolean-boolean-). Параметр *checkIntersection* указывает, нужно ли проверять пересечение области с существующими зонами проверки. Установка его в **false** отключит проверку других областей. Параметр *checkEdge* указывает, нужно ли проверять применяемые области. Если новая область становится верхним левым углом, внутренние настройки пересоздаются. Если вы уверены, что новая зона не является верхним левым углом, вы можете задать этот параметр как **false**.  

Следующий фрагмент кода демонстрирует использование метода [**Validation.addArea(CellArea, boolean, boolean)**](https://reference.aspose.com/cells/nodejs-cpp/validation/#addArea-cellarea-boolean-boolean-) для добавления новой [**CellArea**](https://reference.aspose.com/cells/nodejs-cpp/cellarea) к существующим [**Validation**](https://reference.aspose.com/cells/nodejs-cpp/validation).  

{{< gist "aspose-cells-gists" "c7b55cbeb75eaaae989115230a7619eb" "Cells-Data-DataValidation-AddCellAreaToExistingValidation.js" >}}

Исходный и выходной файлы Excel прикреплены для справки.  

[Исходный файл](96928093.xlsx)  

[Выходной файл](96928220.xlsx)  

## **Продвинутые темы**  
- [Получить проверку ячейки в файлах ODS](/cells/ru/nodejs-cpp/get-cell-validation-in-ods-files/)  
- [Получить примененную проверку данных к ячейке](/cells/ru/nodejs-cpp/get-validation-applied-on-a-cell/)  
- [Проверьте, что значение ячейки удовлетворяет правилам проверки данных](/cells/ru/nodejs-cpp/verify-that-cell-value-satisfies-data-validation-rules/)  

