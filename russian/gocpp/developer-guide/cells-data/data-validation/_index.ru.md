---
title: Валидация данных с помощью Golang через C++
linktitle: Валидация данных
type: docs
weight: 90
url: /ru/go-cpp/data-validation/
description: Узнайте, как добавлять проверку данных через API Aspose.Cells for C++.
keywords: Добавить проверку данных, получить значение проверки, добавить проверку на целое число, добавить список, добавить дату, добавить время, добавить длину текста, добавить CellArea в существующую проверку, проверить, является ли проверка выпадающим списком, добавить пользовательскую проверку  
---

{{% alert color="primary" %}}

Microsoft Excel предоставляет хорошие функции для автоматической фильтрации или проверки данных на листе. Aspose.Cells полностью поддерживает функции проверки данных и автоматической фильтрации Microsoft Excel. В этой статье объясняется, как использовать эти функции в Microsoft Excel и как программировать их с помощью Aspose.Cells.

{{% /alert %}}

## **Типы проверки данных и выполнение**

Проверка данных - это возможность устанавливать правила, касающиеся ввода данных на листе таблицы. Например, использовать проверку для обеспечения того, что столбец с подписью DATE содержит только даты, или что другой столбец содержит только числа. Вы даже можете обеспечить, что столбец с подписью DATE содержит только даты в определенном диапазоне. С помощью проверки данных вы можете контролировать то, что вводится в ячейки на листе таблицы.

Microsoft Excel поддерживает ряд различных типов проверки данных. Каждый тип используется для контроля типа данных, вводимого в ячейку или диапазон ячеек. Ниже приведены фрагменты кода, иллюстрирующие проверку, что:

- Числа являются целыми, то есть у них нет десятичной части.
- Десятичные числа соответствуют правильной структуре. Приведенный пример кода определяет, что диапазон ячеек должен иметь два десятичных знака.
- Значения ограничены списком значений. Проверка списка определяет отдельный список значений, которые можно применить к ячейке или диапазону ячеек.
- Даты находятся в определенном диапазоне.
- Время находится в определенном диапазоне.
- Текст имеет определенную длину.

### **Проверка данных в Microsoft Excel**

Для создания проверок с помощью Microsoft Excel:

1. В листе выберите ячейки, к которым вы хотите применить проверку.
1. Из меню **Данные** выберите **Проверку**. Диалоговое окно проверки будет отображено.
1. Нажмите вкладку **Настройки** и введите настройки.

### **Проверка данных в Aspose.Cells**

Проверка данных - мощная функция для проверки введенной информации в таблицы. С помощью проверки данных разработчики могут предоставлять пользователям список выбора, ограничивать ввод данных определенного типа или размера и т. д.
В Aspose.Cells для каждого [**Worksheet**](https://reference.aspose.com/cells/go-cpp/worksheet/) класса есть свойство [**GetValidations()**](https://reference.aspose.com/cells/go-cpp/worksheet/getvalidations/), которое представляет коллекцию объектов [**Validation**](https://reference.aspose.com/cells/cpp/aspose.cells/validation/). Чтобы настроить валидацию, установите некоторые из свойств класса [**Validation**](https://reference.aspose.com/cells/cpp/aspose.cells/validation/) как показано ниже:

- Тип – представляет тип валидации, который может быть указан, используя одно из предопределенных значений в перечислении [**ValidationType**](https://reference.aspose.com/cells/go-cpp/validationtype/).
- Оператор – представляет оператор, который следует использовать в проверке, который можно указать, используя одно из предопределенных значений в перечислении [**OperatorType**](https://reference.aspose.com/cells/go-cpp/operatortype/).
- Формула1 – представляет значение или выражение, связанное с первой частью валидации данных.
- Формула2 – представляет значение или выражение, связанное со второй частью валидации данных.

Когда свойства объекта [**Validation**](https://reference.aspose.com/cells/go-cpp/validation/) были настроены, разработчики могут использовать структуру [**CellArea**](https://reference.aspose.com/cells/cpp/aspose.cells/cellarea/), чтобы хранить информацию о диапазоне ячеек, который будет проверен с использованием созданной проверки.

#### **Типы проверки данных**

Перечисление [**ValidationType**](https://reference.aspose.com/cells/go-cpp/validationtype/) имеет следующие члены:

|**Название элемента**|**Описание**|
| :- | :- |
|AnyValue|Обозначает значение любого типа.|
|WholeNumber|Обозначает тип проверки для целых чисел.|
|Decimal|Обозначает тип проверки для десятичных чисел.|
|List|Обозначает тип проверки для выпадающего списка.|
|Date|Обозначает тип проверки для дат.|
|Time|Обозначает тип проверки для времени.|
|TextLength|Обозначает тип проверки для длины текста.|
|Custom|Обозначает настраиваемый тип проверки.|

##### **Проверка данных на целые числа**

С этим типом проверки пользователи могут вводить только целые числа в указанном диапазоне в проверяемые ячейки. Приведены примеры кода, показывающие, как реализовать тип проверки на целое число. Пример создает одинаковую проверку данных, используя Aspose.Cells, как мы создали, используя Microsoft Excel выше.

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation.go" >}}
##### **Проверка данных на список**

Этот тип проверки позволяет пользователю вводить значения из выпадающего списка. Он предоставляет список: серию строк, содержащих данные. В примере во втором рабочем листе добавляется список источников. Пользователи могут выбирать значения только из списка. Область проверки - это диапазон ячеек A1:A5 на первом рабочем листе.

Здесь важно установить свойство [**Validation.GetInCellDropDown()**](https://reference.aspose.com/cells/go-cpp/validation/getincelldropdown/) на **true**.

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation-1.go" >}}
##### **Проверка данных на дату**

С этим типом проверки пользователи вводят значения дат в указанном диапазоне или отвечающие определенным критериям в проверяемые ячейки. В примере пользователь ограничен вводом дат с 1970 по 1999 год. Здесь область проверки – ячейка B1.

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation-2.go" >}}
##### **Проверка данных на время**

С этим типом проверки пользователи могут вводить время в указанном диапазоне, или соответствующее некоторым критериям, в проверяемые ячейки. В примере пользователь ограничен вводом времени с 09:00 по 11:30 утра. Здесь область проверки – ячейка B1.

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation-3.go" >}}
##### **Проверка данных на длину текста**

С помощью этого типа проверки пользователи могут вводить текстовые значения заданной длины в проверяемые ячейки. В примере пользователь ограничен вводом строковых значений не более 5 символов. Область проверки - это ячейка B1.

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation-4.go" >}}
### **Правила проверки данных**

Когда проверки данных реализованы, то проверку можно проверить, присваивая различные значения в ячейках. Для извлечения результата проверки можно использовать [**Cell.GetValidationValue**](https://reference.aspose.com/cells/go-cpp/cell/getvalidationvalue/). Следующий пример демонстрирует это функциональность с различными значениями. Примерный файл можно скачать по следующей ссылке для тестирования:

[sampleDataValidationRules.xlsx](77496339.xlsx)

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation-5.go" >}}
## **Проверить, если проверка в ячейке выпадающая**

Как мы видели, существует множество типов проверок, которые могут быть реализованы в ячейке. Если вы хотите проверить, является ли проверка выпадающей или нет, свойство [**Validation.GetInCellDropDown()**](https://reference.aspose.com/cells/go-cpp/validation/getincelldropdown/) можно использовать для этого теста. В следующем примере кода демонстрируется использование этого свойства. Образец файла для тестирования можно загрузить по следующей ссылке:

[sampleValidation.xlsx](79527947.xlsx)

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation-6.go" >}}
## **Добавить CellArea к существующей Validation**

Может возникнуть случаи, когда вы хотите добавить [**CellArea**](https://reference.aspose.com/cells/go-cpp/cellarea/) к существующему [**Validation**](https://reference.aspose.com/cells/cpp/aspose.cells/validation/). Когда вы добавляете [**CellArea**](https://reference.aspose.com/cells/go-cpp/cellarea/) при помощи [**Validation.AddArea(CellArea cellArea)**](https://reference.aspose.com/cells/cpp/aspose.cells/validation/addarea/), Aspose.Cells проверяет все существующие области, чтобы увидеть, существует ли новая область уже. Если в файле большое количество проверок, это замедляет работу. Для преодоления этого API предоставляет метод [**Validation.AddAreaCellArea cellArea, bool checkIntersection, bool checkEdge)**](https://reference.aspose.com/cells/cpp/aspose.cells/validation/addarea/). Параметр *checkIntersection* указывает, следует ли проверять пересечение данной области с существующими областями проверок. Установка его в **false** отключит проверку других областей. Параметр *checkEdge* указывает, следует ли проверять примененные области. Если новая область становится верхним левым углом, внутренние настройки перестраиваются. Если вы уверены, что новая область не является верхним левым углом, вы можете установить этот параметр в **false**.

Следующий фрагмент кода демонстрирует использование метода [**Validation.AddAreaCellArea cellArea, bool checkIntersection, bool checkEdge)**](https://reference.aspose.com/cells/go-cpp/validation/addarea_cellarea/) для добавления нового [**CellArea**](https://reference.aspose.com/cells/cpp/aspose.cells/cellarea/) к существующему [**Validation**](https://reference.aspose.com/cells/cpp/aspose.cells/validation/).

{{< gist "aspose-cells-gists" "b414abd53259bbc47d2c3c0fe985395b" "Examples-Go-CPP-DataValidation-7.go" >}}
Исходный и выходной файлы Excel прикреплены для справки.

[Исходный файл](96928093.xlsx)

[Выходной файл](96928220.xlsx)

## **Продвинутые темы**
- [Получить проверку ячейки в файлах ODS](/cells/ru/cpp/get-cell-validation-in-ods-files/)
- [Получить примененную проверку данных к ячейке](/cells/ru/cpp/get-validation-applied-on-a-cell/)
- [Проверьте, что значение ячейки удовлетворяет правилам проверки данных](/cells/ru/cpp/verify-that-cell-value-satisfies-data-validation-rules/)
