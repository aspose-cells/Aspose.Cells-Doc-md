---
title: Добавление вычисляемого поля в сводной таблице
type: docs
weight: 130
url: /ru/python-net/add-calculated-field-in-pivot-table/
description: Как добавить вычисляемое поле в сводную таблицу с помощью Aspose.Cells для Python via .NET.
keywords: Aspose.Cells для Python Excel, библиотека Excel Python, Добавление вычисляемого поля в сводную таблицу с помощью Python Excel Library.
---

## **Возможные сценарии использования**
Когда вы создаете сводную таблицу на основе известных данных, вы обнаруживаете, что данные в ней не соответствуют вашим требованиям. Вы хотите объединить эти исходные данные. Например, вам нужно сложить, вычесть, умножить и разделить исходные данные перед тем, как вы их захотите. В этом случае вам нужно создать вычисляемое поле и установить соответствующую формулу для вычислений. Затем выполнить некоторые статистические и другие операции с вычисляемым полем. 

## **Как добавить вычисляемое поле в сводную таблицу в Excel**
Чтобы добавить вычисляемое поле в сводную таблицу в Excel, выполните следующие шаги:

1. Выберите сводную таблицу, к которой вы хотите добавить вычисляемое поле. 
2. Перейдите на вкладку Analyze в контекстном меню сводной таблицы.
3. Нажмите на "Поля, элементы и наборы" и затем выберите "Вычисляемое поле" в выпадающем меню.
4. В поле "Имя" введите имя для вычисляемого поля.
5. В поле "Формула" введите формулу для выполнения расчета, используя соответствующие имена полей сводной таблицы и математические операторы. 
<br>
<img src="1.png" width=80% />
6. Нажмите "ОК", чтобы создать вычисляемое поле.
7. Новое вычисляемое поле появится в списке полей сводной таблицы в разделе 'Значения'.
8. Перетащите вычисляемое поле в раздел 'Значения' сводной таблицы, чтобы отобразить вычисленные значения.
<br>
<img src="2.png" width=80% />

## **Как добавить вычисляемое поле в сводную таблицу с использованием библиотеки Aspose.Cells для Python Excel**
Добавить вычисляемое поле в файл Excel с помощью Aspose.Cells для Python via .NET. Пожалуйста, ознакомьтесь с примером кода ниже. После выполнения примера кода к рабочему листу добавляется сводная таблица с вычисляемым полем.
1. Задайте исходные данные и создайте сводную таблицу. 
2. Создайте расчетное поле согласно существующему PivotField в сводной таблице.
3. Добавьте расчетное поле в область данных. 
4. Наконец, сохраните книгу в формате [output XLSX](out.xlsx). 

## **Образец кода**
{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "PivotTables-Add-calculated-field-in-PivotTable.py" >}}
{{< app/cells/assistant language="python-net" >}}
