---
title: Три метода фильтрации данных диаграммы
description: Узнайте, как фильтровать диаграммы в Excel с помощью Aspose.Cells для Python via .NET. Наше подробное руководство покажет, как применять фильтры к диаграммам, настраивать элементы диаграммы и использовать инструменты анализа данных для получения лучших инсайтов и принятия решений.
keywords: Aspose.Cells для Python via .NET, Фильтрация диаграмм в Excel, Анализ данных, Принятие решений, Визуализация.
type: docs
weight: 2210
url: /ru/python-net/filtering-charts-in-excel/
---


## **1. Отфильтровать серии для отображения диаграммы**

### **Шаги по фильтрации серии с диаграммы в Excel**
В Excel мы можем отфильтровать определенные серии с диаграммы, что приводит к тому, что данные серии не отображаются на диаграмме. Исходная диаграмма показана на **Рисунке 1**. Однако, когда мы отфильтровываем **Тестовая серия2** и **Тестовая серия4**, диаграмма будет выглядеть как показано на **Рисунке 2**.

В Aspose.Cells для Python via .NET мы можем выполнить подобную операцию. Для файла [примера](seriesFiltered.xlsx), если мы хотим исключить **Testseries2** и **Testseries4**, мы можем выполнить следующий код. Кроме того, мы будем поддерживать два списка: один ([n_series](https://reference.aspose.com/cells/python-net/aspose.cells.charts/chart/n_series/)) для хранения всех выбранных серий и другой ([filtered_n_series](https://reference.aspose.com/cells/python-net/aspose.cells.charts/chart/filtered_n_series/)) для хранения отфильтрованных серий.

Обратите внимание, что в коде, когда мы устанавливаем **chart.nSeries[0].is_filtered = TRUE;**, первая серия в [n_series](https://reference.aspose.com/cells/python-net/aspose.cells.charts/chart/n_series/) будет удалена и помещена в соответствующую позицию внутри [filtered_n_series](https://reference.aspose.com/cells/python-net/aspose.cells.charts/chart/filtered_n_series/). После этого, предыдущий **nSeries[1]** станет новым первым элементом в списке, а все последующие серии сдвинутся вперед на одну позицию. Это значит, что если мы затем установим **chart.nSeries[1].is_filtered = TRUE;**, мы фактически удалим изначальную третью серию. Это иногда может привести к путанице, поэтому рекомендуется следовать операции в коде, которая удаляет серию с конца в начало.

![todo:image_alt_text](Figure1.png)

![todo:image_alt_text](Figure2.png)

### **Образец кода**
Приведенный ниже образец кода загружает [образец файла Excel](seriesFiltered.xlsx).

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Charts-seriesFiltered.py" >}}

## **2. Отфильтруйте данные и дайте диаграмме измениться**

Фильтрация данных - отличный способ обработки фильтров диаграмм с большим объемом данных. Когда вы фильтруете данные, диаграмма изменяется. Одной из проблем, с которой нам придется столкнуться, будет убеждение в том, что диаграмма остается на экране. При фильтрации вы получаете скрытые строки, и иногда диаграмма будет находиться в этих скрытых строках.

![todo:image_alt_text](Figure3.png)

### **Шаги для использования фильтров данных для изменения диаграммы в Excel**

1. Щелкните внутри вашего диапазона данных.
2. Щелкните вкладку **Данные** и включите фильтры, щелкнув по кнопке Фильтры. Ваша строка заголовка будет иметь выпадающие стрелки.
3. Создайте диаграмму, перейдя на вкладку **Вставка** и выбрав столбчатую диаграмму.
4. Теперь отфильтруйте свои данные, используя выпадающие стрелки в данных. Не используйте фильтры диаграммы.

### **Образец кода**
Приведенный ниже образец кода показывает ту же функцию с использованием Aspsoe.Cells.

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Charts-DataFilters.py" >}}

## **3. Отфильтруйте данные с помощью таблицы и дайте измениться диаграмме**

Использование таблицы похоже на Метод 2, используя диапазон, но у вас есть преимущества таблиц перед диапазонами. Когда вы изменяете свой диапазон на таблицу и добавляете данные, диаграмма автоматически обновляется. С диапазоном вам придется изменять источник данных.

### **Форматирование как таблица в Excel**

Щелкните внутри ваших данных и используйте **CTRL+T** или используйте вкладку **Главная**, **Форматировать как таблицу**

![todo:image_alt_text](Figure4.png)

### **Образец кода**
Приведенный ниже образец кода загружает [образец файла Excel](TableFilters.xlsx) показывает ту же функцию с использованием Aspsoe.Cells.

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Charts-TableFilters.py" >}}
