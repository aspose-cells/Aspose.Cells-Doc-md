---
title: Фильтрация данных
type: docs
weight: 85
url: /ru/python-net/data-filtering/
description: Узнайте, как добавить фильтр данных с помощью Aspose.Cells для Python via .NET API.
keywords: Библиотека Python Excel, Добавить фильтр по цвету, Добавить фильтры по дате, Добавить числовые фильтры, Добавить динамический фильтр, Добавить текстовые фильтры, Добавить пользовательский фильтр с содержит, Добавить пользовательский фильтр с не содержит, Добавить пользовательский фильтр с начинается с, Добавить пользовательский фильтр с заканчивается на
---

{{% alert color="primary" %}}

Microsoft Excel предоставляет хорошие возможности для автофильтрации данных на листе. Aspose.Cells для Python via .NET полностью поддерживает функции автофильтрации Microsoft Excel. В этой статье объясняется, как использовать функции в Microsoft Excel и как написать их с помощью Aspose.Cells для Python via .NET.

{{% /alert %}}

## **Автофильтрация данных**

Автофильтрация - самый быстрый способ выбрать только те элементы с листа, которые вы хотите отображать в списке. Функция автофильтрации позволяет фильтровать элементы в списке в соответствии с набором критериев. Отфильтруйте на основе текста, чисел или дат.

### **Автофильтр в Microsoft Excel**

Чтобы активировать функцию автофильтра в Microsoft Excel:

1. Щелкните строку заголовка на листе.
1. В меню **Данные** выберите **Фильтр**, а затем **Автофильтр**.

При применении автофильтра к листу появляются переключатели фильтра (черные стрелки) справа от заголовков столбцов.

1. Щелкните стрелку фильтра, чтобы увидеть список вариантов фильтра.

Некоторые из вариантов автофильтра:

|**Опции**|**Описание**|
| :- | :- |
|All|Показать все элементы в списке один раз.|
|Custom|Настроить критерии фильтрации, такие как содержит/не содержит.|
|Filter by Color|Фильтрация на основе заполненного цвета.|
|Date Filters|Фильтрация строк на основе различных критериев по дате.|
|Number Filters|Несколько видов фильтров для чисел, таких как сравнение, средние значения и Топ-10 и т.д.|
|Text Filters|Различные фильтры, такие как начинается с, заканчивается на, содержит и т. д.|
|Blanks/Non Blanks|Эти фильтры могут быть применены с помощью пустого текстового фильтра.|

Пользователи вручную фильтруют данные своего листа в Microsoft Excel, используя эти опции.

### **Автофильтр с Aspose.Cells для библиотеки Excel на Python**

Aspose.Cells на Python via .NET предоставляет класс Workbook, который представляет собой файл Excel. Класс Workbook содержит коллекцию Worksheets, которая позволяет получить доступ к каждому листу в файле Excel.

Лист представлен классом Worksheet. Класс Worksheet предоставляет широкий спектр свойств и методов для управления листами. Для создания автофильтра используйте свойство AutoFilter класса Worksheet. Свойство AutoFilter является объектом класса AutoFilter, который предоставляет свойство Range для указания диапазона ячеек, образующих строку заголовка. Автофильтр применяется к диапазону ячеек, который является строкой заголовка.

Для каждого листа вы можете указать только один диапазон фильтра. Это ограничено Microsoft Excel. Для настраиваемой фильтрации данных используйте метод AutoFilter.Custom.

В приведенном ниже примере мы создали тот же автофильтр, используя Aspose.Cells для Python via .NET, что и в Microsoft Excel в предыдущем разделе.

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-FilteringAndValidation-AutofilterData-1.py" >}}

#### **Различные типы фильтров**

Aspose.Cells для Python via .NET предоставляет несколько вариантов применения различных типов фильтров, таких как фильтрация по цвету, по дате, по числу, по тексту, пустые фильтры и непустые фильтры.

##### **Цвет заливки**

Aspose.Cells для Python via .NET предоставляет функцию AddFillColorFilter для фильтрации данных на основе свойства цвета заливки ячеек. В приведенном ниже примере используется файл шаблона с различными цветами заливки в первом столбце листа для тестирования функции фильтрации цвета. Образцы файлов можно скачать по следующим ссылкам.

1. [ColouredCells.xlsx](72417315.xlsx)
1. [FilteredColouredCells.xlsx](72417316.xlsx)

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterColor-1.py" >}}

##### **Дата**

Можно применить различные виды фильтров по дате, например, фильтрация всех строк с датами в январе 2018 года. В следующем образце кода демонстрируется этот фильтр с использованием функции AddDateFilter. Примеры файлов даны ниже.

1. [Date.xlsx](72417317.xlsx)
1. [FilteredDate.xlsx](72417318.xlsx)

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterDate-1.py" >}}

##### **Динамическая дата**

Иногда требуются динамические фильтры на основе даты, например, все ячейки с датами в январе независимо от года. В этом случае используется функция DynamicFilter, как показано в приведенном ниже образце кода. Примеры файлов даны ниже.

1. [Date.xlsx](72417317.xlsx)
1. [FilteredDynamicDate.xlsx](72417319.xlsx)

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterDynamicFilter-1.py" >}}

##### **Число**

Настраиваемые фильтры могут быть применены с помощью Aspose.Cells для Python via .NET, например, выбор ячеек с числом в пределах заданного диапазона. В следующем примере демонстрируется использование функции Custom() для фильтрации чисел. Примеры файлов даны ниже.

1. [Number.xlsx](72417320.xlsx)
1. [FilteredNumber.xlsx](72417321.xlsx)

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterNumber-1.py" >}}

##### **Текст**

Если столбец содержит текст и нужно выбрать ячейки, содержащие определенный текст, используйте функцию Filter(). В следующем примере файл шаблона содержит список стран, и необходимо выбрать строку, содержащую определенное название страны. Следующий код демонстрирует фильтрацию текста. Примеры файлов даны ниже.

1. [Text.xlsx](72417322.xlsx)
1. [FilteredText.xlsx](72417323.xlsx)

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterText-1.py" >}}

##### **Пустые**

Если столбец содержит текст так, что некоторые ячейки пусты, и требуется выбрать только те строки, где присутствуют пустые ячейки, используйте функцию MatchBlanks(), как показано ниже. Примеры файлов даны ниже.

1. [Пустой.xlsx](72417324.xlsx)
1. [ОтфильтрованныйПустой.xlsx](72417325.xlsx)

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterBlank-1.py" >}}

##### **Не пустые**

Когда нужно отфильтровать ячейки с любым текстом, используйте функцию фильтрации MatchNonBlanks, как показано ниже. Примеры файлов даны ниже.

1. [Пустой.xlsx](72417324.xlsx)
1. [ОтфильтрованныеНеПустой.xlsx](72417326.xlsx)

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterNonBlank-1.py" >}}

##### **Пользовательский фильтр с содержит**

Excel предоставляет настраиваемые фильтры, такие как фильтрация строк, содержащих определенную строку. Эта функция доступна в Aspose.Cells для Python via .NET и демонстрируется ниже фильтрацией имен в образцовом файле. Примеры файлов даны ниже.

1. [ИсходныйОбразецНазванийСтран.xlsx](sourseSampleCountryNames.xlsx)
1. [outSourseSampleCountryNames.xlsx](outSourseSampleCountryNames.xlsx).

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterCustom-Contains-1.py" >}}

##### **Пользовательский фильтр с не содержит**

Excel предоставляет настраиваемые фильтры, такие как фильтрация строк, не содержащих определенную строку. Эта функция доступна в Aspose.Cells для Python via .NET и демонстрируется ниже фильтрацией имен в предоставленном образцовом файле.

1. [sourseSampleCountryNames.xlsx](sourseSampleCountryNames.xlsx).

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-Filtering-AutofilterCustom-NotContains-1.py" >}}

##### **Пользовательский фильтр с начинается с**

Excel предоставляет настраиваемые фильтры, такие как фильтрация строк, начинающихся с определенной строки. Эта функция доступна в Aspose.Cells для Python via .NET и демонстрируется ниже фильтрацией имен в предоставленном образцовом файле.

1. [sourseSampleCountryNames.xlsx](sourseSampleCountryNames.xlsx).

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-FilteringAndValidation-AutofilterBeginsWith-1.py" >}}

##### **Пользовательский фильтр с EndsWith**

Excel предоставляет настраиваемые фильтры, такие как фильтрация строк, заканчивающихся на определенную строку. Эта функция доступна в Aspose.Cells для Python via .NET и демонстрируется ниже фильтрацией имен в предоставленном образцовом файле.

1. [sourseSampleCountryNames.xlsx](sourseSampleCountryNames.xlsx).

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-FilteringAndValidation-AutofilterEndsWith-1.py" >}}

## **Продвинутые темы**
- [Применение расширенного фильтра Microsoft Excel для отображения записей, удовлетворяющих сложным критериям](/cells/ru/python-net/apply-advanced-filter-of-microsoft-excel-to-display-records-meeting-complex-criteria/)
- [Получить все скрытые индексы строк после обновления автофильтра](/cells/ru/python-net/get-all-hidden-rows-indices-after-refreshing-autofilter/)
