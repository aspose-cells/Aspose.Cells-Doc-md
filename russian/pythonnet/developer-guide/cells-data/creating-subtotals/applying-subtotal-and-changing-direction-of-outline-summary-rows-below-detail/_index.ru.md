---
title: Применение итоговой строки и изменение направления итоговых строк справа от детальной
type: docs
weight: 100
url: /ru/python-net/applying-subtotal-and-changing-direction-of-outline-summary-rows-below-detail/
description: Узнайте, как применить итоговую строку и изменить направление итоговых строк ниже детали с помощью Aspose.Cells для Python via .NET API.
keywords: Python Excel библиотека, Применить итоговую строку, Добавление итоговой строки, изменение направления итоговых строк ниже детали, изменение направления итоговых столбцов справа от детали, Создание итоговой строки и изменение направления итоговых строк ниже детали
---

{{% alert color="primary" %}}

Эта статья объяснит, как применить итоговую строку к данным и изменить направление итоговых строк ниже детали.

Вы можете применить итоговую строку к данным, используя метод [**Worksheet.cells.subtotal()**](https://reference.aspose.com/cells/python-net/aspose.cells/cells/subtotal/#aspose.cells.CellArea-int-aspose.cells.ConsolidationFunction-list-bool-bool-bool). Он принимает следующие параметры.

- **ca** - Диапазон для применения итоговой строки
- **group_by** - Поле для группировки, как целочисленное смещение с нулевой базой
- **function** - Функция итоговой строки
- **total_list** - Массив смещений полей с нулевой базой, указывающий поля, к которым добавляются итоговые строки
- **replace** - Указывает, заменить ли текущие итоговые строки
- **page_breaks** - Указывает, добавить ли разрывы страниц между группами
- **summary_below_data** - Указывает, добавлять ли сводку под данными.

Также можно управлять направлением сводных строк **Ниже строки деталей** , как показано на следующем скриншоте, используя свойство Worksheet.Outline.SummaryRowBelow. Вы можете открыть этот параметр в Microsoft Excel, используя **Данные > Контур > Настройки**

![todo:image_alt_text](1.png)

{{% /alert %}}

## **Изображения исходных и выходных файлов**

На следующем скриншоте показан исходный файл Excel, используемый в приведенном ниже образцовом коде, содержащий некоторые данные в столбцах A и B.

![todo:image_alt_text](2.png)

На следующем скриншоте показан выходной файл Excel, созданный образцовым кодом. Как видно, к диапазону A2:B11 было применено итого, и направление контура - сводные строки ниже деталей.

![todo:image_alt_text](3.png)

## **Код Python для применения итогов и изменения направления сводных строк**

Вот пример кода для достижения указанного выше результата.

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Cells-Data-ApplyingSubtotalChangeSummaryDirection-1.py" >}}
