---
title: Обнаружение пустых рабочих листов
type: docs
weight: 410
url: /ru/python-net/detecting-empty-worksheets/
description: Эта статья показывает код, объясняющий, как программно обнаружить пустые листы книг Excel с помощью библиотеки Aspose.Cells для Python via .NET.
keywords: Библиотека Python Excel, обнаружение пустого листа с помощью Python, найти пустой лист Excel на Python.
---

## **Проверка заполненных ячеек**

На листах могут быть одна или несколько ячеек, заполненных значениями: простыми (текст, числовыми, датой/временем) или формулой или значением, основанным на формуле. В таком случае легко определить, пуст ли данный лист или нет. Все, что нам нужно проверить, это свойства [**Cells.max_data_row**](https://reference.aspose.com/cells/python-net/aspose.cells/cells/max_data_row/) или [**Cells.max_data_column**](https://reference.aspose.com/cells/python-net/aspose.cells/cells/max_data_column/). Если вышеупомянутые свойства возвращают ноль или положительные значения, это означает, что одна или несколько ячеек заполнены, однако если какое-либо из этих свойств возвращает -1, это указывает на то, что ни одна из ячеек не заполнена на указанном листе.

{{% alert color="primary" %}}

Коллекции строк и столбцов имеют индексацию с нуля, поэтому ячейка в строке 0 и столбце 0 означает, что это первая ячейка на листе, то есть А1.

{{% /alert %}}

## **Проверка пустых инициализированных ячеек**

Все ячейки, которые имеют значения, автоматически инициализируются, однако существует вероятность, что лист имеет ячейки, к которым применено только форматирование. В таком случае свойства [**Cells.max_data_row**](https://reference.aspose.com/cells/python-net/aspose.cells/cells/max_data_row/) или [**Cells.max_data_column**](https://reference.aspose.com/cells/python-net/aspose.cells/cells/max_data_column/) вернут -1, указывая на отсутствие заполненных значений, но инициализированные ячейки из-за форматирования ячеек не могут быть обнаружены с помощью этого подхода. Чтобы проверить, есть ли у листа пустые инициализированные ячейки, рекомендуется использовать метод IEnumerator.MoveNext для перечислителя, полученного из коллекции [**Cells**](https://reference.aspose.com/cells/python-net/aspose.cells/cells). Если метод IEnumerator.MoveNext возвращает **true**, это означает, что в данном листе есть одна или несколько инициализированных ячеек.

## **Проверка фигур**

Возможно, что данный лист не имеет заполненных ячеек, однако он может содержать фигуры и объекты, такие как элементы управления, диаграммы, изображения и т.д. Если нужно проверить, содержит ли лист какие-либо фигуры, это можно сделать, проверив элементы [**ShapeCollection**](https://reference.aspose.com/cells/python-net/aspose.cells.drawing/shapecollection). Любое положительное значение указывает на наличие фигур на листе.

## **Пример программирования**

{{< gist "aspose-cells-gists" "7bb30376b4d40cdfd596286870fb9752" "Worksheets-DetectEmptyWorksheets.py" >}}
