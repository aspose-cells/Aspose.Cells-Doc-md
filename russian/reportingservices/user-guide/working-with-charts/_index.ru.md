---
title: Работа с диаграммами
type: docs
weight: 110
url: /ru/reportingservices/working-with-charts/
---
{{% alert color="primary" %}} 

 Aspose.Cells Шаблон отчета поддерживает диаграммы Excel Microsoft. Каждый раз, когда вы выполняете отчет, диаграмма заполняется самыми последними данными.

{{% /alert %}} 

Чтобы добавить диаграмму в шаблон отчета:

1. Сначала создайте набор данных, который будет источником данных для диаграммы.
 Ниже мы используем образец базы данных AdventureWorks, поставляемый с SQL Server Reporting Services 2005, и создаем набор данных с именем Sales.
 Этот SQL определяет набор данных:

**SQL**

{{< highlight "csharp" >}}

 SELECT DATEPART(yy,SOH.OrderDate) 'Year',

'Q'+DATENAME(qq,SOH.OrderDate) 'Quarter',

SUM(SOD.UnitPrice*SOD.OrderQty) 'Sales'

FROMAdventureWorks.Sales.SalesOrderDetail SOD,

AdventureWorks.Sales.SalesOrderHeader SOH

WHERE SOH.SalesOrderID = SOD.SalesOrderID

AND ((DATEPART(yy,SOH.OrderDate)=2002))

GROUP BY DATEPART(yy,SOH.OrderDate), 'Q'+DATENAME(qq,SOH.OrderDate)



{{< /highlight >}}



 Пожалуйста, обратитесь к[Источники данных и запросы](/cells/ru/reportingservices/data-sources-and-queries/) чтобы узнать больше о том, как создать источник данных и набор данных, в Aspose.Cells.Report.Designer.

1. Создайте табличный отчет в соответствии с инструкциями в[Создание табличного отчета](/cells/ru/reportingservices/creating-tabular-report/) . Отчет, который мы создали для этого примера, приведен ниже. Таблица является источником данных диаграммы.

![дело:изображение_альтернативный_текст](working-with-charts_1.png)




1.  В Excel Microsoft щелкните значок**Вставлять** меню и выберите**Диаграмма**.
1.  Нажмите**Следующий**. 

![дело:изображение_альтернативный_текст](working-with-charts_2.png)




1.  Нажмите на**Ряд** вкладка

![дело:изображение_альтернативный_текст](working-with-charts_3.png)




1.  Нажмите**Добавлять**. 

![дело:изображение_альтернативный_текст](working-with-charts_4.png)




1. В диалоговом окне установите значение Series1 (квартальный ряд) в первое поле данных таблицы.
 В примере это «CompanySales!$C$3:$C$3». Первый $C$3 — это индекс первой строки «Квартала», а второй $C$3 — это заполнитель для индекса последней строки «Квартала», и он будет заменен реальным индексом строки данных таблицы во время рендеринга. Установите метки оси категории (X) на «=CompanySales!$C$3:$C$3».

![дело:изображение_альтернативный_текст](working-with-charts_5.png)




1.  Нажмите**Добавлять** чтобы добавить еще одну серию.
 В примере мы добавили серию продаж.
1. Установите значение Series2 (ряд продаж) во второе поле данных таблицы.
В примере это «CompanySales!$D$3:$D$3». Первый $D$3 является индексом первой строки «Продажи», а второй $D$3 является заполнителем для индекса последней строки «Продажи» и будет заменен реальным индексом строки данных таблицы во время рендеринга.
1.  Нажмите**Следующий** продолжить.

![дело:изображение_альтернативный_текст](working-with-charts_6.png)




1. В диалоговом окне задайте заголовок диаграммы и ось категории (X).
1.  Нажмите**Заканчивать** завершить работу.

![дело:изображение_альтернативный_текст](working-with-charts_7.png)



 Шаблон выглядит следующим образом.

![дело:изображение_альтернативный_текст](working-with-charts_8.png)




1. Сохраните отчет и опубликуйте его на сервере отчетов.
1. Экспортируйте отчет с сервера отчетов.
 Результат такой, как показано ниже.

![дело:изображение_альтернативный_текст](working-with-charts_9.png)
